classdef DCTFFRGUI < matlab.apps.AppBase

    % Properties that correspond to app components
    properties (Access = public)
        UIFigure                        matlab.ui.Figure
        FileMenu                        matlab.ui.container.Menu
        LoadMenu                        matlab.ui.container.Menu
        DCECTAnalysisMenu               matlab.ui.container.Menu
        DCECTImagesMenu                 matlab.ui.container.Menu
        ScannerModelMenu                matlab.ui.container.Menu
        SiemensMenu_3                   matlab.ui.container.Menu
        CanonMenu_3                     matlab.ui.container.Menu
        GEMenu_3                        matlab.ui.container.Menu
        CTAImagesMenu                   matlab.ui.container.Menu
        PreLesionCurveMenu              matlab.ui.container.Menu
        PostLesionCurveMenu             matlab.ui.container.Menu
        SampleROIMenu                   matlab.ui.container.Menu
        CTPTimeInfoMenu                 matlab.ui.container.Menu
        ApplyCTPTimeInfoMenu            matlab.ui.container.Menu
        StressandRestAnalysisMenu       matlab.ui.container.Menu
        StressImagesMenu_4              matlab.ui.container.Menu
        ScannerModelMenu_2              matlab.ui.container.Menu
        SiemensMenu_4                   matlab.ui.container.Menu
        CanonMenu_4                     matlab.ui.container.Menu
        GEMenu_4                        matlab.ui.container.Menu
        TimeInfoStudyStressMenu         matlab.ui.container.Menu
        RestImagesMenu_2                matlab.ui.container.Menu
        ScannerModelMenu_3              matlab.ui.container.Menu
        SiemensMenu_5                   matlab.ui.container.Menu
        CanonMenu_5                     matlab.ui.container.Menu
        GEMenu_5                        matlab.ui.container.Menu
        TimeInfoStudyRestMenu           matlab.ui.container.Menu
        PreLesionCurveMenu_2            matlab.ui.container.Menu
        PostLesionCurveMenu_2           matlab.ui.container.Menu
        SupervisedLearningMenu_2        matlab.ui.container.Menu
        DCTAVolumeMenu                  matlab.ui.container.Menu
        TrainingMenu_2                  matlab.ui.container.Menu
        TrainingDataMenu                matlab.ui.container.Menu
        ValidationDataMenu              matlab.ui.container.Menu
        TestingMenu_2                   matlab.ui.container.Menu
        TestDataMenu                    matlab.ui.container.Menu
        SavedNetworkMenu                matlab.ui.container.Menu
        SaveMenu                        matlab.ui.container.Menu
        DCECTAnalysisMenu_2             matlab.ui.container.Menu
        ResultsMenu                     matlab.ui.container.Menu
        StressandRestAnalysisMenu_2     matlab.ui.container.Menu
        ResultsMenu_2                   matlab.ui.container.Menu
        SupervisedLearningMenu          matlab.ui.container.Menu
        LabelledDataMenu                matlab.ui.container.Menu
        ExportMenu                      matlab.ui.container.Menu
        DCECTAnalysisMenu_3             matlab.ui.container.Menu
        DCECTImagesMenu_2               matlab.ui.container.Menu
        CTAImagesMenu_2                 matlab.ui.container.Menu
        FittedCurvesMenu                matlab.ui.container.Menu
        FFRValuesMenu                   matlab.ui.container.Menu
        StressandRestAnalysisMenu_3     matlab.ui.container.Menu
        StressImagesMenu_3              matlab.ui.container.Menu
        RestImagesMenu                  matlab.ui.container.Menu
        FittedCurveMenu_2               matlab.ui.container.Menu
        WorkflowMenu                    matlab.ui.container.Menu
        SupervisedLearningMenu_4        matlab.ui.container.Menu
        TrainingMenu                    matlab.ui.container.Menu
        NetworkOptionMenu               matlab.ui.container.Menu
        CNNMenu                         matlab.ui.container.Menu
        UNETMenu                        matlab.ui.container.Menu
        StartTrainingMenu               matlab.ui.container.Menu
        TestingMenu                     matlab.ui.container.Menu
        ClassifyMenu                    matlab.ui.container.Menu
        DataLabelingMenu                matlab.ui.container.Menu
        SetApexPointMenu                matlab.ui.container.Menu
        SetLADPointMenu                 matlab.ui.container.Menu
        SetLCxPointMenu                 matlab.ui.container.Menu
        SetRCAPointMenu                 matlab.ui.container.Menu
        RemoveLastPointMenu             matlab.ui.container.Menu
        ScreenCaptureMenu               matlab.ui.container.Menu
        ExitMenu                        matlab.ui.container.Menu
        Menu                            matlab.ui.container.Menu
        EditMenu                        matlab.ui.container.Menu
        DCECTAnalysisMenu_4             matlab.ui.container.Menu
        SetLevelWidthforStressTestMenu  matlab.ui.container.Menu
        SetLevelWidthforCTATestMenu     matlab.ui.container.Menu
        YaxisScalePreLesionMenu         matlab.ui.container.Menu
        AutoMenu                        matlab.ui.container.Menu
        ManualMenu                      matlab.ui.container.Menu
        YaxisScalePostLesionMenu        matlab.ui.container.Menu
        AutoMenu_2                      matlab.ui.container.Menu
        ManualMenu_2                    matlab.ui.container.Menu
        StressandRestAnalysisMenu_4     matlab.ui.container.Menu
        SetLevelWidthforStressTestMenu_2  matlab.ui.container.Menu
        SetLevelWidthforRestTestMenu    matlab.ui.container.Menu
        YaxisScalePreLesionMenu_2       matlab.ui.container.Menu
        AutoMenu_3                      matlab.ui.container.Menu
        ManualMenu_3                    matlab.ui.container.Menu
        YaxisScalePostLesionMenu_2      matlab.ui.container.Menu
        AutoMenu_4                      matlab.ui.container.Menu
        ManualMenu_4                    matlab.ui.container.Menu
        SupervisedLearningMenu_3        matlab.ui.container.Menu
        SetWindowLevelMenu              matlab.ui.container.Menu
        Menu_2                          matlab.ui.container.Menu
        ViewMenu                        matlab.ui.container.Menu
        OptionMenu                      matlab.ui.container.Menu
        BasicMenu                       matlab.ui.container.Menu
        FullMenu                        matlab.ui.container.Menu
        BackgroundMenu                  matlab.ui.container.Menu
        BrightMenu                      matlab.ui.container.Menu
        DarkMenu                        matlab.ui.container.Menu
        FontMenu                        matlab.ui.container.Menu
        ArialMenu                       matlab.ui.container.Menu
        PalatinoLinotypeMenu            matlab.ui.container.Menu
        TimesMenu                       matlab.ui.container.Menu
        Menu_3                          matlab.ui.container.Menu
        HelpMenu                        matlab.ui.container.Menu
        AboutDAIVeraMenu                matlab.ui.container.Menu
        UserGuideMenu                   matlab.ui.container.Menu
        TabGroup                        matlab.ui.container.TabGroup
        StressOnly                      matlab.ui.container.Tab
        MButton                         matlab.ui.control.Button
        EditField                       matlab.ui.control.EditField
        HUTextArea_2                    matlab.ui.control.TextArea
        HUTextArea                      matlab.ui.control.TextArea
        EditPointCheckBox_2             matlab.ui.control.CheckBox
        EditPointCheckBox               matlab.ui.control.CheckBox
        ClearButton_3                   matlab.ui.control.Button
        ClearButton_2                   matlab.ui.control.Button
        ClearButton                     matlab.ui.control.Button
        WashoutLabel_2                  matlab.ui.control.Label
        SetLabel_2                      matlab.ui.control.Label
        FitCurvesButtonStressOnly_2     matlab.ui.control.Button
        ManualWashoutInputStressOnly_2  matlab.ui.control.TextArea
        ManualBaselineInputStressOnly_2  matlab.ui.control.TextArea
        BaselineLabel_2                 matlab.ui.control.Label
        WashoutLabel                    matlab.ui.control.Label
        BaselineLabel                   matlab.ui.control.Label
        SetLabel                        matlab.ui.control.Label
        CTAStudyLabelStressOnly         matlab.ui.control.Label
        SetWindowWidthCTAStressOnly     matlab.ui.control.TextArea
        SetWindowButtonCTAStressOnly    matlab.ui.control.Button
        SetWindowLevelCTAStressOnly     matlab.ui.control.TextArea
        SlicesSliderCTAStressOnly       matlab.ui.control.Slider
        SlicesSliderCTAStressOnlyLabel  matlab.ui.control.Label
        FlipSliceNumbersCheckBox        matlab.ui.control.CheckBox
        GraphAppearanceDropDown         matlab.ui.control.DropDown
        GraphAppearanceDropDownLabel    matlab.ui.control.Label
        RemovePointPostCheckBoxStressOnly  matlab.ui.control.CheckBox
        RemovePointPreCheckBoxStressOnly  matlab.ui.control.CheckBox
        InterpolateCurrentSliceWithDropDown_2Label_2  matlab.ui.control.Label
        InterpolateCurrentSliceWithDropDownStressOnly  matlab.ui.control.DropDown
        SearchROIDropDown_2Label_2      matlab.ui.control.Label
        SearchROIDropDownStressOnly     matlab.ui.control.DropDown
        SampleROILabel                  matlab.ui.control.Label
        SamplingROIDropDownStressOnly   matlab.ui.control.DropDown
        ManualWashoutInputStressOnly    matlab.ui.control.TextArea
        veHeightCheckBoxStressOnly      matlab.ui.control.CheckBox
        ManualZoomingCheckBoxStressOnly  matlab.ui.control.CheckBox
        StressStudyLabelStressOnly      matlab.ui.control.Label
        UnauthorizedUseisProhibitedLabelStressOnly  matlab.ui.control.Label
        SosLabPropertyLabelStressOnly   matlab.ui.control.Label
        ManualBaselineInputStressOnly   matlab.ui.control.TextArea
        FitCurvesButtonStressOnly       matlab.ui.control.Button
        SetWindowWidthStressOnly        matlab.ui.control.TextArea
        SetWindowButtonStressOnly       matlab.ui.control.Button
        SetWindowLevelStressOnly        matlab.ui.control.TextArea
        SetPostLesionStressOnly         matlab.ui.control.Button
        SetPreLesionButtonStressOnly    matlab.ui.control.Button
        SlicesSliderStressOnlyLabel     matlab.ui.control.Label
        TimePointsSliderStressOnlyLabel  matlab.ui.control.Label
        SlicesSliderStressOnly          matlab.ui.control.Slider
        TimePointsSliderStressOnly      matlab.ui.control.Slider
        DynamicAngiographicImagingDAIVeraPanel_2  matlab.ui.container.Panel
        OutputParametersPanelStressOnly  matlab.ui.container.Panel
        StressLabelStressOnly           matlab.ui.control.Label
        ClearOutputsButtonStressOnly    matlab.ui.control.Button
        PostlesionShearStressPaEditFieldStressOnly  matlab.ui.control.EditField
        PostlesionShearStressPaEditField_2Label  matlab.ui.control.Label
        PrelesionShearStressPaEditFieldStressOnly  matlab.ui.control.EditField
        PrelesionShearStressPaEditField_2Label  matlab.ui.control.Label
        PostlesionFlowVelocitycmsEditFieldStressOnly  matlab.ui.control.EditField
        PostlesionFlowVelocitycmsEditField_2Label  matlab.ui.control.Label
        PrelesionFlowVelocitycmsEditFieldStressOnly  matlab.ui.control.EditField
        PrelesionFlowVelocitycmsEditField_2Label  matlab.ui.control.Label
        FFREditFieldStressOnly          matlab.ui.control.EditField
        FFREditField_2Label             matlab.ui.control.Label
        InputParametersforStressStudyPanelStressOnly  matlab.ui.container.Panel
        CoronaryDominanceDropDown       matlab.ui.control.DropDown
        CoronaryDominanceDropDownLabel  matlab.ui.control.Label
        MarkBranchCheckBox              matlab.ui.control.CheckBox
        CoronaryArteryDropDown          matlab.ui.control.DropDown
        CoronaryArteryDropDownLabel     matlab.ui.control.Label
        RestorStressConditionDropDown   matlab.ui.control.DropDown
        RestorStressConditionDropDownLabel  matlab.ui.control.Label
        XrayTubeVoltagekVDropDown       matlab.ui.control.DropDown
        XrayTubeVoltagekVDropDownLabel  matlab.ui.control.Label
        MarkBreakerCheckBox             matlab.ui.control.CheckBox
        MarkStenosisCheckBox            matlab.ui.control.CheckBox
        OutputButtonStressOnly          matlab.ui.control.Button
        ClearInputsButtonStressOnly     matlab.ui.control.Button
        ContrastConcentrationmglmLEditFieldStressOnly  matlab.ui.control.EditField
        FrictionFactorButtonGroupStressOnly  matlab.ui.container.ButtonGroup
        ColebrookButtonStressOnly       matlab.ui.control.RadioButton
        ChurchillButtonStressOnly       matlab.ui.control.RadioButton
        ContrastConcentrationmgmLLabel  matlab.ui.control.Label
        SystolicBloodPressuremmHgEditFieldStressOnly  matlab.ui.control.EditField
        AorticBloodPressuremmHgLabel    matlab.ui.control.Label
        PrelesionLumenRadiuscmEditFieldStressOnly  matlab.ui.control.EditField
        PrelesionLumenRadiuscmLabel_2   matlab.ui.control.Label
        PostlesionLumenRadiuscmEditFieldStressOnly  matlab.ui.control.EditField
        PostlesionLumenRadiuscmEditField_2Label  matlab.ui.control.Label
        ContrastVolumemLEditFieldStressOnly  matlab.ui.control.EditField
        ContrastVolumemLEditField_2Label  matlab.ui.control.Label
        ArteryTypeButtonGroupStressOnly  matlab.ui.container.ButtonGroup
        AortaButtonStressOnly           matlab.ui.control.RadioButton
        CoronaryButtonStressOnly        matlab.ui.control.RadioButton
        ImageAxesCTAStressOnly          matlab.ui.control.UIAxes
        FFRVsSliceLocation              matlab.ui.control.UIAxes
        paPlotAreaStressOnly            matlab.ui.control.UIAxes
        pdPlotAreaStressOnly            matlab.ui.control.UIAxes
        ImageAxesStressOnly             matlab.ui.control.UIAxes
        StressRestAnalysisTab           matlab.ui.container.Tab
        FitStressCurveButton_2          matlab.ui.control.Button
        ManualBaselineInput_2           matlab.ui.control.TextArea
        FitCurvesButtonRest_2           matlab.ui.control.Button
        ManualBaselineInputRest_2       matlab.ui.control.TextArea
        ManualWashoutInput_2            matlab.ui.control.TextArea
        ManualWashoutInputRest_2        matlab.ui.control.TextArea
        UnauthorizedUseisProhibitedLabel  matlab.ui.control.Label
        SosLabPropertyLabel             matlab.ui.control.Label
        InterpolateCurrentSliceWithDropDownRest  matlab.ui.control.DropDown
        InterpolateCurrentSliceWithDropDown_2Label  matlab.ui.control.Label
        InterpolateCurrentSliceWithDropDown  matlab.ui.control.DropDown
        InterpolateCurrentSliceWithDropDownLabel  matlab.ui.control.Label
        RestSearchROIDropDown           matlab.ui.control.DropDown
        SearchROIDropDown_2Label        matlab.ui.control.Label
        SearchROIDropDown               matlab.ui.control.DropDown
        SearchROIDropDownLabel          matlab.ui.control.Label
        ROIDropDownRest                 matlab.ui.control.DropDown
        SamplingROILabel                matlab.ui.control.Label
        SamplingROIDropDown             matlab.ui.control.DropDown
        SamplingROIDropDownLabel        matlab.ui.control.Label
        InputParametersforStressTestPanel  matlab.ui.container.Panel
        CopyRestInputsButton            matlab.ui.control.Button
        ClearInputsButton               matlab.ui.control.Button
        ComputeButton                   matlab.ui.control.Button
        ArterialRoughness               matlab.ui.control.EditField
        SystolicBloodPressuremmHgEditField_2Label_2  matlab.ui.control.Label
        ConversionFactorEditField       matlab.ui.control.EditField
        ConversionFactorHUpermgImLLabel  matlab.ui.control.Label
        PostlesionTracerPercentageEditField  matlab.ui.control.EditField
        PostlesionTracerPercentageEditFieldLabel  matlab.ui.control.Label
        PrelesionTracerPercentageEditField  matlab.ui.control.EditField
        PrelesionTracerPercentageEditFieldLabel  matlab.ui.control.Label
        ArteryTypeButtonGroup           matlab.ui.container.ButtonGroup
        AortaButton                     matlab.ui.control.RadioButton
        CoronaryButton                  matlab.ui.control.RadioButton
        FrictionFactorButtonGroup       matlab.ui.container.ButtonGroup
        ColebrookButton                 matlab.ui.control.RadioButton
        ChurchillButton                 matlab.ui.control.RadioButton
        ContrastConcentrationmglmLEditField  matlab.ui.control.EditField
        ContrastConcentrationmglmLEditFieldLabel  matlab.ui.control.Label
        AorticBloodPressuremmHgEditField  matlab.ui.control.EditField
        AorticBloodPressuremmHgEditFieldLabel  matlab.ui.control.Label
        PrelesionLumenRadiuscmEditField  matlab.ui.control.EditField
        PrelesionLumenRadiuscmEditFieldLabel  matlab.ui.control.Label
        PostlesionLumenRadiuscmEditField  matlab.ui.control.EditField
        PostlesionLumenRadiuscmEditFieldLabel  matlab.ui.control.Label
        ContrastVolumemLEditField       matlab.ui.control.EditField
        ContrastVolumemLEditFieldLabel  matlab.ui.control.Label
        DynamicAngiographicImagingDAIVeraPanel  matlab.ui.container.Panel
        TimePointsSlider                matlab.ui.control.Slider
        SlicesSlider                    matlab.ui.control.Slider
        TimePointsSlider_2Label         matlab.ui.control.Label
        SlicesSlider_2Label             matlab.ui.control.Label
        SetPreLesionButton              matlab.ui.control.Button
        SetPostLesionButton             matlab.ui.control.Button
        SetWindowLevel                  matlab.ui.control.TextArea
        SetWindowButton                 matlab.ui.control.Button
        SetWindowWidth                  matlab.ui.control.TextArea
        FitStressCurveButton            matlab.ui.control.Button
        ManualBaselineInput             matlab.ui.control.TextArea
        TimePointsSliderRest            matlab.ui.control.Slider
        SlicesSliderRest                matlab.ui.control.Slider
        TimePointsSliderLabelRest       matlab.ui.control.Label
        SlicesSliderLabelRest           matlab.ui.control.Label
        SetPreLesionButtonRest          matlab.ui.control.Button
        SetPostLesionButtonRest         matlab.ui.control.Button
        SetWindowLevelRest              matlab.ui.control.TextArea
        SetWindowButtonRest             matlab.ui.control.Button
        SetWindowWidthRest              matlab.ui.control.TextArea
        RestTestLabel                   matlab.ui.control.Label
        InputParametersforRestTestPanel  matlab.ui.container.Panel
        CopyStressInputsButton          matlab.ui.control.Button
        ClearInputsButtonRest           matlab.ui.control.Button
        OutputButtonRest                matlab.ui.control.Button
        ArterialRoughnessRest           matlab.ui.control.EditField
        SystolicBloodPressuremmHgEditField_2Label_3  matlab.ui.control.Label
        ConversionFactorEditFieldRest   matlab.ui.control.EditField
        ConversionFactorHUpermgImLLabel_2  matlab.ui.control.Label
        PostTracerPercentageEditFieldRest  matlab.ui.control.EditField
        PostlesionTracerPercentageLabel  matlab.ui.control.Label
        PreTracerPercentageEditFieldRest  matlab.ui.control.EditField
        PrelesionTracerPercentageLabel  matlab.ui.control.Label
        ArteryTypeButtonGroupRest       matlab.ui.container.ButtonGroup
        AortaButtonRest                 matlab.ui.control.RadioButton
        CoronaryButtonRest              matlab.ui.control.RadioButton
        FrictionFactorButtonGroupRest   matlab.ui.container.ButtonGroup
        ColebrookButtonRest             matlab.ui.control.RadioButton
        ChurchillButtonRest             matlab.ui.control.RadioButton
        ConcentrationofContrastmglmLEditFieldRest  matlab.ui.control.EditField
        ContrastConcentrationmglmLLabel  matlab.ui.control.Label
        SystolicBloodPressuremmHgEditFieldRest  matlab.ui.control.EditField
        AorticBloodPressuremmHgLabel_2  matlab.ui.control.Label
        RadiusPreLesioncmEditFieldRest  matlab.ui.control.EditField
        PrelesionLumenRadiuscmLabel     matlab.ui.control.Label
        RadiusPostLesioncmEditFieldRest  matlab.ui.control.EditField
        PostlesionLumenRadiuscmLabel    matlab.ui.control.Label
        ContrastVolumemLEditFieldRest   matlab.ui.control.EditField
        ContrastVolumemLLabel           matlab.ui.control.Label
        StressTestLabel                 matlab.ui.control.Label
        FitCurvesButtonRest             matlab.ui.control.Button
        ManualBaselineInputRest         matlab.ui.control.TextArea
        ManualZoomingCheckBox           matlab.ui.control.CheckBox
        ManualZoomingRestCheckBox       matlab.ui.control.CheckBox
        veHeightCheckBox                matlab.ui.control.CheckBox
        veHeightRestCheckBox            matlab.ui.control.CheckBox
        ManualWashoutInput              matlab.ui.control.TextArea
        ManualWashoutInputRest          matlab.ui.control.TextArea
        OutputParametersPanel           matlab.ui.container.Panel
        RestLabel                       matlab.ui.control.Label
        PostlesionCFREditField          matlab.ui.control.EditField
        PostlesionCFREditFieldLabel     matlab.ui.control.Label
        PrelesionCFREditField           matlab.ui.control.EditField
        PrelesionCFREditFieldLabel      matlab.ui.control.Label
        ClearOutputsButton              matlab.ui.control.Button
        PostShearStressPaEditFieldRest  matlab.ui.control.EditField
        PreShearStressPaEditFieldRest   matlab.ui.control.EditField
        PostLesionVelocitycmsEditFieldRest  matlab.ui.control.EditField
        PreLesionVelocitycmsEditFieldRest  matlab.ui.control.EditField
        FFREditFieldRest                matlab.ui.control.EditField
        PostlesionShearStressPaEditField  matlab.ui.control.EditField
        PostlesionShearStressPaEditFieldLabel  matlab.ui.control.Label
        PrelesionShearStressPaEditField  matlab.ui.control.EditField
        PrelesionShearStressPaEditFieldLabel  matlab.ui.control.Label
        PostlesionFlowVelocitycmsEditField  matlab.ui.control.EditField
        PostlesionFlowVelocitycmsEditFieldLabel  matlab.ui.control.Label
        PrelesionFlowVelocitycmsEditField  matlab.ui.control.EditField
        PrelesionFlowVelocitycmsEditFieldLabel  matlab.ui.control.Label
        FFREditField                    matlab.ui.control.EditField
        FFREditFieldLabel               matlab.ui.control.Label
        StressLabel                     matlab.ui.control.Label
        ImageAxes                       matlab.ui.control.UIAxes
        pdPlotArea                      matlab.ui.control.UIAxes
        paPlotArea                      matlab.ui.control.UIAxes
        ImageAxesRest                   matlab.ui.control.UIAxes
        ThreeDVisualizationTab          matlab.ui.container.Tab
        RemoveLastPointButton           matlab.ui.control.Button
        SetLCxPointButton               matlab.ui.control.Button
        SetLADPointButton               matlab.ui.control.Button
        SetApexPointButton              matlab.ui.control.Button
        SetRCAPointButton               matlab.ui.control.Button
        SetWindowWidthSupervised        matlab.ui.control.TextArea
        SetWindowButtonSupervised       matlab.ui.control.Button
        SetWindowLevelSupervised        matlab.ui.control.TextArea
        DynamicAngiographicImagingDAIVeraPanel_3  matlab.ui.container.Panel
        SlicesSlider3D                  matlab.ui.control.Slider
        SlicesSlider3DLabel             matlab.ui.control.Label
        ImageAxes3DJPEG                 matlab.ui.control.UIAxes
        ImageAxes3D                     matlab.ui.control.UIAxes
        ContextMenu                     matlab.ui.container.ContextMenu
        SetYaxisMaxMenu                 matlab.ui.container.Menu
        ContextMenu2                    matlab.ui.container.ContextMenu
        SetYaxisMaxMenu_2               matlab.ui.container.Menu
    end

    % Private Variables
    properties (Access = private)
        STENOSISGUI;
        stenosisGuiData;
        BRANCHGUI;
        branchGuiData;
        BREAKERGUI;
        breakerGuiData;
    end

    % Global Variables
    properties (Access = public)
        allDicomInfo;
        allDicomInfoRest;
        allDicomInfoStressOnly;
        allExtraPointsForDistanceInStressOnly = [];
        allFFRStressOnly = [];
        allFFRStressOnlySliceLocations = [];
        allFFRStressOnlyDicomSliceNumbers = [];
        allFlowVelocitiesStressOnly = [];
        allFlowVelocitiesSliceLocationsStressOnly = [];
        allPreFlowVelocity = [];
        allPostFlowVelocity = [];
        allResultsForCSVWrite = 'TimeStamp,RestOrStress,PreLesionSlice,PostLesionSlice,PreLesionCooridnate,PostLesionCoordinate,FFR,PreVolumetricFlowRate(mL/s),PostVolumetricFlowRate(mL/s),PreVelocity(cm/s),PostVelocity(cm/s),PreShearStress(Pa),PostShearStress(Pa),PreaAUC,PostAUC,PreAlpha,PreBeta,PreK,PostAlpha,PostBeta,PostK,PreCFR,PostCFR,pLE(mmHg),pLF(mmHg),Re,pB(mmHg),f,Vs1(cm/s),Vs2(cm/s),Vs3(cm/s),pLC(mmHg),pLS(mmHg)\n';
        allStenosisData = struct();
        alphaA;
        alphaARest;
        alphaAStressOnly;
        alphaB;
        alphaBRest;
        alphaBStressOnly;
        arterySelections = ["RCA", "LM", "LAD", "LCX"];
        arterySelectedIndex = 1;
        arteryType = 'Coronary';
        arteryTypeRest = 'Coronary';
        arteryTypeStressOnly = 'Coronary';
        aucA;
        aucARest;
        aucAEntryStressOnly = [];
        aucAStressOnly;
        aucB;
        aucBRest;
        aucBExitStressOnly = [];
        aucBStressOnly;
        betaA;
        betaARest;
        betaAStressOnly;
        betaB;
        betaBRest;
        betaBStressOnly;
        branchData = struct();
        breakerData;
        checkedStenosis = [];
        colorBackgroundNormalMode = [0.94 0.94 0.94];
        colorBackgroundDarkMode = [0.30 0.30 0.30];
        colorTextFieldNormalMode = [1.0 1.0 1.0];
        colorTextFieldDarkMode = [0.50 0.50 0.50];
        colorPlotAreaNormalMode = [1.0 1.0 1.0];
        colorPlotAreaDarkMode = [0.50 0.50 0.50];
        colorRegularFontDarkMode = [1.0 1.0 1.0];
        colorRegularFontNormalMode = [0.0 0.0 0.0];
        colorRegularFontHiddenMode = [0.80 0.80 0.80];
        colorTitleFontDarkMode = [0.65 0.81 0.92];
        colorTitleFontNormalMode = [0.00 0.45 0.74];
        colorUnauthorizedUseDarkMode = [1.00 0.67 0.67];
        colorUnauthorizedUseNormalMode = [1.00 0.00 0.00];
        concentrationofContrast;
        concentrationofContrastRest;
        coOrdinatesForCSVWrite = 'X,Y,Z,T\n';
        coOrdinatesForCSVWriteRest = 'X,Y,Z,T\n';
        coOrdinatesForCSVWriteStressOnly = 'X,Y,Z,T\n';
        ctaVolume;
        ctaInfo;
        currentSlice = 1;
        currentSliceCTA = 1;
        currentSlice3D = 1;
        currentSliceStressOnly = 1;
        currentSliceRest = 1;
        currentStenosisNumber = -1;
        currentStenosisID = 1;
        currentTimePoint = 1;
        currentTimePointRest = 1;
        currentTimePointStressOnly = 1;
        defaultThresholdCheck = 0;
        dicomInfo;
        dicomInfoRest;
        dicomInfoStressOnly;
        dominanceTypes = ["Right", "Left", "Co"];
        dominanceType = "Right";
        entryCurveStressOnly;
        entryTimePointStressOnly;
        entrySliceLocations = [];
        entrySxStressOnly;
        entrySyStressOnly;
        entryQ = [];
        entryRoiObjectStressOnly;
        exitCurveStressOnly;
        exitTimePointStressOnly;
        exitSliceLocations = [];
        exitSxStressOnly;
        exitSyStressOnly;
        exitQ = [];
        exitRoiObjectStressOnly;
        f = 1;
        FAStressOnly;
        FBStressOnly;
        FFR;
        FFRRest;
        FFRStressOnly;
        fittedCurveEntryStressOnly;
        fittedCurveExitStressOnly;
        fittedCurvePa;
        fittedCurvePaRest;
        fittedCurvePaStressOnly;
        fittedCurvePd;
        fittedCurvePdRest;
        fittedCurvePdStressOnly;
        fittedTimeEntryStressOnly;
        fittedTimeExitStressOnly;
        fittedTimePa;
        fittedTimePaRest;
        fittedTimePaStressOnly;
        fittedTimePd;
        fittedTimePdRest;
        fittedTimePdStressOnly;
        fMethod = 'Colebrook';
        fMethodRest = 'Colebrook';
        fMethodStressOnly = 'Colebrook';
        frictionFactor;
        frictionFactorRest;
        frictionFactorStressOnly;
        fontName = 'Arial';
        fourDImageSet;
        fourDImageSetStressOnly;
        hAhBDiffNegative = true;
        hAhBRestDiffNegative = true;
        hAhBDiffNegativeStressOnly = true;
        hB;
        hBRest;
        hBStressOnly;
        hBText;
        hBTextStressOnly;
        im;
        imCTA;
        imJPEG;
        imRest;
        imStressOnly;
        interpolatedSampledPointsPa;
        interpolatedSampledPointsPaRest;
        interpolatedSampledPointsPaStressOnly;
        interpolatedSampledPointsPd;
        interpolatedSampledPointsPdRest;
        interpolatedSampledPointsPdStressOnly;
        interpolatedTimePoints;
        interpolatedTimePointsRest;
        interpolatedTimePointsStressOnly;
        kA;
        kARest;
        kAStressOnly;
        kB;
        kBRest;
        kBStressOnly;
        L;
        LRest;
        LStressOnly;
        LText;
        LTextStressOnly;
        labelImageDirectory;
        manualBaselineCheck;
        manualBaselineCheckRest;
        manualBaselineCheckStressOnly;
        manualBaselineValue = 0;
        manualBaselineValueRest = 0;
        manualBaselineValueStressOnly = 0;
        manualWashoutValue = 0;
        manualWashoutValueRest = 0;
        manualWashoutValueStressOnly = 0;
        maxHUCorrectionSupported = 3;
        maxStenosisSupported = 5;
        maxWindow3D;
        maxWindow;
        maxWindowCTA;
        maxWindowRest;
        maxWindowStressOnly;
        maxYAxisInterval = 50;
        minWindow3D;
        minWindow;
        minWindowCTA;
        minWindowRest;
        minWindowStressOnly;
        movieStop = false;
        movieFrameDuration = 0.20;
        mTotal;
        numberOfBranches = 0;
        numberOfStenosis = 0;
        pa;
        paPlotAreaPointModifyCounter = 0;
        paStressOnly;
        paCurve;
        paCurveRest;
        paCurveStressOnly;
        paRest;
        paSlice;
        paSliceRest;
        paSliceStressOnly;
        paTimePoint;
        paTimePointRest;
        paTimePointsStressOnly;
        paCurrentTimePointStressOnly;
        pB;
        pBRest;
        pBStressOnly;
        pd;
        pdPlotAreaPointModifyCounter = 0;
        pdStressOnly;
        pdCurve;
        pdCurveRest;
        pdCurveStressOnly;
        pdRest;
        pdSlice;
        pdSliceRest;
        pdSliceStressOnly;
        pdTimePoint;
        pdTimePointRest;
        pdTimePointsStressOnly;
        pdCurrentTimePointStressOnly;
        pEntryStressOnly;
        pExitStressOnly;
        pLC;
        pLCRest;
        pLCStressOnly;
        pLE;
        pLERest;
        pLEStressOnly;
        pLF;
        pLFRest;
        pLFStresOnly;
        pLS;
        pLSRest;
        pLSStressOnly;
        plotData = struct();
        plotIDsToRemoveFromPlotArea;
        plotToRemovePoint;
        plotX = [1:10];
        plotXRest = [1:10];
        plotXEntryStressOnly = [1:10];
        plotXExitStressOnly = [1:10];
        plotXPreStressOnly = [1:10];
        plotXPostStressOnly = [1:10];
        postCFR;
        postRoiObjectStressOnly;
        postQ;
        postQRest;
        postQStressOnly;
        postTextRead = false;
        postTextReadStressOnly = false;
        postTracerPercentage;
        postTracerPercentageRest;
        preCFR;
        preRoiObjectStressOnly;
        preQ;
        preQRest;
        preQStressOnly;
        preTextRead = false;
        preTextReadStressOnly = false;
        preTracerPercentage;
        preTracerPercentageRest;
        previousStenosisInfo = struct();
        ptsA;
        ptsApex = [];
        ptsARest;
        ptsAStressOnly;
        ptsB;
        ptsBRest;
        ptsBStressOnly;
        ptsLAD = [];
        ptsLCx = [];
        ptsRCA = [];
        Re;
        ReRest;
        ReStressOnly;
        restImageSet;
        reversedALLFFRStressOnly = false;
        rmseA;
        rmseARest;
        rmseAStressOnly;
        rmseB;
        rmseBRest;
        rmseBStressOnly;
        roiM = 2;
        roiMRest = 2;
        roiMStressOnly = 2;
        roiN = 2;
        roiNRest = 2;
        roiNStressOnly = 2;
        roiObjectStressOnly = struct();
        rs1 = [];
        rs2 = [];
        rs3 = [];
        rxPost = [];
        rxPostRest = [];
        rxPostStressOnly = [];
        rxPre = [];
        rxPreRest = [];
        rxPreStressOnly = [];
        ryPost = [];
        ryPostRest = [];
        ryPostStressOnly = [];
        ryPre = [];
        ryPreRest = [];
        ryPreStressOnly = [];
        savedNetwork;
        scannerType = 'Siemens';
        scannerTypeRest = 'Siemens';
        scannerTypeStressOnly = 'Siemens';
        scannerName = ["Siemens", "Canon", "GE"];
        searchROIM = 6;
        searchROIMRest = 6;
        searchROIMStressOnly = 6;
        searchROIN = 6;
        searchROINRest = 6;
        searchROINStressOnly = 6;
        selectedTrainingOption = 'CNN';
        shearStressA;
        shearStressARest;
        shearStressAStressOnly;
        shearStressB;
        shearStressBRest;
        shearStressBStressOnly;
        sliceToBeInterpolatedWith;
        sliceToBeInterpolatedWithRest;
        sliceToBeInterpolatedWithStressOnly;
        stenosisData = struct();
        stenosisPercentage = [];
        supervisedLearningLabeledPoints;
        supervisedLearningSaveCount = 1;
        sxPost = [];
        sxPostRest = [];
        sxPostStressOnly = [];
        sxPre = [];
        sxPreRest = [];
        sxPreStressOnly = [];
        syPost = [];
        syPostRest = [];
        syPostStressOnly = [];
        syPre = [];
        syPreRest = [];
        syPreStressOnly = [];
        testDirectory;
        threeDVolume;
        thresholdSelection = 'Coronary Arteries';
        timeToCopy;
        timePoints;
        timePointsRest;
        timePointsStressOnly;
        timeUnit = 's';
        timeUnitRest = 's';
        timeUnitStressOnly = 's';
        tracerMassAtBranches;
        tracerMassAtTrunkAfterEachSideBranch;
        trainDirectory;
        trainedNetwork;
        trainingDS_LAD;
        trainingDS_RCA;
        trainingOptions = ["CNN", "UNET"];
        VA;
        validationDirectory;
        validationDS_LAD;
        validationDS_RCA;
        VARest;
        VAStressOnly;
        VB;
        VBRest;
        VBStressOnly;
        vesselThresholdMax;
        vesselThresholdMin;
        versionNumberDAI = 'a.11.5';
        viewMode = 'Normal';
        volumeJPEG;
        volumeofContrast;
        volumeofContrastRest;
        Vs1 = [];
        Vs2 = [];
        Vs3 = [];
        Vs1Rest = [];
        Vs2Rest = [];
        Vs3Rest = [];
        Vs1StressOnly = [];
        Vs2StressOnly = [];
        Vs3StressOnly = [];
        xDataEntryStressOnly;
        xDataExitStressOnly;
        xDataPreStressOnly;
        xDataPostStressOnly;
        xRayTubeVoltages = ["80", "100", "120"];
        xRayTubeVoltageIndex = 1;
        yAxisLimitMin = -50;
        yAxisLimitMax = 500;
    end

    methods (Access = private)

        function updateimage(app,imagefile)

            % Try displaying the image
            try
                app.im = imagefile;
            catch ME
                % Error
                uialert(app.UIFigure, ME.message, 'Image Error');
                return;
            end

            % Try showing the plots
            try
                imagesc(app.ImageAxes, app.im, [app.minWindow, app.maxWindow]);
                enableDefaultInteractivity(app.ImageAxes);
            catch ME
                % Error
                uialert(app.UIFigure, ME.message, 'Image Error');
                return;
            end

        end

        function updateimageStressOnly(app,imagefile)

            % Try displaying the image
            try
                app.imStressOnly = imagefile;
            catch ME
                % Error
                uialert(app.UIFigure, ME.message, 'Image Error');
                return;
            end

            % Try showing the plots
            try
                imagesc(app.ImageAxesStressOnly, app.imStressOnly, [app.minWindowStressOnly, app.maxWindowStressOnly]);
                enableDefaultInteractivity(app.ImageAxesStressOnly);
            catch ME
                % Error
                uialert(app.UIFigure, ME.message, 'Image Error');
                return;
            end

        end

        function updateImageRest(app,imagefile)

            % Try displaying the image
            try
                app.imRest = imagefile;
            catch ME
                % Error
                uialert(app.UIFigure, ME.message, 'Image Error');
                return;
            end


            % Try showing the plots
            try
                imagesc(app.ImageAxesRest, app.imRest, [app.minWindowRest, app.maxWindowRest]);
                enableDefaultInteractivity(app.ImageAxesRest);
            catch ME
                % Error
                uialert(app.UIFigure, ME.message, 'Image Error');
                return;
            end

        end

        function updateimage3D(app,imagefile)

            % Try displaying the image
            try
                app.im = imagefile;
            catch ME
                % Error
                uialert(app.UIFigure, ME.message, 'Image Error');
                return;
            end

            % Try showing the plots
            try
                imagesc(app.ImageAxes3D, app.im, [app.minWindow3D, app.maxWindow3D]);
            catch ME
                % Error
                uialert(app.UIFigure, ME.message, 'Image Error');
                return;
            end

        end

        function updateimage3DJPEG(app,imagefile)

            % Try displaying the image
            try
                app.imJPEG = imagefile;
            catch ME
                % Error
                uialert(app.UIFigure, ME.message, 'Image Error');
                return;
            end

            % Try showing the plots
            try
                imagesc(app.ImageAxes3DJPEG, app.imJPEG);
            catch ME
                % Error
                uialert(app.UIFigure, ME.message, 'Image Error');
                return;
            end

        end

        function updateimageCTA(app,imagefile)

            % Try displaying the image
            try
                app.imCTA = imagefile;
            catch ME
                % Error
                uialert(app.UIFigure, ME.message, 'Image Error');
                return;
            end

            % Try showing the plots
            try
                imagesc(app.ImageAxesCTAStressOnly, app.imCTA, [app.minWindowCTA, app.maxWindowCTA]);
            catch ME
                % Error
                uialert(app.UIFigure, ME.message, 'Image Error');
                return;
            end

        end

        function drawPreLesionCurve(app)
            drawCurve(app, 'pre', 'stress');
        end

        function drawPostLesionCurve(app)
            drawCurve(app, 'post', 'stress');
        end

        function drawPreLesionCurveRest(app)
            drawCurve(app, 'pre', 'rest');
        end

        function drawPostLesionCurveRest(app)
            drawCurve(app, 'post', 'rest');
        end

        function drawPreLesionCurveStressOnly(app)
            drawCurve(app, 'pre', 'stressOnly');
            app.xDataPreStressOnly = app.plotData.pre.data(1).xData;
        end

        function drawPostLesionCurveStressOnly(app)
            drawCurve(app, 'post', 'stressOnly');
            app.xDataPostStressOnly = app.plotData.post.data(1).xData;
        end

        function drawEntryCurveStressOnly(app)
            drawCurve(app, 'entry', 'stressOnly');
            % The xData for currentStenosisID will stay in 2 index further
            index = app.currentStenosisID * 2 + 1;
            app.xDataEntryStressOnly = app.plotData.pre.data(index).xData;
        end

        function drawExitCurveStressOnly(app)
            drawCurve(app, 'exit', 'stressOnly');
            % The xData for currentStenosisID will stay in 2 index further
            index = app.currentStenosisID * 2 + 1;
            app.xDataExitStressOnly = app.plotData.post.data(index).xData;
        end

        function onStenosisGuiClosed(app, ~, ~)
            app.MarkStenosisCheckBox.Value = false;
            app.numberOfStenosis = 0;

            app.entryCurveStressOnly = [];
            app.fittedCurveEntryStressOnly = [];
            app.exitCurveStressOnly = [];
            app.fittedCurveExitStressOnly = [];
            plotIDsToRemove = find(app.checkedStenosis);
            for i = 1:max(size(plotIDsToRemove))
                app.plotIDsToRemoveFromPlotArea(end+1) = plotIDsToRemove(i) * 2 + 1;
                app.plotIDsToRemoveFromPlotArea(end+1) = plotIDsToRemove(i) * 2 + 2;
            end
            app.plotIDsToRemoveFromPlotArea = unique(app.plotIDsToRemoveFromPlotArea);
            showPlot(app);
        end

        function onBranchGuiClosed(app, ~, ~)
            app.MarkBranchCheckBox.Value = false;
        end

        function onBreakerGuiClosed(app, ~, ~)
            app.MarkBreakerCheckBox.Value = false;
        end

        function StressImagesMenuLoader(app, choice)

            if (nargin < 2)
                choice = false;
            end

            % Display uigetfile dialog
            p = uigetdir;
            if (p == 0)
                % Do Nothing
                figure(app.UIFigure);
            else
                set(gcf, 'Pointer','watch');
                drawnow;
                figure(app.UIFigure);

                try
                    % Read dicom files:
                    [app.fourDImageSetStressOnly, app.timePointsStressOnly, app.timeUnitStressOnly, app.allDicomInfoStressOnly] = readAndSplitImages(p, app.scannerTypeStressOnly, choice);
                    app.dicomInfoStressOnly = app.allDicomInfoStressOnly{1};
                    app.interpolatedTimePointsStressOnly = app.timePointsStressOnly;
                    app.paTimePointsStressOnly = app.timePointsStressOnly;
                    app.pdTimePointsStressOnly = app.timePointsStressOnly;
                    app.entryTimePointStressOnly = app.timePointsStressOnly;
                    app.exitTimePointStressOnly = app.timePointsStressOnly;

                    set(gcf, 'Pointer','arrow');

                    % Make sure user didn't cancel uigetfile dialog
                    if (ischar(p))
                        % Generate the First Image, update sliders' positions and Send it for displaying

                        firstImage(1:512,1:512) = app.fourDImageSetStressOnly(1,1,1:512,1:512);
                        app.SlicesSliderStressOnly.Limits = [1 size(app.fourDImageSetStressOnly,1)];
                        tickValues = getSliderTicks(1, size(app.fourDImageSetStressOnly,1));
                        app.SlicesSliderStressOnly.MajorTicks = tickValues;
                        app.TimePointsSliderStressOnly.Limits = [1 size(app.fourDImageSetStressOnly,2)];
                        app.TimePointsSliderStressOnly.MajorTicks = getSliderTicks(1, size(app.fourDImageSetStressOnly,2));
                        app.TimePointsSliderStressOnly.MajorTickLabels = arrayfun(@num2str, app.TimePointsSliderStressOnly.MajorTicks, 'UniformOutput', 0);
                        app.SlicesSliderStressOnly.MinorTicks = [1:size(app.fourDImageSetStressOnly,1)];
                        app.FFRVsSliceLocation.XLim = [1 size(app.fourDImageSetStressOnly,1)];
                        minValue = min(app.fourDImageSetStressOnly(:));
                        maxValue = max(app.fourDImageSetStressOnly(:));
                        width = maxValue - minValue;
                        level = (maxValue + minValue) / 2;
                        app.minWindowStressOnly = level - width / 2;
                        app.maxWindowStressOnly = level + width / 2;
                        app.currentSliceStressOnly = 1;
                        app.currentTimePointStressOnly = 1;
                        app.SlicesSliderStressOnly.Value = 1;
                        app.SlicesSliderStressOnlyLabel.Text = sprintf('Slice %d/%d', app.currentSliceStressOnly, size(app.fourDImageSetStressOnly, 1));
                        app.TimePointsSliderStressOnly.Value = 1;
                        updateimageStressOnly(app, firstImage);
                    end

                    % Set Initial y axes limits
                    app.paPlotArea.YLim = [-50 500];
                    app.pdPlotArea.YLim = [-50 500];

                catch ME
                    set(gcf, 'Pointer','arrow');
                    msg = strcat('The DAI did not fail, there seems to be an issue with this dataset in particular: ', ME.message);
                    errordlg(msg);
                end

            end
        end

        function StreesImageLoaderInStressRestTab(app)
            % Display uigetfile dialog
            p = uigetdir;
            if (p == 0)
                % Do nothing
                figure(app.UIFigure);
            else
                set(gcf, 'Pointer','watch');
                drawnow;
                figure(app.UIFigure);

                try
                    % Read dicom files:
                    [app.fourDImageSet, app.timePoints, app.timeUnit, app.allDicomInfo] = readAndSplitImages(p, app.scannerType);
                    app.dicomInfo = app.allDicomInfo{1};
                    app.interpolatedTimePoints = app.timePoints;
                    set(gcf, 'Pointer','arrow');

                    % Make sure user didn't cancel uigetfile dialog
                    if (ischar(p))
                        % Generate the First Image, update sliders' positions and Send it for displaying
                        firstImage(1:512,1:512) = app.fourDImageSet(1,1,1:512,1:512);
                        app.SlicesSlider.Limits = [1 size(app.fourDImageSet,1)];
                        tickValues = getSliderTicks(1, size(app.fourDImageSet,1));
                        app.SlicesSlider.MajorTicks = tickValues;
                        app.TimePointsSlider.Limits = [1 size(app.fourDImageSet,2)];
                        app.TimePointsSlider.MajorTicks = [1:size(app.fourDImageSet,2)];
                        app.TimePointsSlider.MajorTickLabels = arrayfun(@num2str, app.TimePointsSlider.MajorTicks, 'UniformOutput', 0);
                        app.SlicesSlider.MinorTicks = [1:size(app.fourDImageSet,1)];
                        level = 500;
                        width = 1500;
                        app.minWindow = level - width / 2;
                        app.maxWindow = level + width / 2;
                        app.currentSlice = 1;
                        app.currentTimePoint = 1;
                        app.SlicesSlider.Value = 1;
                        app.SlicesSlider_2Label.Text = sprintf('Slice %d/%d', app.currentSlice, size(app.fourDImageSet, 1));
                        app.TimePointsSlider.Value = 1;
                        updateimage(app, firstImage);
                    end

                    % Set Initial y axes limits
                    app.paPlotArea.YLim = [-50 500];
                    app.pdPlotArea.YLim = [-50 500];
                catch ME
                    set(gcf, 'Pointer','arrow');
                    msg = strcat('The DAI did not fail, there seems to be an issue with this dataset in particular: ', ME.message);
                    errordlg(msg);
                end
            end
        end

        function RestImageLoaderInStressRestTab(app)
            % Display uigetfile dialog
            p = uigetdir;
            if (p == 0)
                % Do nothing
                figure(app.UIFigure);
            else
                set(gcf, 'Pointer','watch');
                drawnow;
                figure(app.UIFigure);

                try
                    % Read dicom files:
                    [app.restImageSet, app.timePointsRest, app.timeUnitRest, app.allDicomInfoRest] = readAndSplitImages(p, app.scannerTypeRest);
                    app.dicomInfoRest = app.allDicomInfoRest{1};
                    app.interpolatedTimePointsRest = app.timePointsRest;
                    set(gcf, 'Pointer','arrow');

                    % Make sure user didn't cancel uigetfile dialog
                    if (ischar(p))
                        % Generate the First Image, update sliders' positions and Send it for displaying
                        firstImage(1:512,1:512) = app.restImageSet(1,1,1:512,1:512);
                        app.SlicesSliderRest.Limits = [1 size(app.restImageSet,1)];
                        tickValues = getSliderTicks(1, size(app.restImageSet,1));
                        app.SlicesSliderRest.MajorTicks = tickValues;
                        app.TimePointsSliderRest.Limits = [1 size(app.restImageSet,2)];
                        app.TimePointsSliderRest.MajorTicks = [1:size(app.restImageSet,2)];
                        app.TimePointsSliderRest.MajorTickLabels = arrayfun(@num2str, app.TimePointsSliderRest.MajorTicks, 'UniformOutput', 0);
                        app.SlicesSliderRest.MinorTicks = [1:size(app.restImageSet,1)];
                        level = 500;
                        width = 1500;
                        app.minWindowRest = level - width / 2;
                        app.maxWindowRest = level + width / 2;
                        app.currentSliceRest = 1;
                        app.currentTimePointRest = 1;
                        app.SlicesSliderRest.Value = 1;
                        app.SlicesSliderLabelRest.Text = sprintf('Slice %d/%d', app.currentSliceRest, size(app.restImageSet, 1));
                        app.TimePointsSliderRest.Value = 1;
                        updateImageRest(app, firstImage);
                    end

                    % Set Initial y axes limits
                    app.paPlotArea.YLim = [-50 500];
                    app.pdPlotArea.YLim = [-50 500];
                catch ME
                    set(gcf, 'Pointer','arrow');
                    msg = strcat('The DAI did not fail, there seems to be an issue with this dataset in particular: ', ME.message);
                    errordlg(msg);
                end
            end
        end

        function updateCoordinates(app, axis)
            if (strcmp(axis,'pre'))
                app.HUTextArea.Value = sprintf('HU = %.2f',app.paPlotAreaStressOnly.CurrentPoint(1,2));
            end
            if (strcmp(axis,'post'))
                app.HUTextArea_2.Value = sprintf('HU = %.2f',app.pdPlotAreaStressOnly.CurrentPoint(1,2));
            end
        end
    end

    methods (Access = public)

        function getBreakerDataFromBreakerGUI(app)
            app.breakerData = app.breakerGuiData;
            if (app.breakerData.numberOfBreakers > 0)
                for slice = 1 : app.breakerData.numberOfBreakers
                    sliceLocation = app.breakerData.breakerSliceLocations(slice);
                    app.SlicesSliderStressOnly.Value = sliceLocation;
                    event = struct('Value', 1, 'PreviousValue', 0);
                    SlicesSliderStressOnlyValueChanging(app, event);
                    app.SlicesSliderStressOnlyLabel.Text = sprintf('Slice %d/%d', sliceLocation, size(app.fourDImageSetStressOnly, 1));

                    app.currentSliceStressOnly = sliceLocation;
                    imageData(1:512, 1:512) = app.fourDImageSetStressOnly(app.currentSliceStressOnly,app.currentTimePointStressOnly,1:512,1:512);
                    updateimageStressOnly(app,imageData);

                    pts = drawpoint(app.ImageAxesStressOnly);
                    pointsOnSlice = [app.currentSliceStressOnly, app.currentTimePointStressOnly, round(pts.Position(2)), round(pts.Position(1))];
                    app.allExtraPointsForDistanceInStressOnly(end+1) = pointsOnSlice(3);
                    app.allExtraPointsForDistanceInStressOnly(end+1) = pointsOnSlice(4);
                end
            end
        end

        function getBranchDataFromBranchGUI(app)
            % app.branchGuiData holds all the values from the BRANCHGUI.
            app.branchData = app.branchGuiData;
            app.numberOfBranches = sum(app.branchData.branchesCheckedOn);
            % app.tracerMassAtBranches = getTracerMassAtEverySideBranch(app);
        end

        function getStenosisDataFromStenosisGUI(app)

            app.checkedStenosis = [false, false, false, false, false];
            changedStenosis = [false, false, false, false, false];
            changedEntryExitSlice = [false, false, false, false, false];
            plotIDsToRemove = app.stenosisGuiData.plotToRemove;

            if (~isempty(plotIDsToRemove))
                for i = 1:max(size(plotIDsToRemove))
                    app.plotIDsToRemoveFromPlotArea(end+1) = plotIDsToRemove(i) * 2 + 1;
                    app.plotIDsToRemoveFromPlotArea(end+1) = plotIDsToRemove(i) * 2 + 2;
                end
                app.plotIDsToRemoveFromPlotArea = unique(app.plotIDsToRemoveFromPlotArea);
                showPlot(app);
            else
                app.plotIDsToRemoveFromPlotArea = [];
            end

            app.previousStenosisInfo.entryQ = app.entryQ;
            app.previousStenosisInfo.exitQ = app.exitQ;
            app.previousStenosisInfo.entrySliceLocations = app.entrySliceLocations;
            app.previousStenosisInfo.exitSliceLocations = app.exitSliceLocations;
            app.previousStenosisInfo.stenosisPercentage = app.stenosisPercentage;
            app.previousStenosisInfo.aucAEntryStressOnly = app.aucAEntryStressOnly;
            app.previousStenosisInfo.aucBExitStressOnly = app.aucBExitStressOnly;
            app.previousStenosisInfo.rs1 = app.rs1;
            app.previousStenosisInfo.rs2 = app.rs2;
            app.previousStenosisInfo.rs3 = app.rs3;

            app.entryQ = [];
            app.exitQ = [];
            app.entrySliceLocations = [];
            app.exitSliceLocations = [];
            app.stenosisPercentage = [];
            app.aucAEntryStressOnly = [];
            app.aucBExitStressOnly = [];
            app.rs1 = [];
            app.rs2 = [];
            app.rs3 = [];

            app.allStenosisData = app.stenosisGuiData;

            if (app.stenosisGuiData.Stenosis1CheckBox.Value == true)
                app.stenosisData(1).NumberOfBranchBeforeEntry = app.stenosisGuiData.NumberofbranchbetweenprelesionandstenosisEditField.Value;
                app.stenosisData(1).NumberOfBranchBeforeExit = app.stenosisGuiData.EditField.Value;
                app.stenosisData(1).Lumenradiusatimmediateexitcm = app.stenosisGuiData.ExitLumenRadiuscmEditField.Value;
                app.stenosisData(1).Lumenradiusatimmediateentrycm = app.stenosisGuiData.EntryLumenRadiuscmEditField.Value;
                app.stenosisData(1).Stenosis = app.stenosisGuiData.LumenNarrowingEditField.Value;
                if (isfield(app.stenosisData(1), 'Slicenumberforimmediateexit') && ~isempty(app.stenosisData(1).Slicenumberforimmediateentry) && app.stenosisData(1).Slicenumberforimmediateentry > 0)
                    if (app.stenosisData(1).Slicenumberforimmediateexit ~= app.stenosisGuiData.ExitSliceNumberEditField.Value)
                        app.stenosisData(1).Slicenumberforimmediateexit = app.stenosisGuiData.ExitSliceNumberEditField.Value;
                        changedStenosis(1) = true;
                        changedEntryExitSlice(1) = true;
                    end
                    if (app.stenosisData(1).Slicenumberforimmediateentry ~= app.stenosisGuiData.EntrySliceNumberEditField.Value)
                        app.stenosisData(1).Slicenumberforimmediateentry = app.stenosisGuiData.EntrySliceNumberEditField.Value;
                        changedStenosis(1) = true;
                        changedEntryExitSlice(1) = true;
                    end
                else
                    app.stenosisData(1).Slicenumberforimmediateexit = app.stenosisGuiData.ExitSliceNumberEditField.Value;
                    app.stenosisData(1).Slicenumberforimmediateentry = app.stenosisGuiData.EntrySliceNumberEditField.Value;
                    changedStenosis(1) = true;
                    changedEntryExitSlice(1) = true;
                end

                app.checkedStenosis(1) = true;
            else
                app.stenosisData(1).Lumenradiusatimmediateexitcm = 0;
                app.stenosisData(1).Lumenradiusatimmediateentrycm = 0;
                app.stenosisData(1).Stenosis = 0;
                app.stenosisData(1).Slicenumberforimmediateexit = 0;
                app.stenosisData(1).Slicenumberforimmediateentry = 0;
                app.stenosisData(1).NumberOfBranchBeforeEntry = 0;
                app.stenosisData(1).NumberOfBranchBeforeExit = 0;
            end

            if (app.stenosisGuiData.Stenosis2CheckBox.Value == true)
                app.stenosisData(2).NumberOfBranchBeforeEntry = app.stenosisGuiData.NumberofbranchbetweenprelesionandstenosisEditField_2.Value;
                app.stenosisData(2).NumberOfBranchBeforeExit = app.stenosisGuiData.EditField_2.Value;
                app.stenosisData(2).Lumenradiusatimmediateexitcm = app.stenosisGuiData.ExitLumenRadiuscmEditField_2.Value;
                app.stenosisData(2).Lumenradiusatimmediateentrycm = app.stenosisGuiData.EntryLumenRadiuscmEditField_2.Value;
                app.stenosisData(2).Stenosis = app.stenosisGuiData.LumenNarrowingEditField_2.Value;
                if (isfield(app.stenosisData(2), 'Slicenumberforimmediateexit') && ~isempty(app.stenosisData(2).Slicenumberforimmediateentry) && app.stenosisData(2).Slicenumberforimmediateentry > 0)
                    if (app.stenosisData(2).Slicenumberforimmediateexit ~= app.stenosisGuiData.ExitSliceNumberEditField_2.Value)
                        app.stenosisData(2).Slicenumberforimmediateexit = app.stenosisGuiData.ExitSliceNumberEditField_2.Value;
                        changedStenosis(2) = true;
                        changedEntryExitSlice(2) = true;
                    end
                    if (app.stenosisData(2).Slicenumberforimmediateentry ~= app.stenosisGuiData.EntrySliceNumberEditField_2.Value)
                        app.stenosisData(2).Slicenumberforimmediateentry = app.stenosisGuiData.EntrySliceNumberEditField_2.Value;
                        changedStenosis(2) = true;
                        changedEntryExitSlice(2) = true;
                    end
                else
                    app.stenosisData(2).Slicenumberforimmediateexit = app.stenosisGuiData.ExitSliceNumberEditField_2.Value;
                    app.stenosisData(2).Slicenumberforimmediateentry = app.stenosisGuiData.EntrySliceNumberEditField_2.Value;
                    changedStenosis(2) = true;
                    changedEntryExitSlice(2) = true;
                end
                app.checkedStenosis(2) = true;
            else
                app.stenosisData(2).Tracerpercentageatimmediateexit = 0;
                app.stenosisData(2).Tracerpercentageatimmediateentry = 0;
                app.stenosisData(2).Lumenradiusatimmediateexitcm = 0;
                app.stenosisData(2).Lumenradiusatimmediateentrycm = 0;
                app.stenosisData(2).Stenosis = 0;
                app.stenosisData(2).Slicenumberforimmediateexit = 0;
                app.stenosisData(2).Slicenumberforimmediateentry = 0;
                app.stenosisData(2).NumberOfBranchBeforeEntry = 0;
                app.stenosisData(2).NumberOfBranchBeforeExit = 0;
            end

            if (app.stenosisGuiData.Stenosis3CheckBox.Value == true)
                app.stenosisData(3).NumberOfBranchBeforeEntry = app.stenosisGuiData.NumberofbranchbetweenprelesionandstenosisEditField_3.Value;
                app.stenosisData(3).NumberOfBranchBeforeExit = app.stenosisGuiData.EditField_3.Value;
                app.stenosisData(3).Lumenradiusatimmediateexitcm = app.stenosisGuiData.ExitLumenRadiuscmEditField_3.Value;
                app.stenosisData(3).Lumenradiusatimmediateentrycm = app.stenosisGuiData.EntryLumenRadiuscmEditField_3.Value;
                app.stenosisData(3).Stenosis = app.stenosisGuiData.LumenNarrowingEditField_3.Value;
                if (isfield(app.stenosisData(3), 'Slicenumberforimmediateexit') && ~isempty(app.stenosisData(3).Slicenumberforimmediateentry) && app.stenosisData(3).Slicenumberforimmediateentry > 0)
                    if (app.stenosisData(3).Slicenumberforimmediateexit ~= app.stenosisGuiData.ExitSliceNumberEditField_3.Value)
                        app.stenosisData(3).Slicenumberforimmediateexit = app.stenosisGuiData.ExitSliceNumberEditField_3.Value;
                        changedStenosis(3) = true;
                        changedEntryExitSlice(3) = true;
                    end
                    if (app.stenosisData(3).Slicenumberforimmediateentry ~= app.stenosisGuiData.EntrySliceNumberEditField_3.Value)
                        app.stenosisData(3).Slicenumberforimmediateentry = app.stenosisGuiData.EntrySliceNumberEditField_3.Value;
                        changedStenosis(3) = true;
                        changedEntryExitSlice(3) = true;
                    end
                else
                    app.stenosisData(3).Slicenumberforimmediateexit = app.stenosisGuiData.ExitSliceNumberEditField_3.Value;
                    app.stenosisData(3).Slicenumberforimmediateentry = app.stenosisGuiData.EntrySliceNumberEditField_3.Value;
                    changedStenosis(3) = true;
                    changedEntryExitSlice(3) = true;
                end
                app.checkedStenosis(3) = true;
            else
                app.stenosisData(3).NumberOfBranchBeforeEntry = 0;
                app.stenosisData(3).NumberOfBranchBeforeExit = 0;
                app.stenosisData(3).Lumenradiusatimmediateexitcm = 0;
                app.stenosisData(3).Lumenradiusatimmediateentrycm = 0;
                app.stenosisData(3).Stenosis = 0;
                app.stenosisData(3).Slicenumberforimmediateexit = 0;
                app.stenosisData(3).Slicenumberforimmediateentry = 0;
            end

            if (app.stenosisGuiData.Stenosis4CheckBox.Value == true)
                app.stenosisData(4).NumberOfBranchBeforeEntry = app.stenosisGuiData.NumberofbranchbetweenprelesionandstenosisEditField_4.Value;
                app.stenosisData(4).NumberOfBranchBeforeExit = app.stenosisGuiData.EditField_4.Value;
                app.stenosisData(4).Lumenradiusatimmediateexitcm = app.stenosisGuiData.ExitLumenRadiuscmEditField_4.Value;
                app.stenosisData(4).Lumenradiusatimmediateentrycm = app.stenosisGuiData.EntryLumenRadiuscmEditField_4.Value;
                app.stenosisData(4).Stenosis = app.stenosisGuiData.LumenNarrowingEditField_4.Value;
                if (isfield(app.stenosisData(4), 'Slicenumberforimmediateexit') && ~isempty(app.stenosisData(4).Slicenumberforimmediateentry) && app.stenosisData(4).Slicenumberforimmediateentry > 0)
                    if (app.stenosisData(4).Slicenumberforimmediateexit ~= app.stenosisGuiData.ExitSliceNumberEditField_4.Value)
                        app.stenosisData(4).Slicenumberforimmediateexit = app.stenosisGuiData.ExitSliceNumberEditField_4.Value;
                        changedStenosis(4) = true;
                        changedEntryExitSlice(4) = true;
                    end
                    if(app.stenosisData(4).Slicenumberforimmediateentry ~= app.stenosisGuiData.EntrySliceNumberEditField_4.Value)
                        app.stenosisData(4).Slicenumberforimmediateentry = app.stenosisGuiData.EntrySliceNumberEditField_4.Value;
                        changedStenosis(4) = true;
                        changedEntryExitSlice(4) = true;
                    end
                else
                    app.stenosisData(4).Slicenumberforimmediateexit = app.stenosisGuiData.ExitSliceNumberEditField_4.Value;
                    app.stenosisData(4).Slicenumberforimmediateentry = app.stenosisGuiData.EntrySliceNumberEditField_4.Value;
                    changedStenosis(4) = true;
                    changedEntryExitSlice(4) = true;
                end
                app.checkedStenosis(4) = true;
            else
                app.stenosisData(4).NumberOfBranchBeforeEntry = 0;
                app.stenosisData(4).NumberOfBranchBeforeExit = 0;
                app.stenosisData(4).Lumenradiusatimmediateexitcm = 0;
                app.stenosisData(4).Lumenradiusatimmediateentrycm = 0;
                app.stenosisData(4).Stenosis = 0;
                app.stenosisData(4).Slicenumberforimmediateexit = 0;
                app.stenosisData(4).Slicenumberforimmediateentry = 0;
            end

            if (app.stenosisGuiData.Stenosis5CheckBox.Value == true)
                app.stenosisData(5).NumberOfBranchBeforeEntry = app.stenosisGuiData.NumberofbranchbetweenprelesionandstenosisEditField_5.Value;
                app.stenosisData(5).NumberOfBranchBeforeExit = app.stenosisGuiData.EditField_5.Value;
                app.stenosisData(5).Lumenradiusatimmediateexitcm = app.stenosisGuiData.ExitLumenRadiuscmEditField_5.Value;
                app.stenosisData(5).Lumenradiusatimmediateentrycm = app.stenosisGuiData.EntryLumenRadiuscmEditField_5.Value;
                app.stenosisData(5).Stenosis = app.stenosisGuiData.LumenNarrowingEditField_5.Value;
                if (isfield(app.stenosisData(5), 'Slicenumberforimmediateexit') && ~isempty(app.stenosisData(5).Slicenumberforimmediateentry) && app.stenosisData(5).Slicenumberforimmediateentry > 0)
                    if (app.stenosisData(5).Slicenumberforimmediateexit ~= app.stenosisGuiData.ExitSliceNumberEditField_5.Value)
                        app.stenosisData(5).Slicenumberforimmediateexit = app.stenosisGuiData.ExitSliceNumberEditField_5.Value;
                        changedStenosis(5) = true;
                        changedEntryExitSlice(5) = true;
                    end
                    if (app.stenosisData(5).Slicenumberforimmediateentry ~= app.stenosisGuiData.EntrySliceNumberEditField_5.Value)
                        app.stenosisData(5).Slicenumberforimmediateentry = app.stenosisGuiData.EntrySliceNumberEditField_5.Value;
                        changedStenosis(5) = true;
                        changedEntryExitSlice(5) = true;
                    end
                else
                    app.stenosisData(5).Slicenumberforimmediateexit = app.stenosisGuiData.ExitSliceNumberEditField_5.Value;
                    app.stenosisData(5).Slicenumberforimmediateentry = app.stenosisGuiData.EntrySliceNumberEditField_5.Value;
                    changedStenosis(5) = true;
                    changedEntryExitSlice(5) = true;
                end
                app.checkedStenosis(5) = true;
            else
                app.stenosisData(5).NumberOfBranchBeforeEntry = 0;
                app.stenosisData(5).NumberOfBranchBeforeExit = 0;
                app.stenosisData(5).Lumenradiusatimmediateexitcm = 0;
                app.stenosisData(5).Lumenradiusatimmediateentrycm = 0;
                app.stenosisData(5).Stenosis = 0;
                app.stenosisData(5).Slicenumberforimmediateexit = 0;
                app.stenosisData(5).Slicenumberforimmediateentry = 0;
            end

            % selectedIndices = find(checkedStenosis);
            % app.stenosisData = app.stenosisData(selectedIndices);
            % changedStenosis = changedStenosis(selectedIndices);

            app.numberOfStenosis = app.stenosisGuiData.numberOfStenosis;

            % At this point, changedStenosis contain a boolean vector, 1
            % representing if stenosis entry and exit location at that index
            % has been modified, 0 representing otherwise. If none of them
            % are modified, then no need to redraw the curves. Also
            % "plotIDsToRemoveFromPlotArea" contains plotIDs that need to
            % be removed.

            % Updating stenosis info into app data.
            if (app.numberOfStenosis > 0)
                for stenosis = 1 : app.maxStenosisSupported
                    entrySlice(stenosis) = app.stenosisData(stenosis).Slicenumberforimmediateentry;
                    app.entrySliceLocations(stenosis) = app.stenosisData(stenosis).Slicenumberforimmediateentry;
                    exitSlice(stenosis) = app.stenosisData(stenosis).Slicenumberforimmediateexit;
                    app.exitSliceLocations(stenosis) = app.stenosisData(stenosis).Slicenumberforimmediateexit;
                    percentage(stenosis) = app.stenosisData(stenosis).Stenosis/100;
                    app.stenosisPercentage(stenosis) = app.stenosisData(stenosis).Stenosis/100;
                    rs1(stenosis) = app.stenosisData(stenosis).Lumenradiusatimmediateentrycm;
                    app.rs1(stenosis) = app.stenosisData(stenosis).Lumenradiusatimmediateentrycm;
                    rs2(stenosis) = (1.0 - percentage(stenosis)) * rs1(stenosis);
                    app.rs2(stenosis) = (1.0 - percentage(stenosis)) * rs1(stenosis);
                    rs3(stenosis) = app.stenosisData(stenosis).Lumenradiusatimmediateexitcm;
                    app.rs3(stenosis) = app.stenosisData(stenosis).Lumenradiusatimmediateexitcm;
                    app.entryQ(stenosis) = 0;
                    app.exitQ(stenosis) = 0;
                end
            end

            % Based on the stenosis info, asking user to draw stenosis ROI
            if (~isempty(fieldnames(app.stenosisData)))
                for s = 1 : numel(entrySlice)
                    if (changedEntryExitSlice(s) == true)
                        app.currentStenosisID = s;

                        entrySliceNumber = entrySlice(s);
                        exitSliceNumber = exitSlice(s);

                        app.entryTimePointStressOnly = app.timePointsStressOnly;
                        app.exitTimePointStressOnly = app.timePointsStressOnly;

                        app.SlicesSliderStressOnly.Value = entrySliceNumber;
                        event = struct('Value', entrySliceNumber);
                        SlicesSliderStressOnlyValueChanging(app, event);
                        app.SlicesSliderStressOnlyLabel.Text = sprintf('Slice %d/%d', entrySliceNumber, size(app.fourDImageSetStressOnly, 1));

                        app.currentSliceStressOnly = entrySliceNumber;
                        imageData(1:512, 1:512) = app.fourDImageSetStressOnly(app.currentSliceStressOnly,app.currentTimePointStressOnly,1:512,1:512);
                        updateimageStressOnly(app,imageData);

                        pointsEntryStressOnly = drawpoint(app.ImageAxesStressOnly);
                        app.pEntryStressOnly = [app.currentSliceStressOnly, app.currentTimePointStressOnly, round(pointsEntryStressOnly.Position(2)), round(pointsEntryStressOnly.Position(1))];
                        fittedCurvePEntryStressOnly = zeros(size(app.timePointsStressOnly));
                        entrySliceStressOnly = app.currentSliceStressOnly;
                        entryCurrentTimePointStressOnly = app.currentTimePointStressOnly;
                        [app.entryCurveStressOnly, entryInterpolatedSampledPointsStressOnly, entryInterpolatedTimePointsStressOnly, app.entrySxStressOnly, app.entrySyStressOnly, entryRxStressOnly, entryRyStressOnly] = getBestSample(app.pEntryStressOnly(3),app.pEntryStressOnly(4),app.searchROIMStressOnly,app.roiMStressOnly,app.roiNStressOnly,app.currentSliceStressOnly,app.fourDImageSetStressOnly,app.entryTimePointStressOnly);
                        segmentationWindowSize = 25;
                        [imageWithContour, radiusIncm, areaOfContourInCmSq] = getContour(app.pEntryStressOnly(3),app.pEntryStressOnly(4),segmentationWindowSize,app.currentSliceStressOnly, entryCurrentTimePointStressOnly, app.fourDImageSetStressOnly, app.dicomInfoStressOnly.PixelSpacing);
                        imageData(1:512, 1:512) = app.fourDImageSetStressOnly(app.currentSliceStressOnly,app.currentTimePointStressOnly,1:512,1:512);
                        imageWithContour = getROIOverlayed(imageData, app.entrySxStressOnly, app.entrySyStressOnly);
                        updateimageStressOnly(app,imageWithContour);
                        drawEntryCurveStressOnly(app);

                        app.SlicesSliderStressOnly.Value = exitSliceNumber;
                        event = struct('Value', exitSliceNumber);
                        SlicesSliderStressOnlyValueChanging(app, event);
                        app.SlicesSliderStressOnlyLabel.Text = sprintf('Slice %d/%d', exitSliceNumber, size(app.fourDImageSetStressOnly, 1));

                        app.currentSliceStressOnly = exitSlice(s);
                        imageData(1:512, 1:512) = app.fourDImageSetStressOnly(app.currentSliceStressOnly,app.currentTimePointStressOnly,1:512,1:512);
                        updateimageStressOnly(app,imageData);

                        pointsExitStressOnly = drawpoint(app.ImageAxesStressOnly);
                        app.pExitStressOnly = [app.currentSliceStressOnly, app.currentTimePointStressOnly, round(pointsExitStressOnly.Position(2)), round(pointsExitStressOnly.Position(1))];
                        fittedCurvePExitStressOnly = zeros(size(app.timePointsStressOnly));
                        exitSliceStressOnly = app.currentSliceStressOnly;
                        exitCurrentTimePointStressOnly = app.currentTimePointStressOnly;
                        [app.exitCurveStressOnly, exitInterpolatedSampledPointsStressOnly, exitInterpolatedTimePointsStressOnly, app.exitSxStressOnly, app.exitSyStressOnly, exitRxStressOnly, exitRyStressOnly] = getBestSample(app.pExitStressOnly(3),app.pExitStressOnly(4),app.searchROIMStressOnly,app.roiMStressOnly,app.roiNStressOnly,app.currentSliceStressOnly,app.fourDImageSetStressOnly,app.exitTimePointStressOnly);
                        segmentationWindowSize = 25;
                        [imageWithContour, radiusIncm, areaOfContourInCmSq] = getContour(app.pExitStressOnly(3), app.pExitStressOnly(4),segmentationWindowSize,app.currentSliceStressOnly, exitCurrentTimePointStressOnly, app.fourDImageSetStressOnly, app.dicomInfoStressOnly.PixelSpacing);
                        imageData(1:512, 1:512) = app.fourDImageSetStressOnly(app.currentSliceStressOnly,app.currentTimePointStressOnly,1:512,1:512);
                        imageWithContour = getROIOverlayed(imageData, app.exitSxStressOnly, app.exitSyStressOnly);
                        updateimageStressOnly(app,imageWithContour);
                        drawExitCurveStressOnly(app);

                        app.entryRoiObjectStressOnly = getROI(app.dicomInfoStressOnly.PatientName.FamilyName, size(app.fourDImageSetStressOnly,2), size(app.fourDImageSetStressOnly,1), app.pEntryStressOnly(3), app.pEntryStressOnly(4), app.pEntryStressOnly(1), app.pEntryStressOnly(2), app.entryCurveStressOnly, app.entryTimePointStressOnly, app.fittedCurveEntryStressOnly, app.fittedTimeEntryStressOnly, app.entrySxStressOnly, app.entrySyStressOnly, 0, 0, app.numberOfStenosis, app.rs1(end), app.rs2(end), app.rs3(end), app.entryQ(end), app.exitQ(end));
                        app.roiObjectStressOnly.entryRoiObject(s) = app.entryRoiObjectStressOnly;
                        app.exitRoiObjectStressOnly = getROI(app.dicomInfoStressOnly.PatientName.FamilyName, size(app.fourDImageSetStressOnly,2), size(app.fourDImageSetStressOnly,1), app.pExitStressOnly(3), app.pExitStressOnly(4), app.pExitStressOnly(1), app.pExitStressOnly(2), app.exitCurveStressOnly, app.exitTimePointStressOnly, app.fittedCurveExitStressOnly, app.fittedTimeExitStressOnly, app.exitSxStressOnly, app.exitSyStressOnly, 0, 0, app.numberOfStenosis, app.rs1(end), app.rs2(end), app.rs3(end), app.entryQ(end), app.exitQ(end));
                        app.roiObjectStressOnly.exitRoiObject(s) = app.exitRoiObjectStressOnly;

                        if (app.numberOfStenosis > 1)

                            app.currentStenosisNumber = s;
                            FitCurvesButtonStressOnlyPushed(app);

                            app.currentStenosisNumber = s;
                            FitCurvesButtonStressOnly_2Pushed(app);
                        end
                    else
                        if (s > max(size(app.previousStenosisInfo.aucAEntryStressOnly)))
                            app.aucAEntryStressOnly(s) = 0;
                            app.aucBExitStressOnly(s) = 0;
                        else
                            app.aucAEntryStressOnly(s) = app.previousStenosisInfo.aucAEntryStressOnly(s);
                            app.aucBExitStressOnly(s) = app.previousStenosisInfo.aucBExitStressOnly(s);
                        end
                    end
                end
                saveRoiAsJson(app.roiObjectStressOnly);
            end
        end
    end


    % Callbacks that handle component events
    methods (Access = private)

        % Code that executes after component creation
        function startupFcn(app)
            % Update Version
            updateVersion(app);

            % Load Logo/Icon:
            app.UIFigure.Icon = 'Icon\Icon.jpg';

            % Full Menu Selected as Default
            FullMenuSelected(app);

            % Remove older Log files
            removeOlderLogFiles();

            % Configure image axes
            app.ImageAxes.Visible = 'off';
            app.ImageAxes.Colormap = gray(256);
            axis(app.ImageAxes, 'image');

            % Configure image axes rest
            app.ImageAxesRest.Visible = 'off';
            app.ImageAxesRest.Colormap = gray(256);
            axis(app.ImageAxesRest, 'image');

            % Configure image axes stress only
            app.ImageAxesStressOnly.Visible = 'off';
            app.ImageAxesStressOnly.Colormap = gray(256);
            axis(app.ImageAxesStressOnly, 'image');

            % Configure image axes 3D
            app.ImageAxes3D.Visible = 'off';
            app.ImageAxes3D.Colormap = gray(256);
            axis(app.ImageAxes3D, 'image');

            % Configure image axes 3D JPEG
            app.ImageAxes3DJPEG.Visible = 'off';
            app.ImageAxes3DJPEG.Colormap = gray(256);
            axis(app.ImageAxes3DJPEG, 'image');

            % Configure image axes CTA Stress Only
            app.ImageAxesCTAStressOnly.Visible = 'off';
            app.ImageAxesCTAStressOnly.Colormap = gray(256);
            axis(app.ImageAxesCTAStressOnly, 'image');

            % Configure FFR/Flow Velocity Plot
            yyaxis(app.FFRVsSliceLocation,'left');
            yyaxis(app.FFRVsSliceLocation,'right');
            ylabel(app.FFRVsSliceLocation, 'Flow Velocity (cm/s)');
            app.FFRVsSliceLocation.YLim = [0, 100];
            app.FFRVsSliceLocation.YAxis(1).Color = [0 0 0];
            app.FFRVsSliceLocation.YAxis(2).Color = [0 0 0];

            app.FFRVsSliceLocation.Title.Color = app.colorTitleFontNormalMode;
            app.paPlotAreaStressOnly.Title.Color = app.colorTitleFontNormalMode;
            app.pdPlotAreaStressOnly.Title.Color = app.colorTitleFontNormalMode;
            app.paPlotArea.Title.Color = app.colorTitleFontNormalMode;
            app.pdPlotArea.Title.Color = app.colorTitleFontNormalMode;
            % Update the image and histograms
            % Removed Initial Image Loading
        end

        % Callback function
        function DropDownValueChanged(app, event)

        end

        % Callback function
        function LoadStudiesButtonPushed(app, event)

        end

        % Value changing function: SlicesSlider
        function SlicesSliderValueChanging(app, event)
            sliceLimit = size(app.fourDImageSet,1);
            if (round(event.Value) > sliceLimit)
                changingValue = sliceLimit;
            else
                if (round(event.Value) == 0)
                    changingValue = 1;
                else
                    changingValue = round(event.Value);
                end
            end
            app.currentSlice = changingValue;
            app.SlicesSlider_2Label.Text = sprintf('Slice %d/%d', app.currentSlice, size(app.fourDImageSet, 1));
            imageData(1:512, 1:512) = app.fourDImageSet(app.currentSlice,app.currentTimePoint,1:512,1:512);
            if (~isempty(app.pa) && app.currentSlice == app.pa(1))
                imageData = getROIOverlayed(imageData, app.sxPre, app.syPre);
            elseif (~isempty(app.pd) && app.currentSlice == app.pd(1))
                imageData = getROIOverlayed(imageData, app.sxPost, app.syPost);
            end
            updateimage(app, imageData);
        end

        % Value changing function: TimePointsSlider
        function TimePointsSliderValueChanging(app, event)
            timePointsLimit = size(app.fourDImageSet,2);
            if (round(event.Value) > timePointsLimit)
                changingValue = timePointsLimit;
            else
                if (round(event.Value) == 0)
                    changingValue = 1;
                else
                    changingValue = round(event.Value);
                end
            end
            app.currentTimePoint = changingValue;
            imageData(1:512, 1:512) = app.fourDImageSet(app.currentSlice,app.currentTimePoint,1:512,1:512);
            if (~isempty(app.pa) && app.currentSlice == app.pa(1))
                imageData = getROIOverlayed(imageData, app.sxPre, app.syPre);
            elseif (~isempty(app.pd) && app.currentSlice == app.pd(1))
                imageData = getROIOverlayed(imageData, app.sxPost, app.syPost);
            end
            updateimage(app, imageData);

        end

        % Button pushed function: SetPreLesionButton
        function SetPreLesionButtonPushed(app, event)
            zoom(app.ImageAxes, 'off');
            app.ptsA = drawpoint(app.ImageAxes);
            app.pa = [app.currentSlice, app.currentTimePoint, round(app.ptsA.Position(2)), round(app.ptsA.Position(1))];
            app.fittedCurvePa = zeros(size(app.timePoints));
            app.paSlice = app.currentSlice;
            app.paTimePoint = app.currentTimePoint;
            [app.paCurve, app.interpolatedSampledPointsPa, app.interpolatedTimePoints, app.sxPre, app.syPre, app.rxPre, app.ryPre] = getBestSample(app.pa(3),app.pa(4),app.searchROIM,app.roiM,app.roiN,app.currentSlice,app.fourDImageSet,app.timePoints);
            segmentationWindowSize = 25;
            [imageWithContour, radiusIncm, areaOfContourInCmSq] = getContour(app.pa(3),app.pa(4),segmentationWindowSize,app.currentSlice, app.paTimePoint, app.fourDImageSet, app.dicomInfo.PixelSpacing);
            imageData(1:512, 1:512) = app.fourDImageSet(app.currentSlice,app.currentTimePoint,1:512,1:512);
            imageWithContour = getROIOverlayed(imageData, app.sxPre, app.syPre);
            updateimage(app,imageWithContour);
            radiusIncm
            areaOfContourInCmSq
            drawPreLesionCurve(app);
        end

        % Button pushed function: SetPostLesionButton
        function SetPostLesionButtonPushed(app, event)
            zoom(app.ImageAxes, 'off');
            app.ptsB = drawpoint(app.ImageAxes);
            app.pd = [app.currentSlice, app.currentTimePoint, round(app.ptsB.Position(2)), round(app.ptsB.Position(1))];
            app.fittedCurvePd = zeros(size(app.timePoints));
            app.pdSlice = app.currentSlice;
            app.pdTimePoint = app.currentTimePoint;
            [app.pdCurve, app.interpolatedSampledPointsPd, app.interpolatedTimePoints, app.sxPost, app.syPost, app.rxPost, app.ryPost] = getBestSample(app.pd(3),app.pd(4),app.searchROIM,app.roiM,app.roiN,app.currentSlice,app.fourDImageSet,app.timePoints);
            segmentationWindowSize = 25;
            [imageWithContour, radiusIncm, areaOfContourInCmSq] = getContour(app.pd(3),app.pd(4),segmentationWindowSize,app.currentSlice, app.pdTimePoint, app.fourDImageSet, app.dicomInfo.PixelSpacing);
            imageData(1:512, 1:512) = app.fourDImageSet(app.currentSlice,app.currentTimePoint,1:512,1:512);
            imageWithContour = getROIOverlayed(imageData, app.sxPost, app.syPost);
            updateimage(app,imageWithContour);
            radiusIncm
            areaOfContourInCmSq
            drawPostLesionCurve(app);
        end

        % Button pushed function: SetWindowButton
        function SetWindowButtonPushed(app, event)
            level = str2double(app.SetWindowLevel.Value{1});
            width = str2double(app.SetWindowWidth.Value{1});
            app.minWindow = level - width / 2;
            app.maxWindow = level + width / 2;
            imagesc(app.ImageAxes, app.im, [app.minWindow, app.maxWindow]);
            % updateimage(app, app.im);
        end

        % Button pushed function: FitStressCurveButton
        function FitStressCurveButtonPushed(app, event)
            % This function now handles only pre-lesion cases:

            if isrow(app.paCurve)
                app.paCurve = app.paCurve';
            end
            app.manualBaselineValue = str2double(app.ManualBaselineInput.Value);
            app.manualWashoutValue = str2double(app.ManualWashoutInput.Value);
            if isnan(app.manualBaselineValue)
                app.manualBaselineValue = 0;
            else
                app.manualBaselineValue = str2double(app.ManualBaselineInput.Value);
            end
            if isnan(app.manualWashoutValue)
                app.manualWashoutValue = 0;
            else
                app.manualWashoutValue = str2double(app.ManualWashoutInput.Value);
            end
            manualBaselineValuePreLesion = app.manualBaselineValue;
            manualWashoutValuePreLesion = app.manualWashoutValue;

            try
                [app.fittedCurvePa, app.fittedTimePa, app.paCurve, app.rmseA, app.kA, app.alphaA, app.betaA] = getFittedCurve(app.paCurve, app.plotX, manualBaselineValuePreLesion, manualWashoutValuePreLesion);
                app.aucA = getAreaUnderCurve(app.fittedCurvePa, app.fittedTimePa);
                if isrow(app.pdCurve)
                    app.pdCurve = app.pdCurve';
                end

                % Strees Pre and Strees Post
                if (strcmp(app.viewMode,'Dark'))
                    plot(app.paPlotArea, app.plotX, app.paCurve, 'yo', app.fittedTimePa, app.fittedCurvePa, 'y-');
                    legend(app.paPlotArea,'Pre-Lesion Sampled','Pre-Lesion Fitted', 'TextColor','white');
                    if (~all(app.fittedCurvePd) == 0)
                        plot(app.pdPlotArea, app.plotX, app.pdCurve, 'yo', app.fittedTimePd, app.fittedCurvePd, 'y-');
                        legend(app.pdPlotArea,'Post-Lesion Sampled','Post-Lesion Fitted', 'TextColor','white');
                    end

                    if(~isempty(app.paCurveRest))
                        if(~isempty(app.fittedCurvePaRest))
                            plot(app.paPlotArea, app.plotX, app.paCurve, 'yo', app.fittedTimePa, app.fittedCurvePa, 'y-', app.plotXRest, app.paCurveRest, 'ws', app.fittedTimePaRest, app.fittedCurvePaRest, 'w-');
                            legend(app.paPlotArea,'Pre-Lesion Sampled','Pre-Lesion Fitted','Pre-Rest','Pre-Rest-Fitted', 'TextColor','white');
                        else
                            plot(app.paPlotArea, app.plotX, app.paCurve, 'yo', app.fittedTimePa, app.fittedCurvePa, 'y-', app.plotXRest, app.paCurveRest, 'ws');
                            legend(app.paPlotArea,'Pre-Lesion Sampled','Pre-Lesion Fitted','Pre-Rest', 'TextColor','white');
                        end
                    end

                    if(~isempty(app.pdCurveRest))
                        if(~isempty(app.fittedCurvePdRest))
                            plot(app.pdPlotArea, app.plotX, app.pdCurve, 'yo', app.fittedTimePd, app.fittedCurvePd, 'y-', app.plotXRest, app.pdCurveRest, 'ws', app.fittedTimePdRest, app.fittedCurvePdRest, 'w-');
                            legend(app.pdPlotArea,'Post-Lesion Sampled','Post-Lesion Fitted','Post-Rest','Post-Rest-Fitted', 'TextColor','white');
                        else
                            plot(app.pdPlotArea, app.plotX, app.pdCurve, 'yo', app.fittedTimePd, app.fittedCurvePd, 'y-', app.plotXRest, app.pdCurveRest, 'ws');
                            legend(app.pdPlotArea,'Post-Lesion Sampled','Post-Lesion Fitted','Post-Rest', 'TextColor','white');
                        end
                    end
                else
                    plot(app.paPlotArea, app.plotX, app.paCurve, 'mo', app.fittedTimePa, app.fittedCurvePa, 'm-');
                    legend(app.paPlotArea,'Pre-Lesion Sampled','Pre-Lesion Fitted', 'TextColor','black');
                    if (~all(app.fittedCurvePd) == 0)
                        plot(app.pdPlotArea, app.plotX, app.pdCurve, 'mo', app.fittedTimePd, app.fittedCurvePd, 'm-');
                        legend(app.pdPlotArea,'Post-Lesion Sampled','Post-Lesion Fitted', 'TextColor','black');
                    end

                    if(~isempty(app.paCurveRest))
                        if(~isempty(app.fittedCurvePaRest))
                            plot(app.paPlotArea, app.plotX, app.paCurve, 'mo', app.fittedTimePa, app.fittedCurvePa, 'm-', app.plotXRest, app.paCurveRest, 'bs', app.fittedTimePaRest, app.fittedCurvePaRest, 'b-');
                            legend(app.paPlotArea,'Pre-Lesion Sampled','Pre-Lesion Fitted','Pre-Rest','Pre-Rest-Fitted', 'TextColor','black');
                        else
                            plot(app.paPlotArea, app.plotX, app.paCurve, 'mo', app.fittedTimePa, app.fittedCurvePa, 'm-', app.plotXRest, app.paCurveRest, 'bs');
                            legend(app.paPlotArea,'Pre-Lesion Sampled','Pre-Lesion Fitted','Pre-Rest', 'TextColor','black');
                        end
                    end

                    if(~isempty(app.pdCurveRest))
                        if(~isempty(app.fittedCurvePdRest))
                            plot(app.pdPlotArea, app.plotX, app.pdCurve, 'mo', app.fittedTimePd, app.fittedCurvePd, 'm-', app.plotXRest, app.pdCurveRest, 'bs', app.fittedTimePdRest, app.fittedCurvePdRest, 'b-');
                            legend(app.pdPlotArea,'Post-Lesion Sampled','Post-Lesion Fitted','Post-Rest','Post-Rest-Fitted', 'TextColor','black');
                        else
                            plot(app.pdPlotArea, app.plotX, app.pdCurve, 'mo', app.fittedTimePd, app.fittedCurvePd, 'm-', app.plotXRest, app.pdCurveRest, 'bs');
                            legend(app.pdPlotArea,'Post-Lesion Sampled','Post-Lesion Fitted','Post-Rest', 'TextColor','black');
                        end
                    end
                end
            catch ME
                msg = strcat('Problem in Curve Fitting:', ME.message);
                errordlg(msg);
            end
        end

        % Button pushed function: ComputeButton
        function ComputeButtonPushed(app, event)
            % Q has the unit mL * mg/mL = mg
            if strcmp(app.arteryType, 'Coronary')
                if (app.PrelesionTracerPercentageEditField.Value == "")
                    app.preTracerPercentage = 0.02;
                else
                    app.preTracerPercentage = str2double(app.PrelesionTracerPercentageEditField.Value)/100;
                end
                app.preQ = app.preTracerPercentage * str2double(app.ContrastVolumemLEditField.Value) * str2double(app.ContrastConcentrationmglmLEditField.Value);

                if (app.PostlesionTracerPercentageEditField.Value == "")
                    app.postTracerPercentage = 0.02;
                else
                    app.postTracerPercentage = str2double(app.PostlesionTracerPercentageEditField.Value)/100;
                end
                app.postQ = app.postTracerPercentage * str2double(app.ContrastVolumemLEditField.Value) * str2double(app.ContrastConcentrationmglmLEditField.Value);

                % Converting HUs to (mg/mL)s
                tempAucA = app.aucA / str2double(app.ConversionFactorEditField.Value);
                tempAucB = app.aucB / str2double(app.ConversionFactorEditField.Value);
            end

            if strcmp(app.arteryType, 'Aorta')
                if (app.PrelesionTracerPercentageEditField.Value == "")
                    app.preTracerPercentage = 0.94;
                else
                    app.preTracerPercentage = str2double(app.PrelesionTracerPercentageEditField.Value)/100;
                end
                app.preQ = app.preTracerPercentage * str2double(app.ContrastVolumemLEditField.Value) * str2double(app.ContrastConcentrationmglmLEditField.Value);

                if (app.PostlesionTracerPercentageEditField.Value == "")
                    app.postTracerPercentage = 0.94;
                else
                    app.postTracerPercentage = str2double(app.PostlesionTracerPercentageEditField.Value)/100;
                end
                app.postQ = app.postTracerPercentage * str2double(app.ContrastVolumemLEditField.Value) * str2double(app.ContrastConcentrationmglmLEditField.Value);
                % In which case it will be 98% - Aaron to send me a document describing it.
                % app.Q = 0.98 * str2double(app.ContrastVolumemLEditField.Value) * str2double(app.ContrastConcentrationmglmLEditField.Value);

                % Converting HUs to (mg/mL)s
                tempAucA = app.aucA / str2double(app.ConversionFactorEditField.Value);
                tempAucB = app.aucB / str2double(app.ConversionFactorEditField.Value);
            end

            if (~isempty(app.hBText))
                app.hB = app.hBText;
            else
                app.hB = getRelativeHeight(app.pa(1), app.pd(1), app.dicomInfo.SliceThickness, app.hAhBDiffNegative);
            end
            if (~isempty(app.LText))
                app.L = app.LText;
            else
                app.L = getDistanceBetweenSlicesAB(app.pa(3), app.pa(4), app.pd(3), app.pd(4),app.hB, app.dicomInfo.PixelSpacing);
            end

            if (app.ArterialRoughness.Value == "")
                app.ArterialRoughness.Value = '0';
            end

            % Radius values are in cm
            [app.FFR, app.VA, app.VB, app.shearStressA, app.shearStressB, app.pLE, app.pLF, app.Re, app.pB, app.frictionFactor, app.Vs1, app.Vs2, app.Vs3, app.pLC, app.pLS] = calculateFFR(tempAucA, tempAucB, app.preQ, app.postQ, app.hB, app.L, str2double(app.PrelesionLumenRadiuscmEditField.Value), str2double(app.PostlesionLumenRadiuscmEditField.Value), str2double(app.AorticBloodPressuremmHgEditField.Value), str2double(app.ArterialRoughness.Value), app.fMethod, 0);

            % Calculating CFR (if rest values are empty then CFR are also
            % empty)
            if isempty(app.VARest)
                app.preCFR = 0;
            else
                app.preCFR = app.VA/app.VARest;
            end
            if isempty(app.VBRest)
                app.postCFR = 0;
            else
                app.postCFR = app.VB/app.VBRest;
            end

            % Displaying output values
            app.FFREditField.Value = sprintf('%.4f',app.FFR);
            app.PrelesionFlowVelocitycmsEditField.Value = sprintf('%.4f',app.VA);
            app.PostlesionFlowVelocitycmsEditField.Value = sprintf('%.4f',app.VB);
            app.PrelesionShearStressPaEditField.Value = sprintf('%.4f',app.shearStressA);
            app.PostlesionShearStressPaEditField.Value = sprintf('%.4f',app.shearStressB);
            app.PrelesionCFREditField.Value = sprintf('%.4f',app.preCFR);
            app.PostlesionCFREditField.Value = sprintf('%.4f',app.postCFR);
            app.StressLabel.Visible = 'on';

            % Adding result to csvWriteMatrix
            stringForAllData = sprintf('%s,%s,%d,%d,(%d %d),(%d %d),%.4f,%.4f,%.4f,%.4f,%.4f,%d,%d,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f\n', datestr(now,'mm-dd-yyyy HH-MM-SS'),'Stress',app.pa(1),app.pd(1),app.pa(3),app.pa(4),app.pd(3),app.pd(4),app.FFR,app.VA,app.VB,app.shearStressA,app.shearStressB,app.aucA,app.aucB,app.alphaA,app.betaA,app.kA,app.alphaB,app.betaB,app.kB,app.preCFR,app.postCFR,app.pLE,app.pLF,app.Re,app.pB,app.frictionFactor,app.Vs1,app.Vs2,app.Vs3,app.pLC,app.pLS);
            app.allResultsForCSVWrite = append(app.allResultsForCSVWrite, newline, stringForAllData);

            stringForCoordinates = sprintf('%d,%d,%d,%d\n',app.pa(3),app.pa(4),app.pa(1),app.pa(2));
            app.coOrdinatesForCSVWrite = append(app.coOrdinatesForCSVWrite,newline,stringForCoordinates);
            stringForCoordinates = sprintf('%d,%d,%d,%d\n',app.pd(3),app.pd(4),app.pd(1),app.pd(2));
            app.coOrdinatesForCSVWrite = append(app.coOrdinatesForCSVWrite,newline,stringForCoordinates);

            saveCoordiantes(app);
        end

        % Button pushed function: ClearInputsButton
        function ClearInputsButtonPushed(app, event)
            % Clear all fields
            app.ContrastVolumemLEditField.Value = '';
            app.ContrastConcentrationmglmLEditField.Value = '';
            app.PrelesionLumenRadiuscmEditField.Value = '';
            app.PostlesionLumenRadiuscmEditField.Value = '';
            app.AorticBloodPressuremmHgEditField.Value = '';
            app.PrelesionTracerPercentageEditField.Value = '';
            app.PostlesionTracerPercentageEditField.Value = '';
            app.ConversionFactorEditField.Value = '';
            app.ArterialRoughness.Value = '';
        end

        % Selection changed function: FrictionFactorButtonGroup
        function FrictionFactorButtonGroupSelectionChanged(app, event)
            selectedButton = app.FrictionFactorButtonGroup.SelectedObject;
            app.fMethod = selectedButton.Text;
        end

        % Callback function
        function SaveResultsButtonPushed(app, event)

        end

        % Callback function
        function LoadPreLesionCurveButtonPushed(app, event)
            filterspec = {'*.txt','Text Files';'*.xlsx','Excel Files'};
            [f, p] = uigetfile(filterspec);
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);
            set(gcf, 'Pointer','arrow');

            logDAI('Checking chosen file type:');
            [~, name, ext] = fileparts(f);

            if (strcmp(ext,'.xlsx'))
                logDAI('File type is excel, reading excel file.');
                fName = strcat(p, f);
                data = readtable(fName);
                time = data{1:end, 1};
                roi = data{1:end, 2};
            end

            if (strcmp(ext,'.txt'))
                logDAI('File type is txt, reading txt file.');
                % Read text files:
                fileName = strcat(p,f);
                [time, roi] = readDataFile(fileName);
                if time(2) >= 500
                    time = time / 1000;
                end
            end

            % Make sure user didn't cancel uigetfile dialog
            if (ischar(p))
                logDAI('Plotting the curve');
                app.paCurve = roi;
                app.plotX = time;
                app.paPlotArea.YLim = [app.yAxisLimitMin app.yAxisLimitMax];
                interval = getPlotInterval(app.yAxisLimitMin, app.yAxisLimitMax);
                app.paPlotArea.YTick = [app.yAxisLimitMin:interval:app.yAxisLimitMax];
                app.paPlotArea.XLim = [1 max(time)];
                app.paPlotArea.XTick = [1:max(time)/10:max(time)];
                app.paPlotArea.XTick = cast(app.paPlotArea.XTick, 'int16');
                plot(app.paPlotArea, app.plotX, app.paCurve, 'mo');
                app.preTextRead = true;
                logDAI('Plotting the curve is successful');
            end

            if (app.preTextRead == true && app.postTextRead == true)
                app.RelativeHeightcmEditField.Enable = true;
                app.PrePostDistancecmEditField.Enable = true;
            end

        end

        % Callback function
        function LoadPostLesionCurveButtonPushed(app, event)
            filterspec = {'*.txt','Text Files';'*.xlsx','Excel Files'};
            [f, p] = uigetfile(filterspec);
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);
            set(gcf, 'Pointer','arrow');

            logDAI('Checking chosen file type:');
            [~, name, ext] = fileparts(f);

            if (strcmp(ext,'.xlsx'))
                logDAI('File type is excel, reading excel file.');
                fName = strcat(p, f);
                data = readtable(fName);
                time = data{1:end, 1};
                roi = data{1:end, 3};
            end

            if (strcmp(ext,'.txt'))
                logDAI('File type is txt, reading txt file.');
                % Read text files:
                fileName = strcat(p,f);
                [time, roi] = readDataFile(fileName);
                if time(2) >= 500
                    time = time / 1000;
                end
            end

            % Make sure user didn't cancel uigetfile dialog
            if (ischar(p))
                logDAI('Plotting the curve');
                app.pdCurve = roi;
                app.plotX = time;
                app.pdPlotArea.YLim = [app.yAxisLimitMin app.yAxisLimitMax];
                interval = getPlotInterval(app.yAxisLimitMin, app.yAxisLimitMax);
                app.pdPlotArea.YTick = [app.yAxisLimitMin:interval:app.yAxisLimitMax];
                app.pdPlotArea.XLim = [1 max(time)];
                app.pdPlotArea.XTick = [1:max(time)/10:max(time)];
                app.pdPlotArea.XTick = cast(app.pdPlotArea.XTick, 'int16');
                plot(app.pdPlotArea, app.plotX, app.pdCurve, 'mo');
                app.postTextRead = true;
                logDAI('Plotting the curve is successful');
            end

            if (app.preTextRead == true && app.postTextRead == true)
                app.RelativeHeightcmEditField.Enable = true;
                app.PrePostDistancecmEditField.Enable = true;
            end
        end

        % Selection changed function: ArteryTypeButtonGroup
        function ArteryTypeButtonGroupSelectionChanged(app, event)
            selectedButton = app.ArteryTypeButtonGroup.SelectedObject;
            app.arteryType = selectedButton.Text;
        end

        % Button down function: paPlotArea
        function paPlotAreaButtonDown(app, event)
            %pts = drawpoint(app.paPlotArea, 'Color','r');
            %dataPoint = round(pts.Position(1))

            % One way is to get the cursor position through event
            % event.IntersectionPoint

        end

        % Button down function: pdPlotArea
        function pdPlotAreaButtonDown(app, event)
            %pts = drawpoint(app.pdPlotArea, 'Color','b');
            %dataPoint = round(pts.Position(1))

        end

        % Callback function
        function ScreenCaptureButtonPushed(app, event)
            saveScreen(app);
        end

        % Callback function
        function ManualBaselineWashoutstressCheckBoxValueChanged(app, event)
            app.manualBaselineCheck = app.ManualBaselineWashoutstressCheckBox.Value;
            if (app.manualBaselineCheck == 1)
                app.ManualBaselineInput.Enable = true;
                app.ManualWashoutInput.Enable = true;
                app.PreLesionCheckBox.Enable = true;
                app.PostLesionCheckBox.Enable = true;
            end
            if (app.manualBaselineCheck == 0)
                app.ManualBaselineInput.Enable = false;
                app.ManualBaselineInput.Value = '';
                app.ManualWashoutInput.Enable = false;
                app.ManualWashoutInput.Value = '';
                app.PreLesionCheckBox.Enable = false;
                app.PostLesionCheckBox.Enable = false;
            end
        end

        % Callback function
        function LoadStudiesButtonRestPushed(app, event)

        end

        % Value changing function: TimePointsSliderRest
        function TimePointsSliderRestValueChanging(app, event)
            timePointsLimit = size(app.restImageSet,2);
            if (round(event.Value) > timePointsLimit)
                changingValue = timePointsLimit;
            else
                if (round(event.Value) == 0)
                    changingValue = 1;
                else
                    changingValue = round(event.Value);
                end
            end
            app.currentTimePointRest = changingValue;
            imageData(1:512, 1:512) = app.restImageSet(app.currentSliceRest,app.currentTimePointRest,1:512,1:512);
            if (~isempty(app.paRest) && app.currentSliceRest == app.paRest(1))
                imageData = getROIOverlayed(imageData, app.sxPreRest, app.syPreRest);
            elseif (~isempty(app.pdRest) && app.currentSliceRest == app.pdRest(1))
                imageData = getROIOverlayed(imageData, app.sxPostRest, app.syPostRest);
            end
            updateImageRest(app, imageData);
        end

        % Value changing function: SlicesSliderRest
        function SlicesSliderRestValueChanging(app, event)
            sliceLimit = size(app.restImageSet,1);
            if (round(event.Value) > sliceLimit)
                changingValue = sliceLimit;
            else
                if (round(event.Value) == 0)
                    changingValue = 1;
                else
                    changingValue = round(event.Value);
                end
            end
            app.currentSliceRest = changingValue;
            app.SlicesSliderLabelRest.Text = sprintf('Slice %d/%d', app.currentSliceRest, size(app.fourDImageSet, 1));
            imageData(1:512, 1:512) = app.restImageSet(app.currentSliceRest,app.currentTimePointRest,1:512,1:512);
            if (~isempty(app.paRest) && app.currentSliceRest == app.paRest(1))
                imageData = getROIOverlayed(imageData, app.sxPreRest, app.syPreRest);
            elseif (~isempty(app.pdRest) && app.currentSliceRest == app.pdRest(1))
                imageData = getROIOverlayed(imageData, app.sxPostRest, app.syPostRest);
            end
            updateImageRest(app, imageData);
        end

        % Button pushed function: SetWindowButtonRest
        function SetWindowButtonRestPushed(app, event)
            level = str2double(app.SetWindowLevelRest.Value{1});
            width = str2double(app.SetWindowWidthRest.Value{1});
            app.minWindowRest = level - width / 2;
            app.maxWindowRest = level + width / 2;
            imagesc(app.ImageAxesRest, app.imRest, [app.minWindowRest, app.maxWindowRest]);
        end

        % Button pushed function: ClearInputsButtonRest
        function ClearInputsButtonRestPushed(app, event)
            % Clear all fields
            app.ContrastVolumemLEditFieldRest.Value = '';
            app.ConcentrationofContrastmglmLEditFieldRest.Value = '';
            app.RadiusPreLesioncmEditFieldRest.Value = '';
            app.RadiusPostLesioncmEditFieldRest.Value = '';
            app.SystolicBloodPressuremmHgEditFieldRest.Value = '';
            app.PreTracerPercentageEditFieldRest.Value = '';
            app.PostTracerPercentageEditFieldRest.Value = '';
            app.ConversionFactorEditFieldRest.Value = '';
            app.ArterialRoughnessRest.Value = '';
        end

        % Callback function
        function ClearAllButtonPushed(app, event)
            ClearInputsButtonRestPushed(app, event);
            ClearInputsButtonPushed(app, event);
            ClearOutputsButtonPushed(app, event);
        end

        % Button pushed function: ClearOutputsButton
        function ClearOutputsButtonPushed(app, event)
            % Stress Output Clear:
            app.PostlesionShearStressPaEditField.Value = '';
            app.PrelesionShearStressPaEditField.Value = '';
            app.PostlesionFlowVelocitycmsEditField.Value = '';
            app.PrelesionFlowVelocitycmsEditField.Value = '';
            app.FFREditField.Value = '';
            app.PrelesionCFREditField.Value = '';
            app.PostlesionCFREditField.Value = '';
            app.StressLabel.Visible = 'off';

            % Rest Output Clear:
            app.PostShearStressPaEditFieldRest.Value = '';
            app.PreShearStressPaEditFieldRest.Value = '';
            app.PostLesionVelocitycmsEditFieldRest.Value = '';
            app.PreLesionVelocitycmsEditFieldRest.Value = '';
            app.FFREditFieldRest.Value = '';
            app.RestLabel.Visible = 'off';
        end

        % Button pushed function: SetPreLesionButtonRest
        function SetPreLesionButtonRestPushed(app, event)
            zoom(app.ImageAxesRest, 'off');
            app.ptsARest = drawpoint(app.ImageAxesRest);
            app.paRest = [app.currentSliceRest, app.currentTimePointRest, round(app.ptsARest.Position(2)), round(app.ptsARest.Position(1))];
            app.fittedCurvePaRest = zeros(size(app.timePointsRest));
            app.paSliceRest = app.currentSliceRest;
            app.paTimePointRest = app.currentTimePointRest;
            [app.paCurveRest, app.interpolatedSampledPointsPaRest, app.interpolatedTimePointsRest, app.sxPreRest, app.syPreRest, app.rxPreRest, app.ryPreRest] = getBestSample(app.paRest(3), app.paRest(4), app.searchROIMRest, app.roiMRest, app.roiNRest, app.currentSliceRest, app.restImageSet, app.timePointsRest);
            segmentationWindowSize = 25;
            [imageWithContour, radiusIncm, areaOfContourInCmSq] = getContour(app.paRest(3),app.paRest(4), segmentationWindowSize, app.currentSliceRest, app.paTimePointRest, app.restImageSet, app.dicomInfoRest.PixelSpacing);
            imageData(1:512, 1:512) = app.restImageSet(app.currentSliceRest,app.currentTimePointRest,1:512,1:512);
            imageWithContour = getROIOverlayed(imageData, app.sxPreRest, app.syPreRest);
            updateImageRest(app,imageWithContour);
            radiusIncm
            areaOfContourInCmSq
            drawPreLesionCurveRest(app);
        end

        % Button pushed function: SetPostLesionButtonRest
        function SetPostLesionButtonRestPushed(app, event)
            zoom(app.ImageAxesRest, 'off');
            app.ptsBRest = drawpoint(app.ImageAxesRest);
            app.pdRest = [app.currentSliceRest, app.currentTimePointRest, round(app.ptsBRest.Position(2)), round(app.ptsBRest.Position(1))];
            app.fittedCurvePdRest = zeros(size(app.timePointsRest));
            app.pdSliceRest = app.currentSliceRest;
            app.pdTimePointRest = app.currentTimePointRest;
            [app.pdCurveRest, app.interpolatedSampledPointsPdRest, app.interpolatedTimePointsRest, app.sxPostRest, app.syPostRest, app.rxPostRest, app.ryPostRest] = getBestSample(app.pdRest(3),app.pdRest(4), app.searchROIMRest, app.roiMRest, app.roiNRest, app.currentSliceRest, app.restImageSet, app.timePointsRest);
            segmentationWindowSize = 25;
            [imageWithContour, radiusIncm, areaOfContourInCmSq] = getContour(app.pdRest(3),app.pdRest(4), segmentationWindowSize, app.currentSliceRest, app.pdTimePointRest, app.restImageSet, app.dicomInfoRest.PixelSpacing);
            imageData(1:512, 1:512) = app.restImageSet(app.currentSliceRest,app.currentTimePointRest,1:512,1:512);
            imageWithContour = getROIOverlayed(imageData, app.sxPostRest, app.syPostRest);
            updateImageRest(app,imageWithContour);
            radiusIncm
            areaOfContourInCmSq
            drawPostLesionCurveRest(app);
        end

        % Button pushed function: OutputButtonRest
        function OutputButtonRestPushed(app, event)
            % Q has the unit mL * mg/mL = mg
            if strcmp(app.arteryTypeRest, 'Coronary')
                if (app.PreTracerPercentageEditFieldRest.Value == "")
                    app.preTracerPercentageRest = 0.02;
                else
                    app.preTracerPercentageRest = str2double(app.PreTracerPercentageEditFieldRest.Value)/100;
                end
                app.preQRest = app.preTracerPercentageRest * str2double(app.ContrastVolumemLEditFieldRest.Value) * str2double(app.ConcentrationofContrastmglmLEditFieldRest.Value);

                if (app.PostTracerPercentageEditFieldRest.Value == "")
                    app.postTracerPercentageRest = 0.02;
                else
                    app.postTracerPercentageRest = str2double(app.PostTracerPercentageEditFieldRest.Value)/100;
                end
                app.postQRest = app.postTracerPercentageRest * str2double(app.ContrastVolumemLEditFieldRest.Value) * str2double(app.ConcentrationofContrastmglmLEditFieldRest.Value);

                % Converting HUs to mg/mL
                tempAucA = app.aucARest / str2double(app.ConversionFactorEditFieldRest.Value);
                tempAucB = app.aucBRest / str2double(app.ConversionFactorEditFieldRest.Value);
            end

            if strcmp(app.arteryTypeRest, 'Aorta')
                if (app.PreTracerPercentageEditFieldRest.Value == "")
                    app.preTracerPercentageRest = 0.94;
                else
                    app.preTracerPercentageRest = str2double(app.PreTracerPercentageEditFieldRest.Value)/100;
                end
                app.preQRest = app.preTracerPercentageRest * str2double(app.ContrastVolumemLEditFieldRest.Value) * str2double(app.ConcentrationofContrastmglmLEditFieldRest.Value);

                if (app.PostTracerPercentageEditFieldRest.Value == "")
                    app.postTracerPercentageRest = 0.94;
                else
                    app.postTracerPercentageRest = str2double(app.PostTracerPercentageEditFieldRest.Value)/100;
                end
                app.postQRest = app.postTracerPercentageRest * str2double(app.ContrastVolumemLEditFieldRest.Value) * str2double(app.ConcentrationofContrastmglmLEditFieldRest.Value);
                % In which case it will be 98% - Aaron to send me a document describing it.
                % app.Q = 0.98 * str2double(app.ContrastVolumemLEditField.Value) * str2double(app.ContrastConcentrationmglmLEditField.Value);

                % Converting HUs to mg/mL
                tempAucA = app.aucARest / str2double(app.ConversionFactorEditFieldRest.Value);
                tempAucB = app.aucBRest / str2double(app.ConversionFactorEditFieldRest.Value);
            end

            app.hBRest = getRelativeHeight(app.paRest(1), app.pdRest(1), app.dicomInfoRest.SliceThickness, app.hAhBRestDiffNegative);
            app.LRest = getDistanceBetweenSlicesAB(app.paRest(3), app.paRest(4), app.pdRest(3), app.pdRest(4), app.hBRest, app.dicomInfoRest.PixelSpacing);

            if (app.ArterialRoughnessRest.Value == "")
                app.ArterialRoughnessRest.Value = '0';
            end

            % Radius values are in cm
            [app.FFRRest, app.VARest, app.VBRest, app.shearStressARest, app.shearStressBRest, app.pLERest, app.pLFRest, app.ReRest, app.pBRest, app.frictionFactorRest, app.Vs1Rest, app.Vs2Rest, app.Vs3Rest, app.pLCRest, app.pLSRest] = calculateFFR(tempAucA, tempAucB, app.preQRest, app.postQRest, app.hBRest, app.LRest, str2double(app.RadiusPreLesioncmEditFieldRest.Value), str2double(app.RadiusPostLesioncmEditFieldRest.Value), str2double(app.SystolicBloodPressuremmHgEditFieldRest.Value), str2double(app.ArterialRoughnessRest.Value), app.fMethodRest, 0);

            % Calculating CFR (if stress values are empty then CFR are also
            % empty)
            if isempty(app.VA)
                app.preCFR = 0;
            else
                app.preCFR = app.VA/app.VARest;
            end
            if isempty(app.VB)
                app.postCFR = 0;
            else
                app.postCFR = app.VB/app.VBRest;
            end

            % Displaying output values
            app.FFREditFieldRest.Value = sprintf('%.4f',app.FFRRest);
            app.PreLesionVelocitycmsEditFieldRest.Value = sprintf('%.4f',app.VARest);
            app.PostLesionVelocitycmsEditFieldRest.Value = sprintf('%.4f',app.VBRest);
            app.PreShearStressPaEditFieldRest.Value = sprintf('%.4f',app.shearStressARest);
            app.PostShearStressPaEditFieldRest.Value = sprintf('%.4f',app.shearStressBRest);
            app.PrelesionCFREditField.Value = sprintf('%.4f',app.preCFR);
            app.PostlesionCFREditField.Value = sprintf('%.4f',app.postCFR);
            app.RestLabel.Visible = 'on';

            % Adding result to csvWriteMatrix
            stringForAllData = sprintf('%s,%s,%d,%d,(%d %d),(%d %d),%.4f,%.4f,%.4f,%.4f,%.4f,%d,%d,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f\n', datestr(now,'mm-dd-yyyy HH-MM-SS'),'Rest',app.paRest(1),app.pdRest(1),app.paRest(3),app.paRest(4),app.pdRest(3),app.pdRest(4),app.FFRRest,app.VARest,app.VBRest,app.shearStressARest,app.shearStressBRest,app.aucARest,app.aucBRest,app.alphaARest,app.betaARest,app.kARest,app.alphaBRest,app.betaBRest,app.kBRest,app.preCFR,app.postCFR,app.pLERest,app.pLFRest,app.ReRest,app.pBRest,app.frictionFactorRest,app.Vs1Rest,app.Vs2Rest,app.Vs3Rest,app.pLCRest, app.pLSRest);
            app.allResultsForCSVWrite = append(app.allResultsForCSVWrite, newline, stringForAllData);

            stringForCoordinates = sprintf('%d,%d,%d,%d\n',app.paRest(3),app.paRest(4),app.paRest(1),app.paRest(2));
            app.coOrdinatesForCSVWriteRest = append(app.coOrdinatesForCSVWriteRest,newline,stringForCoordinates);
            stringForCoordinates = sprintf('%d,%d,%d,%d\n',app.pdRest(3),app.pdRest(4),app.pdRest(1),app.pdRest(2));
            app.coOrdinatesForCSVWriteRest = append(app.coOrdinatesForCSVWriteRest,newline,stringForCoordinates);

            saveCoordiantes(app);
        end

        % Button pushed function: FitCurvesButtonRest
        function FitCurvesButtonRestPushed(app, event)
            % This function now handles only pre-lesion cases:

            if isrow(app.paCurveRest)
                app.paCurveRest = app.paCurveRest';
            end
            app.manualBaselineValueRest = str2double(app.ManualBaselineInputRest.Value);
            app.manualWashoutValueRest = str2double(app.ManualWashoutInputRest.Value);
            if isnan(app.manualBaselineValueRest)
                app.manualBaselineValueRest = 0;
            else
                app.manualBaselineValueRest = str2double(app.ManualBaselineInputRest.Value);
            end
            if isnan(app.manualWashoutValueRest)
                app.manualWashoutValueRest = 0;
            else
                app.manualWashoutValueRest = str2double(app.ManualWashoutInputRest.Value);
            end
            manualBaselineValuePreLesionRest = app.manualBaselineValueRest;
            manualWashoutValuePreLesionRest = app.manualBaselineValueRest;

            try
                [app.fittedCurvePaRest, app.fittedTimePaRest, app.paCurveRest, app.rmseARest, app.kARest, app.alphaARest, app.betaARest] = getFittedCurve(app.paCurveRest, app.plotXRest, manualBaselineValuePreLesionRest, manualWashoutValuePreLesionRest);
                app.aucARest = getAreaUnderCurve(app.fittedCurvePaRest, app.fittedTimePaRest);
                if isrow(app.pdCurveRest)
                    app.pdCurveRest = app.pdCurveRest';
                end

                % Rest Pre and Rest Post
                if (strcmp(app.viewMode,'Dark'))
                    plot(app.paPlotArea, app.plotXRest, app.paCurveRest, 'ws', app.fittedTimePaRest, app.fittedCurvePaRest, 'w-');
                    legend(app.paPlotArea,'Pre-Rest','Pre-Rest-Fitted', 'TextColor','white');
                    if (~all(app.fittedCurvePdRest) == 0)
                        plot(app.pdPlotArea, app.plotXRest, app.pdCurveRest, 'ws', app.fittedTimePdRest, app.fittedCurvePdRest, 'w-');
                        legend(app.pdPlotArea,'Post-Rest','Post-Rest-Fitted', 'TextColor','white');
                    end

                    if(~isempty(app.paCurve))
                        if(~isempty(app.fittedCurvePa))
                            plot(app.paPlotArea, app.plotX, app.paCurve, 'yo', app.fittedTimePa, app.fittedCurvePa, 'y-', app.plotXRest, app.paCurveRest, 'ws', app.fittedTimePaRest, app.fittedCurvePaRest, 'w-');
                            legend(app.paPlotArea,'Pre-Lesion Sampled', 'Pre-Lesion Fitted', 'Pre-Rest','Pre-Rest-Fitted', 'TextColor','white');
                        else
                            plot(app.paPlotArea, app.plotX, app.paCurve, 'yo', app.plotXRest, app.paCurveRest, 'ws', app.fittedTimePaRest, app.fittedCurvePaRest, 'w-');
                            legend(app.paPlotArea,'Pre-Lesion Sampled','Pre-Rest','Pre-Rest-Fitted', 'TextColor','white');
                        end
                    end

                    if(~isempty(app.pdCurve))
                        if(~isempty(app.fittedCurvePd))
                            plot(app.pdPlotArea, app.plotX, app.pdCurve, 'yo', app.fittedTimePd, app.fittedCurvePd, 'y-', app.plotXRest, app.pdCurveRest, 'ws', app.fittedTimePdRest, app.fittedCurvePdRest, 'w-');
                            legend(app.pdPlotArea,'Post-Lesion Sampled','Post-Lesion Fitted', 'Post-Rest', 'Post-Rest-Fitted', 'TextColor','white');
                        else
                            plot(app.pdPlotArea, app.plotX, app.pdCurve, 'yo', app.plotXRest, app.pdCurveRest, 'ws', app.fittedTimePdRest, app.fittedCurvePdRest, 'w-');
                            legend(app.pdPlotArea,'Post-Lesion Sampled','Post-Rest','Post-Rest-Fitted', 'TextColor','white');
                        end
                    end
                else
                    plot(app.paPlotArea, app.plotXRest, app.paCurveRest, 'bs', app.fittedTimePaRest, app.fittedCurvePaRest, 'b-');
                    legend(app.paPlotArea,'Pre-Rest','Pre-Rest-Fitted', 'TextColor','black');
                    if (~all(app.fittedCurvePdRest) == 0)
                        plot(app.pdPlotArea, app.plotXRest, app.pdCurveRest, 'bs', app.fittedTimePdRest, app.fittedCurvePdRest, 'b-');
                        legend(app.pdPlotArea,'Post-Rest','Post-Rest-Fitted', 'TextColor','black');
                    end

                    if(~isempty(app.paCurve))
                        if(~isempty(app.fittedCurvePa))
                            plot(app.paPlotArea, app.plotX, app.paCurve, 'mo', app.fittedTimePa, app.fittedCurvePa, 'm-', app.plotXRest, app.paCurveRest, 'bs', app.fittedTimePaRest, app.fittedCurvePaRest, 'b-');
                            legend(app.paPlotArea,'Pre-Lesion Sampled', 'Pre-Lesion Fitted', 'Pre-Rest','Pre-Rest-Fitted', 'TextColor','black');
                        else
                            plot(app.paPlotArea, app.plotX, app.paCurve, 'mo', app.plotXRest, app.paCurveRest, 'bs', app.fittedTimePaRest, app.fittedCurvePaRest, 'b-');
                            legend(app.paPlotArea,'Pre-Lesion Sampled','Pre-Rest','Pre-Rest-Fitted', 'TextColor','black');
                        end
                    end

                    if(~isempty(app.pdCurve))
                        if(~isempty(app.fittedCurvePd))
                            plot(app.pdPlotArea, app.plotX, app.pdCurve, 'mo', app.fittedTimePd, app.fittedCurvePd, 'm-', app.plotXRest, app.pdCurveRest, 'bs', app.fittedTimePdRest, app.fittedCurvePdRest, 'b-');
                            legend(app.pdPlotArea,'Post-Lesion Sampled','Post-Lesion Fitted', 'Post-Rest', 'Post-Rest-Fitted', 'TextColor','black');
                        else
                            plot(app.pdPlotArea, app.plotX, app.pdCurve, 'mo', app.plotXRest, app.pdCurveRest, 'bs', app.fittedTimePdRest, app.fittedCurvePdRest, 'b-');
                            legend(app.pdPlotArea,'Post-Lesion Sampled','Post-Rest','Post-Rest-Fitted', 'TextColor','black');
                        end
                    end
                end
            catch ME
                msg = strcat('Problem in Curve Fitting:', ME.message);
                errordlg(msg);
            end
        end

        % Button pushed function: CopyRestInputsButton
        function CopyRestInputsButtonPushed(app, event)
            app.ContrastVolumemLEditField.Value = app.ContrastVolumemLEditFieldRest.Value;
            app.ContrastConcentrationmglmLEditField.Value = app.ConcentrationofContrastmglmLEditFieldRest.Value;
            app.PrelesionLumenRadiuscmEditField.Value = app.RadiusPreLesioncmEditFieldRest.Value;
            app.PostlesionLumenRadiuscmEditField.Value = app.RadiusPostLesioncmEditFieldRest.Value;
            app.AorticBloodPressuremmHgEditField.Value = app.SystolicBloodPressuremmHgEditFieldRest.Value;
            app.PrelesionTracerPercentageEditField.Value = app.PreTracerPercentageEditFieldRest.Value;
            app.PostlesionTracerPercentageEditField.Value = app.PostTracerPercentageEditFieldRest.Value;
            app.ConversionFactorEditField.Value = app.ConversionFactorEditFieldRest.Value;
            app.ArterialRoughness.Value = app.ArterialRoughnessRest.Value;
        end

        % Button pushed function: CopyStressInputsButton
        function CopyStressInputsButtonPushed(app, event)
            app.ContrastVolumemLEditFieldRest.Value = app.ContrastVolumemLEditField.Value;
            app.ConcentrationofContrastmglmLEditFieldRest.Value = app.ContrastConcentrationmglmLEditField.Value;
            app.RadiusPreLesioncmEditFieldRest.Value = app.PrelesionLumenRadiuscmEditField.Value;
            app.RadiusPostLesioncmEditFieldRest.Value = app.PostlesionLumenRadiuscmEditField.Value;
            app.SystolicBloodPressuremmHgEditFieldRest.Value = app.AorticBloodPressuremmHgEditField.Value;
            app.PreTracerPercentageEditFieldRest.Value = app.PrelesionTracerPercentageEditField.Value;
            app.PostTracerPercentageEditFieldRest.Value = app.PostlesionTracerPercentageEditField.Value;
            app.ConversionFactorEditFieldRest.Value = app.ConversionFactorEditField.Value;
            app.ArterialRoughnessRest.Value = app.ArterialRoughness.Value;
        end

        % Callback function
        function ManualBaselineWashoutrestCheckBoxValueChanged(app, event)
            app.manualBaselineCheckRest = app.ManualBaselineWashoutrestCheckBox.Value;
            if (app.manualBaselineCheckRest == 1)
                app.ManualBaselineInputRest.Enable = true;
                app.ManualWashoutInputRest.Enable = true;
                app.PreLesionCheckBoxRest.Enable = true;
                app.PostLesionCheckBoxRest.Enable = true;
            end
            if (app.manualBaselineCheckRest == 0)
                app.ManualBaselineInputRest.Enable = false;
                app.ManualBaselineInputRest.Value = '';
                app.ManualWashoutInputRest.Enable = false;
                app.ManualWashoutInputRest.Value = '';
                app.PreLesionCheckBoxRest.Enable = false;
                app.PostLesionCheckBoxRest.Enable = false;
            end
        end

        % Callback function
        function RelativeHeightcmEditFieldValueChanged(app, event)
            app.hBText = str2double(app.RelativeHeightcmEditField.Value);
        end

        % Callback function
        function PrePostDistancecmEditFieldValueChanged(app, event)
            app.LText = str2double(app.PrePostDistancecmEditField.Value);
        end

        % Value changed function: ManualZoomingCheckBox
        function ManualZoomingCheckBoxValueChanged(app, event)
            value = app.ManualZoomingCheckBox.Value;
            if (value == 1)
                app.ImageAxes.Interactions = zoomInteraction;
            end
            if (value == 0)
                zoom(app.ImageAxes, 'off');
            end
        end

        % Value changed function: ManualZoomingRestCheckBox
        function ManualZoomingRestCheckBoxValueChanged(app, event)
            value = app.ManualZoomingRestCheckBox.Value;
            if (value == 1)
                app.ImageAxesRest.Interactions = zoomInteraction;
            end
            if (value == 0)
                zoom(app.ImageAxesRest, 'off');
            end
        end

        % Value changed function: SamplingROIDropDown
        function SamplingROIDropDownValueChanged(app, event)
            value = app.SamplingROIDropDown.Value;
            app.roiM = str2double(value(1));
            app.roiN = str2double(value(3));
        end

        % Value changed function: ROIDropDownRest
        function ROIDropDownRestValueChanged(app, event)
            value = app.ROIDropDownRest.Value;
            app.roiMRest = str2double(value(1));
            app.roiNRest = str2double(value(3));
        end

        % Value changed function: veHeightCheckBox
        function veHeightCheckBoxValueChanged(app, event)
            value = app.veHeightCheckBox.Value;
            if (value == 1)
                app.hAhBDiffNegative = false;
            end
            if (value == 0)
                app.hAhBDiffNegative = true;
            end
        end

        % Value changed function: veHeightRestCheckBox
        function veHeightRestCheckBoxValueChanged(app, event)
            value = app.veHeightRestCheckBox.Value;
            if (value == 1)
                app.hAhBRestDiffNegative = false;
            end
            if (value == 0)
                app.hAhBRestDiffNegative = true;
            end
        end

        % Value changed function: SearchROIDropDown
        function SearchROIDropDownValueChanged(app, event)
            value = app.SearchROIDropDown.Value;
            if (value(2) == 'x')
                app.searchROIM = str2double(value(1));
                app.searchROIN = str2double(value(3));
            elseif (value(3) == 'x')
                app.searchROIM = str2double(value(1:2));
                app.searchROIN = str2double(value(4:5));
            end
        end

        % Value changed function: RestSearchROIDropDown
        function RestSearchROIDropDownValueChanged(app, event)
            value = app.RestSearchROIDropDown.Value;
            if (value(2) == 'x')
                app.searchROIMRest = str2double(value(1));
                app.searchROINRest = str2double(value(3));
            elseif (value(3) == 'x')
                app.searchROIMRest = str2double(value(1:2));
                app.searchROINRest = str2double(value(4:5));
            end
        end

        % Value changed function: 
        % InterpolateCurrentSliceWithDropDown
        function InterpolateCurrentSliceWithDropDownValueChanged(app, event)
            value = convertCharsToStrings(app.InterpolateCurrentSliceWithDropDown.Value);
            if (strcmp(value,'Previous Slice'))
                if (app.currentSlice > 1)
                    app.sliceToBeInterpolatedWith = app.currentSlice - 1;
                    interpolatedSliceForAllTimePoints = getInterpolatedSlice(app.currentSlice, app.sliceToBeInterpolatedWith, app.fourDImageSet);
                else
                    errordlg('Current Slice Cannot Have Previous Slice','Slice Choose Error');
                end
            elseif (strcmp(value,'Next Slice'))
                if (app.currentSlice < size(app.fourDImageSet,1))
                    app.sliceToBeInterpolatedWith = app.currentSlice + 1;
                    interpolatedSliceForAllTimePoints = getInterpolatedSlice(app.currentSlice, app.sliceToBeInterpolatedWith, app.fourDImageSet);
                else
                    errordlg('Current Slice Cannot Have Next Slice','Slice Choose Error');
                end
            elseif ((strcmp(value,'None')))
                % Do nothing
            end

            tempFourDImageSet = app.fourDImageSet;
            tempFourDImageSet(app.currentSlice,:,:,:) = interpolatedSliceForAllTimePoints;
            if (app.currentSlice == app.pa(1))
                % copy pre slice's coordinate
                [app.paCurve, app.interpolatedSampledPointsPa, app.interpolatedTimePoints, app.sxPre, app.syPre, app.rxPre, app.ryPre] = getBestSample(app.pa(3),app.pa(4),app.searchROIM,app.roiM,app.roiN,app.currentSlice,tempFourDImageSet,app.timePoints);
                drawPreLesionCurve(app);
            elseif (app.currentSlice == app.pd(1))
                % copy post slice's coordinate
                [app.pdCurve, app.interpolatedSampledPointsPd, app.interpolatedTimePoints, app.sxPost, app.syPost, app.rxPost, app.ryPost] = getBestSample(app.pd(3),app.pd(4),app.searchROIM,app.roiM,app.roiN,app.currentSlice,tempFourDImageSet,app.timePoints);
                drawPostLesionCurve(app);
            end
        end

        % Value changed function: 
        % InterpolateCurrentSliceWithDropDownRest
        function InterpolateCurrentSliceWithDropDownRestValueChanged(app, event)
            value = convertCharsToStrings(app.InterpolateCurrentSliceWithDropDownRest.Value);
            if (strcmp(value,'Previous Slice'))
                if (app.currentSliceRest > 1)
                    app.sliceToBeInterpolatedWithRest = app.currentSliceRest - 1;
                    interpolatedSliceForAllTimePoints = getInterpolatedSlice(app.currentSliceRest, app.sliceToBeInterpolatedWithRest, app.restImageSet);
                else
                    errordlg('Current Slice Cannot Have Previous Slice','Slice Choose Error');
                end
            elseif (strcmp(value,'Next Slice'))
                if (app.currentSliceRest < size(app.restImageSet,1))
                    app.sliceToBeInterpolatedWithRest = app.currentSliceRest + 1;
                    interpolatedSliceForAllTimePoints = getInterpolatedSlice(app.currentSliceRest, app.sliceToBeInterpolatedWithRest, app.restImageSet);
                else
                    errordlg('Current Slice Cannot Have Next Slice','Slice Choose Error');
                end
            elseif ((strcmp(value,'None')))
                % Do nothing
            end

            tempRestImageSet = app.restDImageSet;
            tempRestImageSet(app.currentSliceRest,:,:,:) = interpolatedSliceForAllTimePoints;
            if (app.currentSliceRest == app.paRest(1))
                % copy pre slice rest's coordinate
                [app.paCurveRest, app.interpolatedSampledPointsPaRest, app.interpolatedTimePointsRest, app.sxPreRest, app.syPreRest, app.rxPreRest, app.ryPreRest] = getBestSample(app.paRest(3), app.paRest(4), app.searchROIMRest, app.roiMRest, app.roiNRest, app.currentSliceRest, tempRestImageSet, app.timePointsRest);
                drawPreLesionCurveRest(app);
            elseif (app.currentSliceRest == app.pdRest(1))
                % copy post slice rest's coordinate
                [app.pdCurveRest, app.interpolatedSampledPointsPdRest, app.interpolatedTimePointsRest, app.sxPostRest, app.syPostRest, app.rxPostRest, app.ryPostRest] = getBestSample(app.pdRest(3),app.pdRest(4), app.searchROIMRest, app.roiMRest, app.roiNRest, app.currentSliceRest, tempRestImageSet, app.timePointsRest);
                drawPostLesionCurveRest(app);
            end
        end

        % Callback function
        function ExportCurveButtonPushed(app, event)
            if (~isempty(app.paCurve))
                if (isempty(app.ConversionFactorEditField))
                    tempAucA = app.aucA;
                    tempAucB = app.aucB;
                else
                    tempAucA = app.aucA / str2double(app.ConversionFactorEditField.Value);
                    tempAucB = app.aucB / str2double(app.ConversionFactorEditField.Value);
                end
                exportCurves(app.paCurve, app.pdCurve, app.fittedCurvePa, app.fittedCurvePd, app.timePoints, app.fittedTimePa, tempAucA, tempAucB, app.dicomInfo.PatientName.FamilyName, 'Stress');
            end
            if (~isempty(app.paCurveRest))
                if (isempty(app.ConversionFactorEditField))
                    tempAucA = app.aucARest;
                    tempAucB = app.aucBRest;
                else
                    tempAucA = app.aucARest / str2double(app.ConversionFactorEditFieldRest.Value);
                    tempAucB = app.aucBRest / str2double(app.ConversionFactorEditFieldRest.Value);
                end
                exportCurves(app.paCurveRest, app.pdCurveRest, app.fittedCurvePaRest, app.fittedCurvePdRest, app.timePointsRest, app.fittedTimePaRest, tempAucA, tempAucB, app.dicomInfoRest.PatientName.FamilyName, 'Rest');
            end
        end

        % Callback function
        function ExportStressStudiesButtonPushed(app, event)
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);

            writeDicomVolume(app.fourDImageSet, app.allDicomInfo, 'Stress');

            set(gcf, 'Pointer','arrow');
        end

        % Callback function
        function ExportRestStudiesButtonPushed(app, event)
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);

            writeDicomVolume(app.restImageSet, app.allDicomInfoRest, 'Rest');

            set(gcf, 'Pointer','arrow');
        end

        % Value changed function: ContrastVolumemLEditField
        function ContrastVolumemLEditFieldValueChanged(app, event)
            value = app.ContrastVolumemLEditField.Value;

        end

        % Value changed function: PrelesionLumenRadiuscmEditField
        function PrelesionLumenRadiuscmEditFieldValueChanged(app, event)
            value = app.PrelesionLumenRadiuscmEditField.Value;

        end

        % Value changed function: 
        % ContrastConcentrationmglmLEditField
        function ContrastConcentrationmglmLEditFieldValueChanged(app, event)
            value = app.ContrastConcentrationmglmLEditField.Value;

        end

        % Value changed function: TimePointsSlider
        function TimePointsSliderValueChanged(app, event)
            value = app.TimePointsSlider.Value;

        end

        % Value changed function: SlicesSlider
        function SlicesSliderValueChanged(app, event)
            value = app.SlicesSlider.Value;

        end

        % Value changed function: SetWindowLevel
        function SetWindowLevelValueChanged(app, event)
            value = app.SetWindowLevel.Value;

        end

        % Value changed function: ManualBaselineInput
        function ManualBaselineInputValueChanged(app, event)
            value = app.ManualBaselineInput.Value;

        end

        % Callback function
        function Load3DVolumeStressButtonPushed(app, event)

        end

        % Callback function
        function Load3DCTAVolumeButtonPushed(app, event)
            % Display uigetfile dialog
            filterspec = {'*.*','All Files'};
            [f, p] = uigetfile(filterspec);
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);

            try
                % Read 3D volume:
                [app.threeDVolume,sp] = dicomreadVolume(p);
                app.threeDVolume = squeeze(app.threeDVolume);

                logDAI('Converting dicomVolume to jpegVolume');
                app.volumeJPEG = getJPEGVolumeFromDicomVolume(app.threeDVolume, 3);

                app.labelImageDirectory = p;

                app.SlicesSlider3D.Limits = [1 size(app.threeDVolume,3)];

                set(gcf, 'Pointer','arrow');

                level = 500;
                width = 1500;
                app.minWindow3D = level - width / 2;
                app.maxWindow3D = level + width / 2;

                % Make sure user didn't cancel uigetfile dialog
                if (ischar(p))
                    firstImage = app.threeDVolume(:,:,1);
                    updateimage3D(app,firstImage);

                    firstImageJPEG(:,:,:) = app.volumeJPEG(:,:,1,:);
                    updateimage3DJPEG(app,firstImageJPEG);
                end
            catch ME
                set(gcf, 'Pointer','arrow');
                msg = strcat('The DAI did not fail, there seems to be an issue with this dataset in particular: ', ME.message);
                errordlg(msg);
            end
        end

        % Callback function
        function ApplyDefaultThresholdsCheckBoxValueChanged(app, event)

        end

        % Callback function
        function DefaultThresholdsButtonGroupSelectionChanged(app, event)

        end

        % Callback function
        function ApplyThresholdButtonPushed(app, event)

        end

        % Callback function
        function LoadTrainingDataButtonPushed(app, event)
            app.trainDirectory = uigetdir;
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);
            set(gcf, 'Pointer','arrow');
        end

        % Callback function
        function LoadTestingDataButtonPushed(app, event)
            app.testDirectory = uigetdir;
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);
            set(gcf, 'Pointer','arrow');
        end

        % Callback function
        function LoadValidationDataButtonPushed(app, event)
            app.validationDirectory = uigetdir;
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);
            set(gcf, 'Pointer','arrow');
        end

        % Callback function
        function StartTrainingButtonPushed(app, event)

            % Get Data Ready:
            trainingDS = getData(app.trainDirectory);
            validationDS = getData(app.validationDirectory);

            % Training Option:
            if strcmp(app.NetworkOptionButtonGroup.SelectedObject.Text, 'CNN')
                trainingOption = 'CNN';
            end

            if strcmp(app.NetworkOptionButtonGroup.SelectedObject.Text, 'UNET')
                trainingOption = 'UNET';
            end

            app.trainedNetwork = getTraining(trainingDS, validationDS, trainingOption);
            networkName = sprintf('%s/%s', 'TrainedNetwork', datestr(now,'yyyymmddTHHMMSSFFF'));
            save(networkName, app.trainedNetwork);

        end

        % Callback function
        function ClassifyRCACheckBoxValueChanged(app, event)

        end

        % Callback function
        function ClassifyLADCheckBoxValueChanged(app, event)

        end

        % Callback function
        function LoadSavedNetworkButtonPushed(app, event)
            [f, p] = uigetfile();
            app.savedNetWork = coder.loadDeepLearningNetwork(p);
            app.trainedNetwork = app.savedNetwork;
        end

        % Callback function
        function ClassifyButtonPushed(app, event)
            testingDS = getData(app.testDirectory, 0, 0, labelName);
            predictedData = classify(app.trainedNetwork, testingDS);
        end

        % Button pushed function: SetRCAPointButton
        function SetRCAPointButtonPushed(app, event)
            ptsValue = drawpoint(app.ImageAxes3D);
            app.ptsRCA(end+1) = app.currentSlice3D;
            app.ptsRCA(end+1) = round(ptsValue.Position(2));
            app.ptsRCA(end+1) = round(ptsValue.Position(1));
            % Quadruplet of (Slice #, X, Y, PixelValue)
            app.supervisedLearningLabeledPoints{end+1} = 'rca';
            logDAI('RCA point adding completed.');
            logDAI('Putting point on JPEG volume');
            img = app.threeDVolume(:,:,app.currentSlice3D);
            imgJPEG(:,:,:) = app.volumeJPEG(:,:,app.currentSlice3D,:);
            app.ptsRCA(end+1) = imgJPEG(round(ptsValue.Position(2)), round(ptsValue.Position(1)));
            imgJPEG = getColoredPointForMarkedCoordinate(imgJPEG, round(ptsValue.Position(2)), round(ptsValue.Position(1)), [255.0, 0.0, 0.0]);
            app.volumeJPEG(:,:,app.currentSlice3D,:) = imgJPEG(:,:,:);
            updateimage3D(app, img);
            updateimage3DJPEG(app,imgJPEG);
        end

        % Value changing function: SlicesSlider3D
        function SlicesSlider3DValueChanging(app, event)
            sliceLimit = size(app.threeDVolume,3);
            if (round(event.Value) > sliceLimit)
                changingValue = sliceLimit;
            else
                if (round(event.Value) == 0)
                    changingValue = 1;
                else
                    changingValue = round(event.Value);
                end
            end
            app.currentSlice3D = changingValue;
            app.SlicesSlider3DLabel.Text = sprintf('Slice %d/%d', app.currentSlice3D, size(app.threeDVolume, 3));
            imageData(1:512, 1:512) = app.threeDVolume(1:512,1:512,app.currentSlice3D);
            imageDataJPEG(1:512, 1:512, :) = app.volumeJPEG(1:512,1:512,app.currentSlice3D,:);

            updateimage3D(app, imageData);
            updateimage3DJPEG(app, imageDataJPEG);
        end

        % Callback function
        function LoadStudiesButtonStressOnlyPushed(app, event)

        end

        % Value changing function: SlicesSliderStressOnly
        function SlicesSliderStressOnlyValueChanging(app, event)
            sliceLimit = size(app.fourDImageSetStressOnly,1);
            if (round(event.Value) > sliceLimit)
                changingValue = sliceLimit;
            else
                if (round(event.Value) == 0)
                    changingValue = 1;
                else
                    changingValue = round(event.Value);
                end
            end
            app.currentSliceStressOnly = changingValue;
            app.SlicesSliderStressOnlyLabel.Text = sprintf('Slice %d/%d', app.currentSliceStressOnly, size(app.fourDImageSetStressOnly, 1));
            imageData(1:512, 1:512) = app.fourDImageSetStressOnly(app.currentSliceStressOnly,app.currentTimePointStressOnly,1:512,1:512);
            if (~isempty(app.paStressOnly) && app.currentSliceStressOnly == app.paStressOnly(1))
                imageData = getROIOverlayed(imageData, app.sxPreStressOnly, app.syPreStressOnly);
            elseif (~isempty(app.pdStressOnly) && app.currentSliceStressOnly == app.pdStressOnly(1))
                imageData = getROIOverlayed(imageData, app.sxPostStressOnly, app.syPostStressOnly);
            end
            updateimageStressOnly(app, imageData);
        end

        % Value changing function: TimePointsSliderStressOnly
        function TimePointsSliderStressOnlyValueChanging(app, event)
            timePointsLimit = size(app.fourDImageSetStressOnly,2);
            if (round(event.Value) > timePointsLimit)
                changingValue = timePointsLimit;
            else
                if (round(event.Value) == 0)
                    changingValue = 1;
                else
                    changingValue = round(event.Value);
                end
            end
            app.currentTimePointStressOnly = changingValue;
            imageData(1:512, 1:512) = app.fourDImageSetStressOnly(app.currentSliceStressOnly,app.currentTimePointStressOnly,1:512,1:512);
            if (~isempty(app.paStressOnly) && app.currentSliceStressOnly == app.paStressOnly(1))
                imageData = getROIOverlayed(imageData, app.sxPreStressOnly, app.syPreStressOnly);
            elseif (~isempty(app.pdStressOnly) && app.currentSliceStressOnly == app.pdStressOnly(1))
                imageData = getROIOverlayed(imageData, app.sxPostStressOnly, app.syPostStressOnly);
            end
            updateimageStressOnly(app, imageData);
        end

        % Button pushed function: SetWindowButtonStressOnly
        function SetWindowButtonStressOnlyPushed(app, event)
            level = str2double(app.SetWindowLevelStressOnly.Value{1});
            width = str2double(app.SetWindowWidthStressOnly.Value{1});
            app.minWindowStressOnly = level - width / 2;
            app.maxWindowStressOnly = level + width / 2;
            imagesc(app.ImageAxesStressOnly, app.imStressOnly, [app.minWindowStressOnly, app.maxWindowStressOnly]);
        end

        % Button pushed function: SetPreLesionButtonStressOnly
        function SetPreLesionButtonStressOnlyPushed(app, event)
            zoom(app.ImageAxesStressOnly, 'off');

            app.paSliceStressOnly = app.currentSliceStressOnly;
            app.paCurrentTimePointStressOnly = app.currentTimePointStressOnly;
            segmentationWindowSize = 25;

            if (strcmp(app.SamplingROIDropDownStressOnly.Value, 'Freehand'))
                app.ptsAStressOnly = drawfreehand(app.ImageAxesStressOnly);
                app.ptsAStressOnly.Position = round(app.ptsAStressOnly.Position);
                app.paStressOnly = [app.currentSliceStressOnly, app.currentTimePointStressOnly, round(app.ptsAStressOnly.Position(1,:)), round(app.ptsAStressOnly.Position(2,:))];
                % FreeHand Writing Case:
                % The order of getting contour is flipped in this case, as
                % we first need to get contour and then calculate the
                % sample.
                [imageWithContour, radiusIncm, areaOfContourInCmSq, app.sxPreStressOnly, app.syPreStressOnly] = getContour(app.ptsAStressOnly.Position(:,2),app.ptsAStressOnly.Position(:,1),segmentationWindowSize,app.currentSliceStressOnly, app.paCurrentTimePointStressOnly, app.fourDImageSetStressOnly, app.dicomInfoStressOnly.PixelSpacing);
                [app.paCurveStressOnly, app.interpolatedSampledPointsPaStressOnly, app.interpolatedTimePointsStressOnly, app.sxPreStressOnly, app.syPreStressOnly, app.rxPreStressOnly, app.ryPreStressOnly] = getBestSample(app.sxPreStressOnly, app.syPreStressOnly,app.searchROIMStressOnly,app.roiMStressOnly,app.roiNStressOnly,app.currentSliceStressOnly,app.fourDImageSetStressOnly,app.paTimePointsStressOnly);
            else
                app.ptsAStressOnly = drawpoint(app.ImageAxesStressOnly);
                app.paStressOnly = [app.currentSliceStressOnly, app.currentTimePointStressOnly, round(app.ptsAStressOnly.Position(2)), round(app.ptsAStressOnly.Position(1))];
                app.fittedCurvePaStressOnly = zeros(size(app.timePointsStressOnly));
                [app.paCurveStressOnly, app.interpolatedSampledPointsPaStressOnly, app.interpolatedTimePointsStressOnly, app.sxPreStressOnly, app.syPreStressOnly, app.rxPreStressOnly, app.ryPreStressOnly] = getBestSample(app.paStressOnly(3),app.paStressOnly(4),app.searchROIMStressOnly,app.roiMStressOnly,app.roiNStressOnly,app.currentSliceStressOnly,app.fourDImageSetStressOnly,app.paTimePointsStressOnly);
                [imageWithContour, radiusIncm, areaOfContourInCmSq] = getContour(app.paStressOnly(3),app.paStressOnly(4),segmentationWindowSize,app.currentSliceStressOnly, app.paCurrentTimePointStressOnly, app.fourDImageSetStressOnly, app.dicomInfoStressOnly.PixelSpacing);
            end

            app.preRoiObjectStressOnly = getROI(app.dicomInfoStressOnly.PatientName.FamilyName, size(app.fourDImageSetStressOnly,2), size(app.fourDImageSetStressOnly,1), app.paStressOnly(3), app.paStressOnly(4), app.paStressOnly(1), app.paStressOnly(2), app.paCurveStressOnly, app.paTimePointsStressOnly, app.fittedCurvePaStressOnly, app.fittedTimePaStressOnly, app.sxPreStressOnly, app.syPreStressOnly, 0, 0, app.numberOfStenosis, 0, 0, 0, 0, 0);
            app.roiObjectStressOnly.preRoiObject = app.preRoiObjectStressOnly;
            saveRoiAsJson(app.roiObjectStressOnly);


            imageData(1:512, 1:512) = app.fourDImageSetStressOnly(app.currentSliceStressOnly,app.currentTimePointStressOnly,1:512,1:512);
            imageWithContour = getROIOverlayed(imageData, app.sxPreStressOnly, app.syPreStressOnly);
            updateimageStressOnly(app,imageWithContour);
            radiusIncm
            areaOfContourInCmSq
            drawPreLesionCurveStressOnly(app);
        end

        % Button pushed function: SetPostLesionStressOnly
        function SetPostLesionStressOnlyButtonPushed(app, event)
            zoom(app.ImageAxesStressOnly, 'off');

            app.pdSliceStressOnly = app.currentSliceStressOnly;
            app.pdCurrentTimePointStressOnly = app.currentTimePointStressOnly;
            segmentationWindowSize = 25;

            if (strcmp(app.SamplingROIDropDownStressOnly.Value, 'Freehand'))
                app.ptsBStressOnly = drawfreehand(app.ImageAxesStressOnly);
                app.ptsBStressOnly.Position = round(app.ptsBStressOnly.Position);
                app.pdStressOnly = [app.currentSliceStressOnly, app.currentTimePointStressOnly, round(app.ptsBStressOnly.Position(1,:)), round(app.ptsBStressOnly.Position(2,:))];
                % FreeHand Writing Case:
                % The order of getting contour is flipped in this case, as
                % we first need to get contour and then calculate the
                % sample.
                [imageWithContour, radiusIncm, areaOfContourInCmSq, app.sxPostStressOnly, app.syPostStressOnly] = getContour(app.ptsBStressOnly.Position(:,2),app.ptsBStressOnly.Position(:,1),segmentationWindowSize,app.currentSliceStressOnly, app.pdCurrentTimePointStressOnly, app.fourDImageSetStressOnly, app.dicomInfoStressOnly.PixelSpacing);
                [app.pdCurveStressOnly, app.interpolatedSampledPointsPdStressOnly, app.interpolatedTimePointsStressOnly, app.sxPostStressOnly, app.syPostStressOnly, app.rxPostStressOnly, app.ryPostStressOnly] = getBestSample(app.sxPostStressOnly, app.syPostStressOnly, app.searchROIMStressOnly,app.roiMStressOnly,app.roiNStressOnly,app.currentSliceStressOnly,app.fourDImageSetStressOnly,app.pdTimePointsStressOnly);
            else
                app.ptsBStressOnly = drawpoint(app.ImageAxesStressOnly);
                app.pdStressOnly = [app.currentSliceStressOnly, app.currentTimePointStressOnly, round(app.ptsBStressOnly.Position(2)), round(app.ptsBStressOnly.Position(1))];
                app.fittedCurvePdStressOnly = zeros(size(app.timePointsStressOnly));
                [app.pdCurveStressOnly, app.interpolatedSampledPointsPdStressOnly, app.interpolatedTimePointsStressOnly, app.sxPostStressOnly, app.syPostStressOnly, app.rxPostStressOnly, app.ryPostStressOnly] = getBestSample(app.pdStressOnly(3),app.pdStressOnly(4),app.searchROIMStressOnly,app.roiMStressOnly,app.roiNStressOnly,app.currentSliceStressOnly,app.fourDImageSetStressOnly,app.pdTimePointsStressOnly);
                [imageWithContour, radiusIncm, areaOfContourInCmSq] = getContour(app.pdStressOnly(3),app.pdStressOnly(4),segmentationWindowSize,app.currentSliceStressOnly, app.pdCurrentTimePointStressOnly, app.fourDImageSetStressOnly, app.dicomInfoStressOnly.PixelSpacing);
            end

            app.postRoiObjectStressOnly = getROI(app.dicomInfoStressOnly.PatientName.FamilyName, size(app.fourDImageSetStressOnly,2), size(app.fourDImageSetStressOnly,1), app.pdStressOnly(3), app.pdStressOnly(4), app.pdStressOnly(1), app.pdStressOnly(2), app.pdCurveStressOnly, app.pdTimePointsStressOnly, app.fittedCurvePdStressOnly, app.fittedTimePdStressOnly, app.sxPostStressOnly, app.syPostStressOnly, 0, 0, app.numberOfStenosis, 0, 0, 0, 0, 0);
            app.roiObjectStressOnly.postRoiObject = app.postRoiObjectStressOnly;
            saveRoiAsJson(app.roiObjectStressOnly);

            imageData(1:512, 1:512) = app.fourDImageSetStressOnly(app.currentSliceStressOnly,app.currentTimePointStressOnly,1:512,1:512);
            imageWithContour = getROIOverlayed(imageData, app.sxPostStressOnly, app.syPostStressOnly);
            updateimageStressOnly(app,imageWithContour);
            radiusIncm
            areaOfContourInCmSq
            drawPostLesionCurveStressOnly(app);

        end

        % Value changed function: veHeightCheckBoxStressOnly
        function veHeightCheckBoxStressOnlyValueChanged(app, event)
            value = app.veHeightCheckBoxStressOnly.Value;
            if (value == 1)
                app.hAhBDiffNegativeStressOnly = false;
            end
            if (value == 0)
                app.hAhBDiffNegativeStressOnly = true;
            end
        end

        % Value changed function: SamplingROIDropDownStressOnly
        function SamplingROIDropDownStressOnlyValueChanged(app, event)
            value = app.SamplingROIDropDownStressOnly.Value;
            if (value(2) == 'x')
                app.roiMStressOnly = str2double(value(1));
                app.roiNStressOnly = str2double(value(3));
            elseif (value(3) == 'x')
                app.roiMStressOnly = str2double(value(1:2));
                app.roiNStressOnly = str2double(value(4:5));
            end
        end

        % Value changed function: SearchROIDropDownStressOnly
        function SearchROIDropDownStressOnlyValueChanged(app, event)
            value = app.SearchROIDropDownStressOnly.Value;
            if (value(2) == 'x')
                app.searchROIMStressOnly = str2double(value(1));
                app.searchROINStressOnly = str2double(value(3));
            elseif (value(3) == 'x')
                app.searchROIMStressOnly = str2double(value(1:2));
                app.searchROINStressOnly = str2double(value(4:5));
            end
        end

        % Value changed function: 
        % InterpolateCurrentSliceWithDropDownStressOnly
        function InterpolateCurrentSliceWithDropDownStressOnlyValueChanged(app, event)
            value = convertCharsToStrings(app.InterpolateCurrentSliceWithDropDownStressOnly.Value);
            if (strcmp(value,'Previous Slice'))
                if (app.currentSliceStressOnly > 1)
                    app.sliceToBeInterpolatedWithStressOnly = app.currentSliceStressOnly - 1;
                    interpolatedSliceForAllTimePoints = getInterpolatedSlice(app.currentSliceStressOnly, app.sliceToBeInterpolatedWithStressOnly, app.fourDImageSetStressOnly);
                else
                    errordlg('Current Slice Cannot Have Previous Slice','Slice Choose Error');
                end
            elseif (strcmp(value,'Next Slice'))
                if (app.currentSliceStressOnly < size(app.fourDImageSetStressOnly,1))
                    app.sliceToBeInterpolatedWithStressOnly = app.currentSliceStressOnly + 1;
                    interpolatedSliceForAllTimePoints = getInterpolatedSlice(app.currentSliceStressOnly, app.sliceToBeInterpolatedWithStressOnly, app.fourDImageSetStressOnly);
                else
                    errordlg('Current Slice Cannot Have Next Slice','Slice Choose Error');
                end
            elseif ((strcmp(value,'None')))
                % Do nothing
            end

            tempFourDImageSet = app.fourDImageSetStressOnly;
            tempFourDImageSet(app.currentSliceStressOnly,:,:,:) = interpolatedSliceForAllTimePoints;
            if (app.currentSliceStressOnly == app.paStressOnly(1))
                % copy pre slice's coordinate
                [app.paCurveStressOnly, app.interpolatedSampledPointsPaStressOnly, app.interpolatedTimePointsStressOnly, app.sxPreStressOnly, app.syPreStressOnly, app.rxPreStressOnly, app.ryPreStressOnly] = getBestSample(app.paStressOnly(3),app.paStressOnly(4),app.searchROIMStressOnly,app.roiMStressOnly,app.roiNStressOnly,app.currentSliceStressOnly,tempFourDImageSet,app.timePointsStressOnly);
                drawPreLesionCurveStressOnly(app);
            elseif (app.currentSliceStressOnly == app.pdStressOnly(1))
                % copy post slice's coordinate
                [app.pdCurveStressOnly, app.interpolatedSampledPointsPdStressOnly, app.interpolatedTimePointsStressOnly, app.sxPostStressOnly, app.syPostStressOnly, app.rxPostStressOnly, app.ryPostStressOnly] = getBestSample(app.pdStressOnly(3),app.pdStressOnly(4),app.searchROIMStressOnly,app.roiMStressOnly,app.roiNStressOnly,app.currentSliceStressOnly,tempFourDImageSet,app.timePointsStressOnly);
                drawPostLesionCurveStressOnly(app);
            end
        end

        % Button pushed function: ClearInputsButtonStressOnly
        function ClearInputsButtonStressOnlyPushed(app, event)
            % Clear all fields
            app.ContrastVolumemLEditFieldStressOnly.Value = '';
            app.ContrastConcentrationmglmLEditFieldStressOnly.Value = '';
            app.PrelesionLumenRadiuscmEditFieldStressOnly.Value = '';
            app.PostlesionLumenRadiuscmEditFieldStressOnly.Value = '';
            app.SystolicBloodPressuremmHgEditFieldStressOnly.Value = '';
            app.MarkStenosisCheckBox.Value = false;
            app.MarkBreakerCheckBox.Value = false;
            app.XrayTubeVoltagekVDropDown.Value = app.xRayTubeVoltages(1);
            app.RestorStressConditionDropDown.Value = 'Rest';
            app.CoronaryArteryDropDown.Value = app.arterySelections(1);
            app.CoronaryDominanceDropDown.Value = app.dominanceTypes(1);
        end

        % Button pushed function: OutputButtonStressOnly
        function OutputButtonStressOnlyPushed(app, event)
            % Get conversion factor based on scanner type
            conversionFactor = getConversionFactor(app);

            % Get preLesion TracerMass based on dominance and coronary
            % artery type
            app.mTotal = str2double(app.ContrastVolumemLEditFieldStressOnly.Value) * str2double(app.ContrastConcentrationmglmLEditFieldStressOnly.Value);
            tracerMass = getTracerMass(app);
            app.preQStressOnly = tracerMass(app.arterySelectedIndex);

            % Converting HUs to (mg/mL)s
            tempAucA = app.aucAStressOnly / conversionFactor;
            tempAucB = app.aucBStressOnly / conversionFactor;

            % Get tracer mass at every branch, if there is any.
            % If there is none, postQ is same as preQ.
            % getTracerMassAtEverySideBranch checks if there is any branch
            % defined and calculates tracer loss at each branch.
            [app.tracerMassAtBranches, app.tracerMassAtTrunkAfterEachSideBranch] = getTracerMassAtEverySideBranch(app);
            app.postQStressOnly = app.tracerMassAtTrunkAfterEachSideBranch(end);

            % Check if there is stenosis defined and if so, then
            % check if there is branches involved in stenoses.
            % If there are branches, entryQ and exitQ should be
            % correctly populated.
            if (app.numberOfStenosis > 0)
                for s = 1 : app.maxStenosisSupported
                    if (app.checkedStenosis(s) == true)
                        numBranchesBefore = app.allStenosisData(s).NumberofbranchbetweenprelesionandstenosisEditField.Value;
                        numBranchesAfter = app.allStenosisData(s).EditField.Value;
                        if (numBranchesBefore > 0)
                            app.entryQ(s) = app.tracerMassAtTrunkAfterEachSideBranch(numBranchesBefore);
                        else
                            app.entryQ(s) = app.preQStressOnly(s);
                        end
                        if (numBranchesAfter > 0)
                            app.exitQ(s) = app.tracerMassAtTrunkAfterEachSideBranch(numBranchesAfter);
                        else
                            app.exitQ(s) = app.postQStressOnly(s);
                        end
                        tempaucAEntry(s) = app.aucAEntryStressOnly(s) / conversionFactor;
                        tempaucBExit(s) = app.aucBExitStressOnly(s) / conversionFactor;
                    else
                        app.entryQ(s) = 0;
                        app.exitQ(s) = 0;
                        tempaucAEntry(s) = 0;
                        tempaucBExit(s) = 0;
                    end
                end
            end

            if (~isempty(app.hBTextStressOnly))
                app.hBStressOnly = app.hBTextStressOnly;
            else
                app.hBStressOnly = getRelativeHeight(app.paStressOnly(1), app.pdStressOnly(1), app.dicomInfoStressOnly.SliceThickness, app.hAhBDiffNegativeStressOnly);
            end
            if (~isempty(app.LTextStressOnly))
                app.LStressOnly = app.LTextStressOnly;
            else
                app.LStressOnly = getDistanceBetweenSlicesAB(app.paStressOnly(3), app.paStressOnly(4), app.pdStressOnly(3), app.pdStressOnly(4), app.allExtraPointsForDistanceInStressOnly, app.hBStressOnly, app.dicomInfoStressOnly.PixelSpacing);
            end

            logDAI('Calling calculateFFR()');
            % Radius values are in cm
            if (app.numberOfStenosis >= 1)
                tempaucAEntry = tempaucAEntry(tempaucAEntry ~= 0);
                tempaucBExit = tempaucBExit(tempaucBExit ~= 0);
                temprs1 = app.rs1(app.checkedStenosis);
                temprs2 = app.rs2(app.checkedStenosis);
                temprs3 = app.rs3(app.checkedStenosis);
                tempentryQ = app.entryQ(app.entryQ ~= 0);
                tempexitQ = app.exitQ(app.exitQ ~= 0);
                [app.FFRStressOnly, app.VAStressOnly, app.VBStressOnly, app.shearStressAStressOnly, app.shearStressBStressOnly, app.pLEStressOnly, app.pLFStresOnly, app.ReStressOnly, app.pBStressOnly, app.frictionFactorStressOnly, app.Vs1StressOnly, app.Vs2StressOnly, app.Vs3StressOnly, app.pLCStressOnly, app.pLSStressOnly, app.FAStressOnly, app.FBStressOnly] = calculateFFR(tempAucA, tempAucB, app.preQStressOnly, app.postQStressOnly, app.hBStressOnly, app.LStressOnly, str2double(app.PrelesionLumenRadiuscmEditFieldStressOnly.Value), str2double(app.PostlesionLumenRadiuscmEditFieldStressOnly.Value), str2double(app.SystolicBloodPressuremmHgEditFieldStressOnly.Value), 0, app.fMethodStressOnly, 1, tempaucAEntry, tempaucBExit, temprs1, temprs2, temprs3, tempentryQ, tempexitQ, app.numberOfStenosis);
            else
                if (app.MarkStenosisCheckBox.Value == 1)
                    isStenosis = 1;
                else
                    isStenosis = 0;
                end
                [app.FFRStressOnly, app.VAStressOnly, app.VBStressOnly, app.shearStressAStressOnly, app.shearStressBStressOnly, app.pLEStressOnly, app.pLFStresOnly, app.ReStressOnly, app.pBStressOnly, app.frictionFactorStressOnly, app.Vs1StressOnly, app.Vs2StressOnly, app.Vs3StressOnly, app.pLCStressOnly, app.pLSStressOnly, app.FAStressOnly, app.FBStressOnly] = calculateFFR(tempAucA, tempAucB, app.preQStressOnly, app.postQStressOnly, app.hBStressOnly, app.LStressOnly, str2double(app.PrelesionLumenRadiuscmEditFieldStressOnly.Value), str2double(app.PostlesionLumenRadiuscmEditFieldStressOnly.Value), str2double(app.SystolicBloodPressuremmHgEditFieldStressOnly.Value), 0, app.fMethodStressOnly, isStenosis, 0, 0, app.rs1, app.rs2, app.rs3, app.entryQ, app.exitQ, app.numberOfStenosis);
            end

            logDAI('FFR Calculation Successful');
            logDAI('Populating output parameters');

            % Displaying output values
            app.FFREditFieldStressOnly.Value = sprintf('%.4f',app.FFRStressOnly);
            app.PrelesionFlowVelocitycmsEditFieldStressOnly.Value = sprintf('%.4f',app.VAStressOnly);
            app.PostlesionFlowVelocitycmsEditFieldStressOnly.Value = sprintf('%.4f',app.VBStressOnly);
            app.PrelesionShearStressPaEditFieldStressOnly.Value = sprintf('%.4f',app.shearStressAStressOnly);
            app.PostlesionShearStressPaEditFieldStressOnly.Value = sprintf('%.4f',app.shearStressBStressOnly);

            logDAI('Populating output parameters Successful');

            % Adding result to csvWriteMatrix
            logDAI('Adding result to csvWriteMatrix');

            % Currently we are limited to writing only one value in the csv
            % if there is multiple values
            if (max(size(app.pLEStressOnly)) > 1)
                for i = 1:max(size(app.pLEStressOnly))
                    if (i == 1)
                        stringForAllData = sprintf('%s,%s,%d,%d,(%d %d),(%d %d),%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%d,%d,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f\n', datestr(now,'mm-dd-yyyy HH-MM-SS'),'StressOnly',app.paStressOnly(1),app.pdStressOnly(1),app.paStressOnly(3),app.paStressOnly(4),app.pdStressOnly(3),app.pdStressOnly(4),app.FFRStressOnly,app.FAStressOnly,app.FBStressOnly,app.VAStressOnly,app.VBStressOnly,app.shearStressAStressOnly,app.shearStressBStressOnly,app.aucAStressOnly,app.aucBStressOnly,app.alphaAStressOnly,app.betaAStressOnly,app.kAStressOnly,app.alphaBStressOnly,app.betaBStressOnly,app.kBStressOnly,0,0,app.pLEStressOnly(1),app.pLFStresOnly,app.ReStressOnly,app.pBStressOnly,app.frictionFactorStressOnly,app.Vs1StressOnly(i),app.Vs2StressOnly(i),app.Vs3StressOnly(i),app.pLCStressOnly(i),app.pLSStressOnly(i));
                    else
                        stringForAllData = sprintf('%s,%s,%d,%d,%d %d,%d %d,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%d,%d,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f\n', '','','','','','','','','','','','','','','','','','','','','','','','','',app.pLEStressOnly(i),'','','','',app.Vs1StressOnly(i),app.Vs2StressOnly(i),app.Vs3StressOnly(i),app.pLCStressOnly(i),app.pLSStressOnly(i));
                    end
                    app.allResultsForCSVWrite = append(app.allResultsForCSVWrite, newline, stringForAllData);
                end
            else
                stringForAllData = sprintf('%s,%s,%d,%d,(%d %d),(%d %d),%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%d,%d,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f,%.4f\n', datestr(now,'mm-dd-yyyy HH-MM-SS'),'StressOnly',app.paStressOnly(1),app.pdStressOnly(1),app.paStressOnly(3),app.paStressOnly(4),app.pdStressOnly(3),app.pdStressOnly(4),app.FFRStressOnly,app.FAStressOnly,app.FBStressOnly,app.VAStressOnly,app.VBStressOnly,app.shearStressAStressOnly,app.shearStressBStressOnly,app.aucAStressOnly,app.aucBStressOnly,app.alphaAStressOnly,app.betaAStressOnly,app.kAStressOnly,app.alphaBStressOnly,app.betaBStressOnly,app.kBStressOnly,0,0,app.pLEStressOnly,app.pLFStresOnly,app.ReStressOnly,app.pBStressOnly,app.frictionFactorStressOnly,app.Vs1StressOnly,app.Vs2StressOnly,app.Vs3StressOnly,app.pLCStressOnly, app.pLSStressOnly);
                app.allResultsForCSVWrite = append(app.allResultsForCSVWrite, newline, stringForAllData);
            end

            stringForCoordinates = sprintf('%d,%d,%d,%d\n',app.paStressOnly(3),app.paStressOnly(4),app.paStressOnly(1),app.paStressOnly(2));
            app.coOrdinatesForCSVWriteStressOnly = append(app.coOrdinatesForCSVWriteStressOnly,newline,stringForCoordinates);
            stringForCoordinates = sprintf('%d,%d,%d,%d\n',app.pdStressOnly(3),app.pdStressOnly(4),app.pdStressOnly(1),app.pdStressOnly(2));
            app.coOrdinatesForCSVWriteStressOnly = append(app.coOrdinatesForCSVWriteStressOnly,newline,stringForCoordinates);
            logDAI('Adding result to csvWriteMatrix Successful');

            logDAI('Saving coordinates');
            saveCoordiantes(app);

            % Plot for Slice Location vs FFR
            logDAI('Generating data for FFRvsSliceLocation Plot');
            idx = find(app.allFFRStressOnlySliceLocations == app.pdStressOnly(1));
            if (isempty(idx))
                % A dummy value of 1.0 is added for FFR plot (as per
                % Aaron's request to keep the data same length)
                app.allFFRStressOnly(end+1) = 1.0;
                app.allFFRStressOnly(end+1) = app.FFRStressOnly;
                app.allPreFlowVelocity(end+1) = app.VAStressOnly;
                app.allPostFlowVelocity(end+1) = app.VBStressOnly;
                app.allFFRStressOnlySliceLocations(end+1) = app.paStressOnly(1);
                app.allFFRStressOnlySliceLocations(end+1) = app.pdStressOnly(1);
            else
                app.allFFRStressOnly(idx) = app.FFRStressOnly;
                if (idx > max(size(app.allPostFlowVelocity)))
                    app.allPreFlowVelocity(idx-1) = app.VAStressOnly;
                    app.allPostFlowVelocity(idx-1) = app.VBStressOnly;
                else
                    app.allPreFlowVelocity(idx) = app.VAStressOnly;
                    app.allPostFlowVelocity(idx) = app.VBStressOnly;
                end
            end

            app.allFlowVelocitiesStressOnly = [app.allPreFlowVelocity, app.allPostFlowVelocity];
            tempData = [app.allFFRStressOnlySliceLocations.', app.allFFRStressOnly.', app.allFlowVelocitiesStressOnly.'];
            sortedData = sortrows(tempData, 1);
            app.allFFRStressOnlySliceLocations = sortedData(:, 1)';
            app.allFFRStressOnly = sortedData(:, 2)';
            app.allFlowVelocitiesStressOnly = sortedData(:, 3)';



            if (isfield(app.allDicomInfoStressOnly, 'SliceLocation'))
                app.allFFRStressOnlyDicomSliceNumbers(end+1) = app.allDicomInfoStressOnly{app.currentSliceStressOnly}.SliceLocation;
            else
                app.allFFRStressOnlyDicomSliceNumbers(end+1) = app.pdStressOnly(1);
            end
            logDAI('Data Appeneded for FFRvsSliceLocation Plot');
            logDAI('Generating Plot');
            logDAI('Setting YLim between 0 and 1.2');
            app.FFRVsSliceLocation.YLim = [0, 1.2];

            drawFFRCurve(app);
            logDAI('Plot Generation Successful');
        end

        % Button pushed function: ClearOutputsButtonStressOnly
        function ClearOutputsButtonStressOnlyPushed(app, event)
            % Stress Output Clear:
            app.PostlesionShearStressPaEditFieldStressOnly.Value = '';
            app.PrelesionShearStressPaEditFieldStressOnly.Value = '';
            app.PostlesionFlowVelocitycmsEditFieldStressOnly.Value = '';
            app.PrelesionFlowVelocitycmsEditFieldStressOnly.Value = '';
            app.FFREditFieldStressOnly.Value = '';
        end

        % Callback function
        function ClearAllButtonStressOnlyPushed(app, event)
            ClearInputsButtonStressOnlyPushed(app, event);
            ClearOutputsButtonStressOnlyPushed(app, event);
        end

        % Callback function
        function LoadPreLesionCurveButtonStressOnlyPushed(app, event)
            filterspec = {'*.txt','Text Files';'*.xlsx','Excel Files'};
            [f, p] = uigetfile(filterspec);
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);
            set(gcf, 'Pointer','arrow');

            logDAI('Checking chosen file type:');
            [~, name, ext] = fileparts(f);

            if (strcmp(ext,'.xlsx'))
                logDAI('File type is excel, reading excel file.');
                fName = strcat(p, f);
                data = readtable(fName);
                time = data.TimePoints;
                roi = data.PreLesionCurve;
            end

            if (strcmp(ext,'.txt'))
                logDAI('File type is txt, reading txt file.');
                % Read text files:
                fileName = strcat(p,f);
                [time, roi] = readDataFile(fileName);
                if time(2) >= 500
                    time = time / 1000;
                end
            end


            % Make sure user didn't cancel uigetfile dialog
            if (ischar(p))
                logDAI('Plotting the curve');
                app.paCurveStressOnly = roi;
                app.plotXPreStressOnly = time;
                app.paPlotAreaStressOnly.YLim = [app.yAxisLimitMin app.yAxisLimitMax];
                app.paPlotAreaStressOnly.YTick = getSliderTicks(app.yAxisLimitMin, app.yAxisLimitMax, app.maxYAxisInterval);
                app.paPlotAreaStressOnly.XLim = [1 max(time)];
                app.paPlotAreaStressOnly.XTick = [1:max(time)/10:max(time)];
                app.paPlotAreaStressOnly.XTick = cast(app.paPlotAreaStressOnly.XTick, 'int16');
                plot(app.paPlotAreaStressOnly, app.plotXPreStressOnly, app.paCurveStressOnly, 'mo');
                app.preTextReadStressOnly = true;
                logDAI('Plotting the curve is successful');
            end

            if (app.preTextReadStressOnly == true && app.postTextReadStressOnly == true)
                app.RelativeHeightcmEditFieldStressOnly.Enable = true;
                app.PrePostDistancecmEditFieldStressOnly.Enable = true;
            end
        end

        % Callback function
        function LoadPostLesionCurveButtonStressOnlyPushed(app, event)
            filterspec = {'*.txt','Text Files';'*.xlsx','Excel Files'};
            [f, p] = uigetfile(filterspec);
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);
            set(gcf, 'Pointer','arrow');

            logDAI('Checking chosen file type:');
            [~, name, ext] = fileparts(f);

            if (strcmp(ext,'.xlsx'))
                logDAI('File type is excel, reading excel file.');
                fName = strcat(p, f);
                data = readtable(fName);
                time = data.TimePoints;
                roi = data.PreLesionCurve;
            end

            if (strcmp(ext,'.txt'))
                logDAI('File type is txt, reading txt file.');
                % Read text files:
                fileName = strcat(p,f);
                [time, roi] = readDataFile(fileName);
                if time(2) >= 500
                    time = time / 1000;
                end
            end

            % Make sure user didn't cancel uigetfile dialog
            if (ischar(p))
                logDAI('Plotting the curve');
                app.pdCurveStressOnly = roi;
                app.plotXPostStressOnly = time;
                app.pdPlotAreaStressOnly.YLim = [app.yAxisLimitMin app.yAxisLimitMax];
                app.pdPlotAreaStressOnly.YTick = getSliderTicks(app.yAxisLimitMin, app.yAxisLimitMax, app.maxYAxisInterval);
                app.pdPlotAreaStressOnly.XLim = [1 max(time)];
                app.pdPlotAreaStressOnly.XTick = [1:max(time)/10:max(time)];
                app.pdPlotAreaStressOnly.XTick = cast(app.pdPlotAreaStressOnly.XTick, 'int16');
                plot(app.pdPlotAreaStressOnly, app.plotXPostStressOnly, app.pdCurveStressOnly, 'mo');
                app.postTextReadStressOnly = true;
                logDAI('Plotting the curve is successful');
            end

            if (app.preTextReadStressOnly == true && app.postTextReadStressOnly == true)
                app.RelativeHeightcmEditFieldStressOnly.Enable = true;
                app.PrePostDistancecmEditFieldStressOnly.Enable = true;
            end
        end

        % Callback function
        function RelativeHeightcmEditFieldStressOnlyValueChanged(app, event)
            app.hBTextStressOnly = str2double(app.RelativeHeightcmEditFieldStressOnly.Value);
        end

        % Callback function
        function PrePostDistancecmEditFieldStressOnlyValueChanged(app, event)
            app.LTextStressOnly = str2double(app.PrePostDistancecmEditFieldStressOnly.Value);
        end

        % Callback function
        function ScreenCaptureButtonStressOnlyPushed(app, event)

        end

        % Callback function
        function ManualBaselineWashoutstressCheckBoxStressOnlyValueChanged(app, event)
            app.manualBaselineCheckStressOnly = app.ManualBaselineWashoutstressCheckBoxStressOnly.Value;
            if (app.manualBaselineCheckStressOnly == 1)
                app.ManualBaselineInputStressOnly.Enable = true;
                app.ManualWashoutInputStressOnly.Enable = true;
                app.PreLesionCheckBoxStressOnly.Enable = true;
                app.PostLesionCheckBoxStressOnly.Enable = true;
            end
            if (app.manualBaselineCheckStressOnly == 0)
                app.ManualBaselineInputStressOnly.Enable = false;
                app.ManualBaselineInputStressOnly.Value = '';
                app.ManualWashoutInputStressOnly.Enable = false;
                app.ManualWashoutInputStressOnly.Value = '';
                app.PreLesionCheckBoxStressOnly.Enable = false;
                app.PostLesionCheckBoxStressOnly.Enable = false;
            end
        end

        % Button pushed function: FitCurvesButtonStressOnly
        function FitCurvesButtonStressOnlyPushed(app, event)
            choice = questdlg('Which curve to fit?', 'Curve Fitting', 'Pre-lesion curve','Lesion entry curve','');
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);
            switch choice
                case 'Pre-lesion curve'
                    if isrow(app.paCurveStressOnly)
                        app.paCurveStressOnly = app.paCurveStressOnly';
                    end

                    if isnan(str2double(app.ManualBaselineInputStressOnly.Value))
                        manualBaselineValuePreLesion = 0;
                    else
                        manualBaselineValuePreLesion = str2double(app.ManualBaselineInputStressOnly.Value);
                    end
                    if isnan(str2double(app.ManualWashoutInputStressOnly.Value))
                        manualWashoutValuePreLesion = 0;
                    else
                        manualWashoutValuePreLesion = str2double(app.ManualWashoutInputStressOnly.Value);
                    end

                    try
                        [app.fittedCurvePaStressOnly, app.fittedTimePaStressOnly, app.paCurveStressOnly, app.rmseAStressOnly, app.kAStressOnly, app.alphaAStressOnly, app.betaAStressOnly] = getFittedCurve(app.paCurveStressOnly, app.plotXPreStressOnly, manualBaselineValuePreLesion, manualWashoutValuePreLesion);
                        app.aucAStressOnly = getAreaUnderCurve(app.fittedCurvePaStressOnly, app.fittedTimePaStressOnly);

                        drawPreLesionCurveStressOnly(app);

                        app.paStressOnly = [app.roiObjectStressOnly.preRoiObject.curveData.z, app.roiObjectStressOnly.preRoiObject.curveData.t, app.roiObjectStressOnly.preRoiObject.curveData.x, app.roiObjectStressOnly.preRoiObject.curveData.y];
                        app.preRoiObjectStressOnly = getROI(app.dicomInfoStressOnly.PatientName.FamilyName, size(app.fourDImageSetStressOnly,2), size(app.fourDImageSetStressOnly,1), app.paStressOnly(3), app.paStressOnly(4), app.paStressOnly(1), app.paStressOnly(2), app.paCurveStressOnly, app.paTimePointsStressOnly, app.fittedCurvePaStressOnly, app.fittedTimePaStressOnly, app.sxPreStressOnly, app.syPreStressOnly, app.aucAStressOnly, app.allExtraPointsForDistanceInStressOnly, app.numberOfStenosis, 0, 0, 0, 0, 0);
                        app.roiObjectStressOnly.preRoiObject = app.preRoiObjectStressOnly;
                        saveRoiAsJson(app.roiObjectStressOnly);

                    catch ME
                        msg = strcat('Problem in Curve Fitting:', ME.message);
                        errordlg(msg);
                        pause(5);
                        set(gcf, 'Pointer','arrow');
                    end


                case 'Lesion entry curve'
                    if isrow(app.entryCurveStressOnly)
                        app.entryCurveStressOnly = app.entryCurveStressOnly';
                    end

                    if isnan(str2double(app.ManualBaselineInputStressOnly.Value))
                        manualBaselineValuePreLesion = 0;
                    else
                        manualBaselineValuePreLesion = str2double(app.ManualBaselineInputStressOnly.Value);
                    end
                    if isnan(str2double(app.ManualWashoutInputStressOnly.Value))
                        manualWashoutValuePreLesion = 0;
                    else
                        manualWashoutValuePreLesion = str2double(app.ManualWashoutInputStressOnly.Value);
                    end

                    try
                        [app.fittedCurveEntryStressOnly, app.fittedTimeEntryStressOnly, app.entryCurveStressOnly, app.rmseAStressOnly, app.kAStressOnly, app.alphaAStressOnly, app.betaAStressOnly] = getFittedCurve(app.entryCurveStressOnly, app.plotXEntryStressOnly, manualBaselineValuePreLesion, manualWashoutValuePreLesion);
                        app.aucAEntryStressOnly(app.currentStenosisID) = getAreaUnderCurve(app.fittedCurveEntryStressOnly, app.fittedTimeEntryStressOnly);
                        %                         if (isempty(app.ConversionFactorEditFieldStressOnly.Value) == false)
                        %                             app.aucAEntryStressOnly(end) = app.aucAEntryStressOnly(end) / str2double(app.ConversionFactorEditFieldStressOnly.Value);
                        %                         end

                        drawEntryCurveStressOnly(app);

                        if (app.currentStenosisNumber == -1)
                            app.pEntryStressOnly = [app.roiObjectStressOnly.entryRoiObject.curveData.z, app.roiObjectStressOnly.entryRoiObject.curveData.t, app.roiObjectStressOnly.entryRoiObject.curveData.x, app.roiObjectStressOnly.entryRoiObject.curveData.y];
                            app.entryRoiObjectStressOnly = getROI(app.dicomInfoStressOnly.PatientName.FamilyName, size(app.fourDImageSetStressOnly,2), size(app.fourDImageSetStressOnly,1), app.pEntryStressOnly(3), app.pEntryStressOnly(4), app.pEntryStressOnly(1), app.pEntryStressOnly(2), app.entryCurveStressOnly, app.entryTimePointStressOnly, app.fittedCurveEntryStressOnly, app.fittedTimeEntryStressOnly, app.entrySxStressOnly, app.entrySyStressOnly, app.aucAEntryStressOnly(end), 0, app.numberOfStenosis, app.rs1(end), app.rs2(end), app.rs3(end), app.entryQ(end), app.exitQ(end));
                            app.roiObjectStressOnly.entryRoiObject = app.entryRoiObjectStressOnly;
                        else
                            app.pEntryStressOnly = [app.roiObjectStressOnly.entryRoiObject(app.currentStenosisNumber).curveData.z, app.roiObjectStressOnly.entryRoiObject(app.currentStenosisNumber).curveData.t, app.roiObjectStressOnly.entryRoiObject(app.currentStenosisNumber).curveData.x, app.roiObjectStressOnly.entryRoiObject(app.currentStenosisNumber).curveData.y];
                            app.entryRoiObjectStressOnly = getROI(app.dicomInfoStressOnly.PatientName.FamilyName, size(app.fourDImageSetStressOnly,2), size(app.fourDImageSetStressOnly,1), app.pEntryStressOnly(3), app.pEntryStressOnly(4), app.pEntryStressOnly(1), app.pEntryStressOnly(2), app.entryCurveStressOnly, app.entryTimePointStressOnly, app.fittedCurveEntryStressOnly, app.fittedTimeEntryStressOnly, app.entrySxStressOnly, app.entrySyStressOnly, app.aucAEntryStressOnly(end), 0, app.numberOfStenosis, app.rs1(end), app.rs2(end), app.rs3(end), app.entryQ(end), app.exitQ(end));
                            app.roiObjectStressOnly.entryRoiObject(app.currentStenosisNumber) = app.entryRoiObjectStressOnly;
                            app.currentStenosisNumber = -1;
                        end
                        saveRoiAsJson(app.roiObjectStressOnly);

                    catch ME
                        msg = strcat('Problem in Curve Fitting:', ME.message);
                        errordlg(msg);
                        pause(5);
                        set(gcf, 'Pointer','arrow');
                    end
            end
            set(gcf, 'Pointer','arrow');
        end

        % Callback function
        function SaveLabelledDataButtonPushed(app, event)
            % Get Label Ready:

            logDAI('Converting images to JPEG and putting them into JPEGData Directory');
            convertImagesToJpeg(app.labelImageDirectory, app.threeDVolume, 'JPEGData');
            logDAI('Images are converted to JPEG');
            labeledDataRCA = getLabel(app.ptsRCA, size(app.threeDVolume), 1);
            labeledDataLAD = getLabel(app.ptsLAD, size(app.threeDVolume), 2);
            labeledDataLCx = getLabel(app.ptsLCx, size(app.threeDVolume), 3);
            labeledDataApex = getLabel(app.ptsApex, size(app.threeDVolume), 4);

            labeledData = labeledDataRCA + labeledDataLAD + labeledDataLCx + labeledDataApex;

            newDirectory = convertCharsToStrings(app.labelImageDirectory) + 'LabeledData\';
            logDAI('LabeledData directory is: ');
            logDAI(newDirectory);
            logDAI('LabeledData directory is being created');
            mkdir (newDirectory);
            logDAI('LabeledData directory is successfully created');
            logDAI('Writing labeled data to LabeledData directory');
            for i = 1:size(labeledData, 3)
                currentImage = labeledData(:,:,i);
                fName = newDirectory + num2str(i) + '.jpg';
                imwrite(currentImage, fName);
            end
            logDAI('Writing labeled data to LabeledData directory is successful');
        end

        % Callback function
        function RemovePointCheckBoxValueChanged(app, event)

        end

        % Callback function
        function RemovePointCheckBoxStressOnlyValueChanged(app, event)

        end

        % Value changed function: RemovePointPreCheckBoxStressOnly
        function RemovePointPreCheckBoxStressOnlyValueChanged(app, event)
            value = app.RemovePointPreCheckBoxStressOnly.Value;
            if(value == 1)

                f = msgbox('Select a plot by clicking on it','Plot select', 'modal');
                uiwait(f);

                w = waitforbuttonpress;
                app.SetYaxisMaxMenu.Visible = 'off';
                if (strcmp(app.plotToRemovePoint, 'pre'))

                    if (~isempty(app.fittedCurvePaStressOnly))
                        app.fittedCurvePaStressOnly = [];
                        drawPreLesionCurveStressOnly(app);
                    end

                    pts = getpts(app.paPlotAreaStressOnly);
                    data = app.xDataPreStressOnly;
                    distance = round(data - pts(1));
                    idx = find(distance == 0);
                    dataArray = app.paCurveStressOnly;
                    dataArray(idx) = [];
                    app.paCurveStressOnly = dataArray;
                    timeArray = app.paTimePointsStressOnly;
                    timeArray(idx) = [];
                    app.paTimePointsStressOnly = timeArray;
                    drawPreLesionCurveStressOnly(app);

                elseif (contains(app.plotToRemovePoint, 'entry'))

                    logDAI('Entered point removal for entry curve.');
                    plotID = str2double(app.plotToRemovePoint(end));
                    s = sprintf('plotID Selected = %d', plotID);
                    logDAI(s);
                    temporaryStenosisID = app.currentStenosisID;
                    s = sprintf('temporaryStenosisID and currentStenosisID = %d', temporaryStenosisID);
                    logDAI(s);
                    temporaryStenosisNumber = app.currentStenosisNumber;
                    s = sprintf('temporaryStenosisNumber and currentStenosisNumber = %d', temporaryStenosisNumber);
                    logDAI(s);
                    app.currentStenosisID = plotID;
                    app.currentStenosisNumber = plotID;

                    pts = getpts(app.paPlotAreaStressOnly);

                    s = sprintf('point selected = %d', pts(1));
                    logDAI(s);
                    data = app.roiObjectStressOnly.entryRoiObject(plotID).curveData.timePoints;
                    s = sprintf('data = %d', data);
                    logDAI(s);
                    distance = round(data - pts(1));
                    idx = find(distance == 0);
                    s = sprintf('idx = %d', idx);
                    logDAI(s);

                    app.entryCurveStressOnly = app.roiObjectStressOnly.entryRoiObject(plotID).curveData.curve;
                    app.entryTimePointStressOnly = app.roiObjectStressOnly.entryRoiObject(plotID).curveData.timePoints;

                    dataArray = app.entryCurveStressOnly;
                    s = sprintf('dataArrayBeforeRemovalOfPoint = %d', dataArray);
                    logDAI(s);
                    dataArray(idx) = [];
                    s = sprintf('dataArrayAfterRemovalOfPoint = %d', dataArray);
                    logDAI(s);
                    app.entryCurveStressOnly = dataArray;
                    timeArray = app.entryTimePointStressOnly;
                    s = sprintf('timeArrayBeforeRemovalOfPoint = %d', timeArray);
                    logDAI(s);
                    timeArray(idx) = [];
                    s = sprintf('timeArrayAfterRemovalOfPoint = %d', timeArray);
                    logDAI(s);
                    app.entryTimePointStressOnly = timeArray;
                    app.fittedCurveEntryStressOnly = [];
                    logDAI('Calling Draw Curve.');
                    drawEntryCurveStressOnly(app);
                    logDAI('Calling Curve Fitting.');
                    FitCurvesButtonStressOnlyPushed(app);

                    app.currentStenosisID = temporaryStenosisID;
                    app.currentStenosisNumber = temporaryStenosisNumber;
                end

                app.RemovePointPreCheckBoxStressOnly.Value = 0;
                app.SetYaxisMaxMenu.Visible = 'on';
            end
        end

        % Value changed function: RemovePointPostCheckBoxStressOnly
        function RemovePointPostCheckBoxStressOnlyValueChanged(app, event)
            value = app.RemovePointPostCheckBoxStressOnly.Value;
            if(value == 1)

                f = msgbox('Select a plot by clicking on it','Plot select', 'modal');
                uiwait(f);

                w = waitforbuttonpress;
                app.SetYaxisMaxMenu_2.Visible = 'off';

                if (strcmp(app.plotToRemovePoint, 'post'))

                    if (~isempty(app.fittedCurvePdStressOnly))
                        app.fittedCurvePdStressOnly = [];
                        drawPostLesionCurveStressOnly(app);
                    end

                    pts = getpts(app.pdPlotAreaStressOnly);
                    data = app.xDataPostStressOnly;
                    distance = round(data - pts(1));
                    idx = find(distance == 0);
                    dataArray = app.pdCurveStressOnly;
                    dataArray(idx) = [];
                    app.pdCurveStressOnly = dataArray;
                    timeArray = app.pdTimePointsStressOnly;
                    timeArray(idx) = [];
                    app.pdTimePointsStressOnly = timeArray;
                    drawPostLesionCurveStressOnly(app);

                elseif (contains(app.plotToRemovePoint, 'exit'))

                    logDAI('Entered point removal for exit curve.');
                    plotID = str2double(app.plotToRemovePoint(end));
                    s = sprintf('plotID Selected = %d', plotID);
                    logDAI(s);
                    temporaryStenosisID = app.currentStenosisID;
                    s = sprintf('temporaryStenosisID and currentStenosisID = %d', temporaryStenosisID);
                    logDAI(s);
                    temporaryStenosisNumber = app.currentStenosisNumber;
                    s = sprintf('temporaryStenosisNumber and currentStenosisNumber = %d', temporaryStenosisNumber);
                    logDAI(s);
                    app.currentStenosisID = plotID;
                    app.currentStenosisNumber = plotID;

                    pts = getpts(app.pdPlotAreaStressOnly);

                    s = sprintf('point selected = %d', pts(1));
                    logDAI(s);
                    data = app.roiObjectStressOnly.exitRoiObject(plotID).curveData.timePoints;
                    s = sprintf('data = %d', data);
                    logDAI(s);
                    distance = round(data - pts(1));
                    idx = find(distance == 0);
                    s = sprintf('idx = %d', idx);
                    logDAI(s);

                    app.exitCurveStressOnly = app.roiObjectStressOnly.exitRoiObject(plotID).curveData.curve;
                    app.exitTimePointStressOnly = app.roiObjectStressOnly.exitRoiObject(plotID).curveData.timePoints;

                    dataArray = app.exitCurveStressOnly;
                    s = sprintf('dataArrayBeforeRemovalOfPoint = %d', dataArray);
                    logDAI(s);
                    dataArray(idx) = [];
                    s = sprintf('dataArrayAfterRemovalOfPoint = %d', dataArray);
                    logDAI(s);
                    app.exitCurveStressOnly = dataArray;
                    timeArray = app.exitTimePointStressOnly;
                    s = sprintf('timeArrayBeforeRemovalOfPoint = %d', timeArray);
                    logDAI(s);
                    timeArray(idx) = [];
                    s = sprintf('timeArrayAfterRemovalOfPoint = %d', timeArray);
                    logDAI(s);
                    app.exitTimePointStressOnly = timeArray;
                    app.fittedCurveExitStressOnly = [];
                    logDAI('Calling Draw Curve.');
                    drawExitCurveStressOnly(app);
                    logDAI('Calling Curve Fitting.');
                    FitCurvesButtonStressOnly_2Pushed(app);

                    app.currentStenosisID = temporaryStenosisID;
                    app.currentStenosisNumber = temporaryStenosisNumber;
                end

                app.RemovePointPostCheckBoxStressOnly.Value = 0;
                app.SetYaxisMaxMenu_2.Visible = 'on';
            end
        end

        % Button pushed function: SetLADPointButton
        function SetLADPointButtonPushed(app, event)
            ptsValue = drawpoint(app.ImageAxes3D);
            app.ptsLAD(end+1) = app.currentSlice3D;
            app.ptsLAD(end+1) = round(ptsValue.Position(2));
            app.ptsLAD(end+1) = round(ptsValue.Position(1));
            % Quadruplet of (Slice #, X, Y, PixelValue)
            app.supervisedLearningLabeledPoints{end+1} = 'lad';
            logDAI('LAD point adding completed.');
            logDAI('Putting point on JPEG volume');
            img = app.threeDVolume(:,:,app.currentSlice3D);
            imgJPEG(:,:,:) = app.volumeJPEG(:,:,app.currentSlice3D,:);
            app.ptsLAD(end+1) = imgJPEG(round(ptsValue.Position(2)), round(ptsValue.Position(1)));
            imgJPEG = getColoredPointForMarkedCoordinate(imgJPEG, round(ptsValue.Position(2)), round(ptsValue.Position(1)), [0.0, 255.0, 0.0]);
            app.volumeJPEG(:,:,app.currentSlice3D,:) = imgJPEG(:,:,:);
            updateimage3D(app, img);
            updateimage3DJPEG(app,imgJPEG);
        end

        % Button pushed function: SetLCxPointButton
        function SetLCxPointButtonPushed(app, event)
            ptsValue = drawpoint(app.ImageAxes3D);
            app.ptsLCx(end+1) = app.currentSlice3D;
            app.ptsLCx(end+1) = round(ptsValue.Position(2));
            app.ptsLCx(end+1) = round(ptsValue.Position(1));
            % Quadruplet of (Slice #, X, Y, PixelValue)
            app.supervisedLearningLabeledPoints{end+1} = 'lcx';
            logDAI('LCx point adding completed.');
            logDAI('Putting point on JPEG volume');
            img = app.threeDVolume(:,:,app.currentSlice3D);
            imgJPEG(:,:,:) = app.volumeJPEG(:,:,app.currentSlice3D,:);
            app.ptsLCx(end+1) = imgJPEG(round(ptsValue.Position(2)), round(ptsValue.Position(1)));
            imgJPEG = getColoredPointForMarkedCoordinate(imgJPEG, round(ptsValue.Position(2)), round(ptsValue.Position(1)), [0.0, 0.0, 255.0]);
            app.volumeJPEG(:,:,app.currentSlice3D,:) = imgJPEG(:,:,:);
            updateimage3D(app, img);
            updateimage3DJPEG(app,imgJPEG);
        end

        % Button pushed function: SetApexPointButton
        function SetApexPointButtonPushed(app, event)
            ptsValue = drawpoint(app.ImageAxes3D);
            app.ptsApex(end+1) = app.currentSlice3D;
            app.ptsApex(end+1) = round(ptsValue.Position(2));
            app.ptsApex(end+1) = round(ptsValue.Position(1));
            % Triplet of (Slice #, X, Y, PixelValue)
            app.supervisedLearningLabeledPoints{end+1} = 'apex';
            logDAI('Apex point adding completed.');
            logDAI('Putting point on JPEG volume');
            img = app.threeDVolume(:,:,app.currentSlice3D);
            imgJPEG(:,:,:) = app.volumeJPEG(:,:,app.currentSlice3D,:);
            app.ptsApex(end+1) = imgJPEG(round(ptsValue.Position(2)), round(ptsValue.Position(1)));
            imgJPEG = getColoredPointForMarkedCoordinate(imgJPEG, round(ptsValue.Position(2)), round(ptsValue.Position(1)), [255.0, 0.0, 255.0]);
            app.volumeJPEG(:,:,app.currentSlice3D,:) = imgJPEG(:,:,:);
            updateimage3D(app, img);
            updateimage3DJPEG(app,imgJPEG);
        end

        % Callback function
        function ViewModeButtonGroupSelectionChanged(app, event)

        end

        % Callback function
        function LoadTimeInfoStudiesButtonPushed(app, event)
            % Display uigetfile dialog
            filterspec = {'*.*','All Files'};
            [f, p] = uigetfile(filterspec);
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);

            % Read dicom files:
            app.timePoints = readTimeInfoOnlyFromImages(p);
            app.interpolatedTimePoints = app.timePoints;
            set(gcf, 'Pointer','arrow');

            % Make sure user didn't cancel uigetfile dialog
            if (ischar(p))
                % Generate the First Image, update sliders' positions and Send it for displaying
                firstImage(1:512,1:512) = app.fourDImageSet(1,1,1:512,1:512);
                app.SlicesSlider.Limits = [1 size(app.fourDImageSet,1)];
                tickValues = getSliderTicks(1, size(app.fourDImageSet,1));
                app.SlicesSlider.MajorTicks = tickValues;
                app.TimePointsSlider.Limits = [1 size(app.fourDImageSet,2)];
                app.TimePointsSlider.MajorTicks = [1:size(app.fourDImageSet,2)];
                app.TimePointsSlider.MajorTickLabels = arrayfun(@num2str, app.TimePointsSlider.MajorTicks, 'UniformOutput', 0);
                app.TimePointsSlider.MinorTicks = [1:size(app.fourDImageSet,2)];
                level = 500;
                width = 1500;
                app.minWindow = level - width / 2;
                app.maxWindow = level + width / 2;
                updateimage(app, firstImage);
            end

            % Set Initial y axes limits
            app.paPlotArea.YLim = [-50 500];
            app.pdPlotArea.YLim = [-50 500];
        end

        % Value changed function: GraphAppearanceDropDown
        function GraphAppearanceDropDownValueChanged(app, event)
            value = app.GraphAppearanceDropDown.Value;
            if (strcmp(value, 'Smooth Line'))
                tempallFFRStressOnlySliceLocations = app.allFFRStressOnlySliceLocations;
                tempallFFRStressOnly = app.allFFRStressOnly;
                Xi = app.allFFRStressOnlySliceLocations(1):0.1:max(app.allFFRStressOnlySliceLocations(:));
                Yi = pchip(app.allFFRStressOnlySliceLocations,app.allFFRStressOnly,Xi);

                app.allFFRStressOnlySliceLocations = Xi;
                app.allFFRStressOnly = Yi;

                tempallFlowVelocitiesSliceLocationsStressOnly = app.allFlowVelocitiesSliceLocationsStressOnly;
                tempallFlowVelocitiesStressOnly = app.allFlowVelocitiesStressOnly;
                Xi = [];
                Yi = [];

                Xi = app.allFlowVelocitiesSliceLocationsStressOnly(1):0.1:max(app.allFlowVelocitiesSliceLocationsStressOnly(:));
                Yi = pchip(app.allFlowVelocitiesSliceLocationsStressOnly,app.allFlowVelocitiesStressOnly,Xi);
                app.allFlowVelocitiesSliceLocationsStressOnly = Xi;
                app.allFlowVelocitiesStressOnly = Yi;

                drawFFRCurve(app);

                app.allFFRStressOnlySliceLocations = tempallFFRStressOnlySliceLocations;
                app.allFFRStressOnly = tempallFFRStressOnly;
                app.allFlowVelocitiesSliceLocationsStressOnly = tempallFlowVelocitiesSliceLocationsStressOnly;
                app.allFlowVelocitiesStressOnly = tempallFlowVelocitiesStressOnly;

            elseif (strcmp(value, 'Remove Marker'))
                drawFFRCurve(app, '-');
            elseif (strcmp(value, 'Add Marker'))
                drawFFRCurve(app);
            elseif (strcmp(value, 'Default'))
                drawFFRCurve(app);
            end
        end

        % Selection changed function: FrictionFactorButtonGroupRest
        function FrictionFactorButtonGroupRestSelectionChanged(app, event)
            selectedButton = app.FrictionFactorButtonGroupRest.SelectedObject;
            app.fMethodRest = selectedButton.Text;
        end

        % Selection changed function: 
        % FrictionFactorButtonGroupStressOnly
        function FrictionFactorButtonGroupStressOnlySelectionChanged(app, event)
            selectedButton = app.FrictionFactorButtonGroupStressOnly.SelectedObject;
            app.fMethodStressOnly = selectedButton.Text;
        end

        % Selection changed function: ArteryTypeButtonGroupRest
        function ArteryTypeButtonGroupRestSelectionChanged(app, event)
            selectedButton = app.ArteryTypeButtonGroupRest.SelectedObject;
            app.arteryTypeRest = selectedButton.Text;
        end

        % Selection changed function: 
        % ArteryTypeButtonGroupStressOnly
        function ArteryTypeButtonGroupStressOnlySelectionChanged(app, event)
            selectedButton = app.ArteryTypeButtonGroupStressOnly.SelectedObject;
            app.arteryTypeStressOnly = selectedButton.Text;
        end

        % Value changed function: FlipSliceNumbersCheckBox
        function FlipSliceNumbersCheckBoxValueChanged(app, event)
            value = app.FlipSliceNumbersCheckBox.Value;
            if (value == 1)
                logDAI('Flip Slice Number Checkbox checked.');
                app.reversedALLFFRStressOnly = true;
                logDAI('Reversing allFFRStressOnly vector done.');
            else
                logDAI('Flip Slice Number Checkbox unchecked.');
                app.reversedALLFFRStressOnly = false;
            end

            drawFFRCurve(app);

        end

        % Button pushed function: SetWindowButtonSupervised
        function SetWindowButtonSupervisedPushed(app, event)
            logDAI('Getting new level and width from input field');
            level = str2double(app.SetWindowLevelSupervised.Value{1});
            width = str2double(app.SetWindowWidthSupervised.Value{1});
            logDAI('Calculating new level and width');
            app.minWindow3D = level - width / 2;
            app.maxWindow3D = level + width / 2;
            logDAI('New level and width calculated');
            logDAI('Applying new level and width');
            imagesc(app.ImageAxes3D, app.im, [app.minWindow3D, app.maxWindow3D]);
            logDAI('New level and width applied');
        end

        % Callback function
        function ViewOptionButtonGroupSelectionChanged(app, event)

        end

        % Callback function
        function ScannerDropDownValueChanged(app, event)
            value = app.ScannerDropDown.Value;
            app.scannerType = value;
        end

        % Callback function
        function ScannerDropDownRestValueChanged(app, event)

        end

        % Button down function: ImageAxes3D
        function ImageAxes3DButtonDown(app, event)

        end

        % Value changing function: SlicesSliderCTAStressOnly
        function SlicesSliderCTAStressOnlyValueChanging(app, event)
            sliceLimit = size(app.ctaVolume,3);
            if (round(event.Value) > sliceLimit)
                changingValue = sliceLimit;
            else
                if (round(event.Value) == 0)
                    changingValue = 1;
                else
                    changingValue = round(event.Value);
                end
            end
            app.currentSliceCTA = changingValue;
            app.SlicesSliderCTAStressOnlyLabel.Text = sprintf('Slice %d/%d', app.currentSliceCTA, size(app.ctaVolume, 3));
            imageData(1:512, 1:512) = app.ctaVolume(1:512,1:512,app.currentSliceCTA);

            updateimageCTA(app, imageData);
        end

        % Callback function
        function ViewModeButtonGroupStressOnlySelectionChanged(app, event)

        end

        % Callback function
        function ViewOptionButtonStressOnlySelectionChanged(app, event)

        end

        % Button pushed function: SetWindowButtonCTAStressOnly
        function SetWindowButtonCTAStressOnlyPushed(app, event)
            level = str2double(app.SetWindowLevelCTAStressOnly.Value{1});
            width = str2double(app.SetWindowWidthCTAStressOnly.Value{1});
            app.minWindowCTA = level - width / 2;
            app.maxWindowCTA = level + width / 2;
            imagesc(app.ImageAxesCTAStressOnly, app.imCTA, [app.minWindowCTA, app.maxWindowCTA]);
        end

        % Menu selected function: UserGuideMenu
        function UserGuideMenuSelected(app, event)
            docxFileDirectory = pwd;
            docxFileName = strcat(docxFileDirectory, '\Documents\User Manual.docx');
            pdfFileName = convertDocxToPdf(docxFileDirectory, docxFileName);
            open(pdfFileName);
        end

        % Menu selected function: BrightMenu
        function BrightMenuSelected(app, event)
            app.viewMode = 'Normal';
            changeViewMode(app, 'Normal');
            app.BrightMenu.Checked = true;
            app.DarkMenu.Checked = false;
        end

        % Menu selected function: DarkMenu
        function DarkMenuSelected(app, event)
            app.viewMode = 'Dark';
            changeViewMode(app, 'Dark');
            app.BrightMenu.Checked = false;
            app.DarkMenu.Checked = true;
        end

        % Menu selected function: FullMenu
        function FullMenuSelected(app, event)
            logDAI('View Option in Full Mode');
            app.FrictionFactorButtonGroup.Visible = true;
            app.ArteryTypeButtonGroup.Visible = true;
            app.FrictionFactorButtonGroupRest.Visible = true;
            app.ArteryTypeButtonGroupRest.Visible = true;
            app.FrictionFactorButtonGroupStressOnly.Visible = false;
            app.ArteryTypeButtonGroupStressOnly.Visible = false;

            app.ClearInputsButton.Visible = true;
            app.CopyRestInputsButton.Visible = true;
            app.ClearInputsButtonRest.Visible = true;
            app.CopyStressInputsButton.Visible = true;
            app.ClearInputsButtonStressOnly.Visible = true;

            app.ArterialRoughness.Visible = true;
            app.SystolicBloodPressuremmHgEditField_2Label_2.Text = 'Arterial Roughness (cm)';

            app.ArterialRoughnessRest.Visible = true;
            app.SystolicBloodPressuremmHgEditField_2Label_3.Text = 'Arterial Roughness (cm)';

            app.MarkStenosisCheckBox.Visible = true;
            app.MarkBreakerCheckBox.Visible = true;

            logDAI('View Option Succesfully Changed in Full Mode');

            app.FullMenu.Checked = true;
            app.BasicMenu.Checked = false;
        end

        % Menu selected function: BasicMenu
        function BasicMenuSelected(app, event)
            logDAI('View Option in Basic Mode');
            app.FrictionFactorButtonGroup.Visible = false;
            app.ArteryTypeButtonGroup.Visible = false;
            app.FrictionFactorButtonGroupRest.Visible = false;
            app.ArteryTypeButtonGroupRest.Visible = false;
            app.FrictionFactorButtonGroupStressOnly.Visible = false;
            app.ArteryTypeButtonGroupStressOnly.Visible = false;

            app.ClearInputsButton.Visible = false;
            app.CopyRestInputsButton.Visible = false;
            app.ClearInputsButtonRest.Visible = false;
            app.CopyStressInputsButton.Visible = false;
            app.ClearInputsButtonStressOnly.Visible = false;

            app.ArterialRoughness.Visible = false;
            app.SystolicBloodPressuremmHgEditField_2Label_2.Text = '';

            app.ArterialRoughnessRest.Visible = false;
            app.SystolicBloodPressuremmHgEditField_2Label_3.Text = '';

            app.SystolicBloodPressuremmHgEditField_2Label_4.Text = '';

            app.MarkStenosisCheckBox.Visible = false;
            app.MarkBreakerCheckBox.Visible = false;
            logDAI('View Option Succesfully Changed in Basic Mode');

            app.FullMenu.Checked = false;
            app.BasicMenu.Checked = true;
        end

        % Menu selected function: AboutDAIVeraMenu
        function AboutDAIVeraMenuSelected(app, event)
            msgbox('DAI Vera is a software developed to analyse dynamic contrast-enhanced CT images for functional assessment of cardiovascular diseases. It is a proprietary property of the So''s lab at Lawson Health Research Institute and Western University. All rights reserved.');
        end

        % Menu selected function: DCECTImagesMenu
        function DCECTImagesMenuSelected(app, event)

        end

        % Menu selected function: CTAImagesMenu
        function CTAImagesMenuSelected(app, event)
            % Display uigetfile dialog
            filterspec = {'*.*','All Files'};
            [f, p] = uigetfile(filterspec);
            if (p == 0)
                % Do Nothing
                figure(app.UIFigure);
            else
                set(gcf, 'Pointer','watch');
                drawnow;
                figure(app.UIFigure);

                try
                    % Read 3D volume:

                    [app.ctaVolume,sp] = dicomreadVolume(p);
                    app.ctaVolume = squeeze(app.ctaVolume);
                    listings = dir(p);
                    fname = strcat(p,listings(3).name);
                    app.ctaInfo = dicominfo(fname);
                    app.ctaVolume = app.ctaVolume * app.ctaInfo.RescaleSlope + app.ctaInfo.RescaleIntercept;

                    app.SlicesSliderCTAStressOnly.Limits = [1 size(app.ctaVolume,3)];
                    tickValues = getSliderTicks(1, size(app.ctaVolume,3));
                    app.SlicesSliderCTAStressOnly.MajorTicks = tickValues;

                    set(gcf, 'Pointer','arrow');

                    minValue = min(app.ctaVolume(:));
                    maxValue = max(app.ctaVolume(:));
                    width = maxValue - minValue;
                    level = (maxValue + minValue) / 2;
                    app.minWindowCTA = level - width / 2;
                    app.maxWindowCTA = level + width / 2;

                    % Make sure user didn't cancel uigetfile dialog
                    if (ischar(p))
                        firstImage = app.ctaVolume(:,:,1);
                        updateimageCTA(app,firstImage);
                    end
                catch ME
                    try
                        [app.ctaVolume, app.ctaInfo] = readRegularCTAVolume(p);

                        app.SlicesSliderCTAStressOnly.Limits = [1 size(app.ctaVolume,3)];
                        tickValues = getSliderTicks(1, size(app.ctaVolume,3));
                        app.SlicesSliderCTAStressOnly.MajorTicks = tickValues;

                        set(gcf, 'Pointer','arrow');

                        minValue = min(app.ctaVolume(:));
                        maxValue = max(app.ctaVolume(:));
                        width = maxValue - minValue;
                        level = (maxValue + minValue) / 2;
                        app.minWindowCTA = level - width / 2;
                        app.maxWindowCTA = level + width / 2;

                        % Make sure user didn't cancel uigetfile dialog
                        if (ischar(p))
                            firstImage = app.ctaVolume(:,:,1);
                            updateimageCTA(app,firstImage);
                        end
                    catch ME
                        set(gcf, 'Pointer','arrow');
                        msg = strcat('The DAI did not fail, there seems to be an issue with this dataset in particular: ', ME.message);
                        errordlg(msg);
                    end
                end
            end
        end

        % Menu selected function: DCECTImagesMenu_2
        function DCECTImagesMenu_2Selected(app, event)
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);

            writeDicomVolume(app.fourDImageSetStressOnly, app.allDicomInfoStressOnly, 'Stress');

            set(gcf, 'Pointer','arrow');
        end

        % Menu selected function: ResultsMenu
        function ResultsMenuSelected(app, event)
            generateReport(app);
            generateDetailsReport(app);
        end

        % Menu selected function: FittedCurvesMenu
        function FittedCurvesMenuSelected(app, event)
            if (~isempty(app.paCurveStressOnly))
                if (isempty(app.ConversionFactorEditFieldStressOnly))
                    tempAucA = app.aucAStressOnly;
                    tempAucB = app.aucBStressOnly;
                else
                    tempAucA = app.aucAStressOnly / str2double(app.ConversionFactorEditFieldStressOnly.Value);
                    tempAucB = app.aucBStressOnly / str2double(app.ConversionFactorEditFieldStressOnly.Value);
                end
                exportCurves(app.paCurveStressOnly, app.pdCurveStressOnly, app.fittedCurvePaStressOnly, app.fittedCurvePdStressOnly, app.timePointsStressOnly, app.fittedTimePaStressOnly, tempAucA, tempAucB, app.dicomInfoStressOnly.PatientName.FamilyName, 'StressOnly');
            end
        end

        % Menu selected function: FFRValuesMenu
        function FFRValuesMenuSelected(app, event)
            logDAI('Calling exportFFRCurve()');
            exportFFRCurve(app.allFFRStressOnlySliceLocations, app.allFFRStressOnlyDicomSliceNumbers, app.allFFRStressOnly, app.paStressOnly(1), app.allFlowVelocitiesStressOnly, app.dicomInfoStressOnly.PatientName.FamilyName);
            logDAI('FFRExport Successful');
        end

        % Menu selected function: ScreenCaptureMenu
        function ScreenCaptureMenuSelected(app, event)
            saveScreen(app);
        end

        % Menu selected function: StressImagesMenu_4
        function StressImagesMenu_4Selected(app, event)

        end

        % Menu selected function: RestImagesMenu_2
        function RestImagesMenu_2Selected(app, event)

        end

        % Menu selected function: TimeInfoStudyStressMenu
        function TimeInfoStudyStressMenuSelected(app, event)
            % Display uigetfile dialog
            filterspec = {'*.*','All Files'};
            [f, p] = uigetfile(filterspec);
            if (p == 0)
                % Do nothing
                figure(app.UIFigure);
            else
                set(gcf, 'Pointer','watch');
                drawnow;
                figure(app.UIFigure);

                % Read dicom files:
                app.timePoints = readTimeInfoOnlyFromImages(p);
                app.interpolatedTimePoints = app.timePoints;
                set(gcf, 'Pointer','arrow');

                % Make sure user didn't cancel uigetfile dialog
                if (ischar(p))
                    % Generate the First Image, update sliders' positions and Send it for displaying
                    firstImage(1:512,1:512) = app.fourDImageSet(1,1,1:512,1:512);
                    app.SlicesSlider.Limits = [1 size(app.fourDImageSet,1)];
                    tickValues = getSliderTicks(1, size(app.fourDImageSet,1));
                    app.SlicesSlider.MajorTicks = tickValues;
                    app.TimePointsSlider.Limits = [1 size(app.fourDImageSet,2)];
                    app.TimePointsSlider.MajorTicks = [1:size(app.fourDImageSet,2)];
                    app.TimePointsSlider.MajorTickLabels = arrayfun(@num2str, app.TimePointsSlider.MajorTicks, 'UniformOutput', 0);
                    app.TimePointsSlider.MinorTicks = [1:size(app.fourDImageSet,2)];
                    level = 500;
                    width = 1500;
                    app.minWindow = level - width / 2;
                    app.maxWindow = level + width / 2;
                    updateimage(app, firstImage);
                end

                % Set Initial y axes limits
                app.paPlotArea.YLim = [-50 500];
                app.pdPlotArea.YLim = [-50 500];
            end
        end

        % Menu selected function: TimeInfoStudyRestMenu
        function TimeInfoStudyRestMenuSelected(app, event)
            % Display uigetfile dialog
            filterspec = {'*.*','All Files'};
            [f, p] = uigetfile(filterspec);
            if (p == 0)
                % Do nothing
                figure(app.UIFigure);
            else
                set(gcf, 'Pointer','watch');
                drawnow;
                figure(app.UIFigure);

                % Read dicom files:
                app.timePointsRest = readTimeInfoOnlyFromImages(p);
                app.interpolatedTimePointsRest = app.timePointsRest;
                set(gcf, 'Pointer','arrow');

                % Make sure user didn't cancel uigetfile dialog
                if (ischar(p))
                    % Generate the First Image, update sliders' positions and Send it for displaying
                    firstImage(1:512,1:512) = app.restImageSet(1,1,1:512,1:512);
                    app.SlicesSliderRest.Limits = [1 size(app.restImageSet,1)];
                    tickValues = getSliderTicks(1, size(app.restImageSet,1));
                    app.SlicesSliderRest.MajorTicks = tickValues;
                    app.TimePointsSliderRest.Limits = [1 size(app.restImageSet,2)];
                    app.TimePointsSliderRest.MajorTicks = [1:size(app.restImageSet,2)];
                    app.TimePointsSliderRest.MajorTickLabels = arrayfun(@num2str, app.TimePointsSlider.MajorTicks, 'UniformOutput', 0);
                    app.TimePointsSliderRest.MinorTicks = [1:size(app.restImageSet,2)];
                    level = 500;
                    width = 1500;
                    app.minWindowRest = level - width / 2;
                    app.maxWindowRest = level + width / 2;
                    updateImageRest(app, firstImage);
                end

                % Set Initial y axes limits
                app.paPlotArea.YLim = [-50 500];
                app.pdPlotArea.YLim = [-50 500];
            end
        end

        % Menu selected function: StressImagesMenu_3
        function StressImagesMenu_3Selected(app, event)
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);

            writeDicomVolume(app.fourDImageSet, app.allDicomInfo, 'Stress');

            set(gcf, 'Pointer','arrow');
        end

        % Menu selected function: RestImagesMenu
        function RestImagesMenuSelected(app, event)
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);

            writeDicomVolume(app.restImageSet, app.allDicomInfoRest, 'Rest');

            set(gcf, 'Pointer','arrow');
        end

        % Menu selected function: PreLesionCurveMenu_2
        function PreLesionCurveMenu_2Selected(app, event)
            filterspec = {'*.txt','Text Files';'*.xlsx','Excel Files'};
            [f, p] = uigetfile(filterspec);
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);
            set(gcf, 'Pointer','arrow');

            logDAI('Checking chosen file type:');
            [~, name, ext] = fileparts(f);

            if (strcmp(ext,'.xlsx'))
                logDAI('File type is excel, reading excel file.');
                fName = strcat(p, f);
                data = readtable(fName);
                time = data{1:end, 1};
                roi = data{1:end, 2};
            end

            if (strcmp(ext,'.txt'))
                logDAI('File type is txt, reading txt file.');
                % Read text files:
                fileName = strcat(p,f);
                [time, roi] = readDataFile(fileName);
                if time(2) >= 500
                    time = time / 1000;
                end
            end

            % Make sure user didn't cancel uigetfile dialog
            if (ischar(p))
                logDAI('Plotting the curve');
                app.paCurve = roi;
                app.plotX = time;
                app.paPlotArea.YLim = [app.yAxisLimitMin app.yAxisLimitMax];
                interval = getPlotInterval(app.yAxisLimitMin, app.yAxisLimitMax);
                app.paPlotArea.YTick = [app.yAxisLimitMin:interval:app.yAxisLimitMax];
                app.paPlotArea.XLim = [1 max(time)];
                app.paPlotArea.XTick = [1:max(time)/10:max(time)];
                app.paPlotArea.XTick = cast(app.paPlotArea.XTick, 'int16');
                plot(app.paPlotArea, app.plotX, app.paCurve, 'mo');
                app.preTextRead = true;
                logDAI('Plotting the curve is successful');
            end

            if (app.preTextRead == true && app.postTextRead == true)
                prompt = {'Relative Height(cm):','Pre-Post Distance(cm):'};
                dlgtitle = 'Enter';
                dims = [1 35];
                definput = {'0','0'};
                answer = inputdlg(prompt,dlgtitle,dims,definput);
                app.hBText = str2double(answer{1});
                app.LText = str2double(answer{2});
                figure(app.UIFigure);
            end
        end

        % Menu selected function: FittedCurveMenu_2
        function FittedCurveMenu_2Selected(app, event)
            if (~isempty(app.paCurve))
                if (isempty(app.ConversionFactorEditField))
                    tempAucA = app.aucA;
                    tempAucB = app.aucB;
                else
                    tempAucA = app.aucA / str2double(app.ConversionFactorEditField.Value);
                    tempAucB = app.aucB / str2double(app.ConversionFactorEditField.Value);
                end
                exportCurves(app.paCurve, app.pdCurve, app.fittedCurvePa, app.fittedCurvePd, app.timePoints, app.fittedTimePa, tempAucA, tempAucB, app.dicomInfo.PatientName.FamilyName, 'Stress');
            end
            if (~isempty(app.paCurveRest))
                if (isempty(app.ConversionFactorEditField))
                    tempAucA = app.aucARest;
                    tempAucB = app.aucBRest;
                else
                    tempAucA = app.aucARest / str2double(app.ConversionFactorEditFieldRest.Value);
                    tempAucB = app.aucBRest / str2double(app.ConversionFactorEditFieldRest.Value);
                end
                exportCurves(app.paCurveRest, app.pdCurveRest, app.fittedCurvePaRest, app.fittedCurvePdRest, app.timePointsRest, app.fittedTimePaRest, tempAucA, tempAucB, app.dicomInfoRest.PatientName.FamilyName, 'Rest');
            end
        end

        % Menu selected function: ResultsMenu_2
        function ResultsMenu_2Selected(app, event)
            generateReport(app);
            generateDetailsReport(app);
        end

        % Menu selected function: DCTAVolumeMenu
        function DCTAVolumeMenuSelected(app, event)
            % Display uigetfile dialog
            filterspec = {'*.*','All Files'};
            [f, p] = uigetfile(filterspec);
            if (p == 0)
                % Do nothing
                figure(app.UIFigure);
            else
                set(gcf, 'Pointer','watch');
                drawnow;
                figure(app.UIFigure);

                try
                    % Read 3D volume:
                    [app.threeDVolume,sp] = dicomreadVolume(p);
                    app.threeDVolume = squeeze(app.threeDVolume);

                    logDAI('Converting dicomVolume to jpegVolume');
                    app.volumeJPEG = getJPEGVolumeFromDicomVolume(app.threeDVolume, 3);

                    app.labelImageDirectory = p;

                    app.SlicesSlider3D.Limits = [1 size(app.threeDVolume,3)];
                    tickValues = getSliderTicks(1, size(app.threeDVolume,3));
                    app.SlicesSlider3D.MajorTicks = tickValues;

                    set(gcf, 'Pointer','arrow');

                    level = 500;
                    width = 1500;
                    app.minWindow3D = level - width / 2;
                    app.maxWindow3D = level + width / 2;

                    % Make sure user didn't cancel uigetfile dialog
                    if (ischar(p))
                        firstImage = app.threeDVolume(:,:,1);
                        updateimage3D(app,firstImage);

                        firstImageJPEG(:,:,:) = app.volumeJPEG(:,:,1,:);
                        updateimage3DJPEG(app,firstImageJPEG);
                    end
                catch ME
                    set(gcf, 'Pointer','arrow');
                    msg = strcat('The DAI did not fail, there seems to be an issue with this dataset in particular: ', ME.message);
                    errordlg(msg);
                end
            end
        end

        % Menu selected function: LabelledDataMenu
        function LabelledDataMenuSelected(app, event)
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);

            % Delete previous temp files if saveCount = 1
            if (app.supervisedLearningSaveCount == 1)
                files = dir(fullfile(app.labelImageDirectory, '*.txt'));
                for i = 1:numel(files)
                    file = fullfile(app.labelImageDirectory, files(i).name);
                    delete(file);
                end
            end
            % Check if file exists for points:
            app.ptsRCA = readPreviousDataPointsFromFile(app, 'RCA.txt', 'RCA');
            app.ptsLAD = readPreviousDataPointsFromFile(app, 'LAD.txt', 'LAD');
            app.ptsLCx = readPreviousDataPointsFromFile(app, 'LCx.txt', 'LCx');
            app.ptsApex = readPreviousDataPointsFromFile(app, 'Apex.txt', 'Apex');

            % Get Label Ready:

            logDAI('Converting images to JPEG and putting them into JPEGData Directory');
            convertImagesToJpeg(app.labelImageDirectory, app.threeDVolume, 'JPEGData');
            logDAI('Images are converted to JPEG');
            labeledDataRCA = getLabel(app.ptsRCA, size(app.threeDVolume), 1);
            labeledDataLAD = getLabel(app.ptsLAD, size(app.threeDVolume), 2);
            labeledDataLCx = getLabel(app.ptsLCx, size(app.threeDVolume), 3);
            labeledDataApex = getLabel(app.ptsApex, size(app.threeDVolume), 4);

            % Clear the data points:
            logDAI('Clearing the data points');
            app.ptsRCA = [];
            app.ptsLAD = [];
            app.ptsLCx = [];
            app.ptsApex = [];

            labeledData = labeledDataRCA + labeledDataLAD + labeledDataLCx + labeledDataApex;

            newDirectory = convertCharsToStrings(app.labelImageDirectory) + 'LabeledData\';
            logDAI('LabeledData directory is: ');
            logDAI(newDirectory);
            logDAI('LabeledData directory is being created');
            mkdir (newDirectory);
            logDAI('LabeledData directory is successfully created');
            logDAI('Writing labeled data to LabeledData directory');
            for i = 1:size(labeledData, 3)
                currentImage = labeledData(:,:,i);
                fName = newDirectory + num2str(i) + '.jpg';
                imwrite(currentImage, fName);
            end
            logDAI('Writing labeled data to LabeledData directory is successful');

            app.supervisedLearningSaveCount = app.supervisedLearningSaveCount + 1;

            set(gcf, 'Pointer','arrow');
        end

        % Callback function
        function SiemensMenu_2Selected(app, event)
            app.scannerType = convertStringsToChars(app.scannerName(1));

            app.SiemensMenu_2.Checked = true;
            app.CanonMenu_2.Checked = false;
            app.GEMenu_2.Checked = false;
        end

        % Callback function
        function CanonMenu_2Selected(app, event)
            app.scannerType = convertStringsToChars(app.scannerName(2));

            app.SiemensMenu_2.Checked = false;
            app.CanonMenu_2.Checked = true;
            app.GEMenu_2.Checked = false;
        end

        % Callback function
        function SiemensMenuSelected(app, event)
            app.scannerTypeStressOnly = convertStringsToChars(app.scannerName(1));

            app.SiemensMenu.Checked = true;
            app.CanonMenu.Checked = false;
            app.GEMenu.Checked = false;
        end

        % Callback function
        function CanonMenuSelected(app, event)
            app.scannerTypeStressOnly = convertStringsToChars(app.scannerName(2));

            app.SiemensMenu.Checked = false;
            app.CanonMenu.Checked = true;
            app.GEMenu.Checked = false;
        end

        % Menu selected function: SetRCAPointMenu
        function SetRCAPointMenuSelected(app, event)
            ptsValue = drawpoint(app.ImageAxes3D);
            app.ptsRCA(end+1) = app.currentSlice3D;
            app.ptsRCA(end+1) = round(ptsValue.Position(2));
            app.ptsRCA(end+1) = round(ptsValue.Position(1));
            % Quadruplet of (Slice #, X, Y, PixelValue)
            app.supervisedLearningLabeledPoints{end+1} = 'rca';
            logDAI('RCA point adding completed.');
            logDAI('Putting point on JPEG volume');
            img = app.threeDVolume(:,:,app.currentSlice3D);
            imgJPEG(:,:,:) = app.volumeJPEG(:,:,app.currentSlice3D,:);
            app.ptsRCA(end+1) = imgJPEG(round(ptsValue.Position(2)), round(ptsValue.Position(1)));
            imgJPEG = getColoredPointForMarkedCoordinate(imgJPEG, round(ptsValue.Position(2)), round(ptsValue.Position(1)), [255.0, 0.0, 0.0]);
            app.volumeJPEG(:,:,app.currentSlice3D,:) = imgJPEG(:,:,:);
            updateimage3D(app, img);
            updateimage3DJPEG(app,imgJPEG);
        end

        % Menu selected function: SetLADPointMenu
        function SetLADPointMenuSelected(app, event)
            ptsValue = drawpoint(app.ImageAxes3D);
            app.ptsLAD(end+1) = app.currentSlice3D;
            app.ptsLAD(end+1) = round(ptsValue.Position(2));
            app.ptsLAD(end+1) = round(ptsValue.Position(1));
            % Quadruplet of (Slice #, X, Y, PixelValue)
            app.supervisedLearningLabeledPoints{end+1} = 'lad';
            logDAI('LAD point adding completed.');
            logDAI('Putting point on JPEG volume');
            img = app.threeDVolume(:,:,app.currentSlice3D);
            imgJPEG(:,:,:) = app.volumeJPEG(:,:,app.currentSlice3D,:);
            app.ptsLAD(end+1) = imgJPEG(round(ptsValue.Position(2)), round(ptsValue.Position(1)));
            imgJPEG = getColoredPointForMarkedCoordinate(imgJPEG, round(ptsValue.Position(2)), round(ptsValue.Position(1)), [0.0, 255.0, 0.0]);
            app.volumeJPEG(:,:,app.currentSlice3D,:) = imgJPEG(:,:,:);
            updateimage3D(app, img);
            updateimage3DJPEG(app,imgJPEG);
        end

        % Menu selected function: SetLCxPointMenu
        function SetLCxPointMenuSelected(app, event)
            ptsValue = drawpoint(app.ImageAxes3D);
            app.ptsLCx(end+1) = app.currentSlice3D;
            app.ptsLCx(end+1) = round(ptsValue.Position(2));
            app.ptsLCx(end+1) = round(ptsValue.Position(1));
            % Quadruplet of (Slice #, X, Y, PixelValue)
            app.supervisedLearningLabeledPoints{end+1} = 'lcx';
            logDAI('LCx point adding completed.');
            logDAI('Putting point on JPEG volume');
            img = app.threeDVolume(:,:,app.currentSlice3D);
            imgJPEG(:,:,:) = app.volumeJPEG(:,:,app.currentSlice3D,:);
            app.ptsLCx(end+1) = imgJPEG(round(ptsValue.Position(2)), round(ptsValue.Position(1)));
            imgJPEG = getColoredPointForMarkedCoordinate(imgJPEG, round(ptsValue.Position(2)), round(ptsValue.Position(1)), [0.0, 0.0, 255.0]);
            app.volumeJPEG(:,:,app.currentSlice3D,:) = imgJPEG(:,:,:);
            updateimage3D(app, img);
            updateimage3DJPEG(app,imgJPEG);
        end

        % Menu selected function: SetApexPointMenu
        function SetApexPointMenuSelected(app, event)
            ptsValue = drawpoint(app.ImageAxes3D);
            app.ptsApex(end+1) = app.currentSlice3D;
            app.ptsApex(end+1) = round(ptsValue.Position(2));
            app.ptsApex(end+1) = round(ptsValue.Position(1));
            % Triplet of (Slice #, X, Y, PixelValue)
            app.supervisedLearningLabeledPoints{end+1} = 'apex';
            logDAI('Apex point adding completed.');
            logDAI('Putting point on JPEG volume');
            img = app.threeDVolume(:,:,app.currentSlice3D);
            imgJPEG(:,:,:) = app.volumeJPEG(:,:,app.currentSlice3D,:);
            app.ptsApex(end+1) = imgJPEG(round(ptsValue.Position(2)), round(ptsValue.Position(1)));
            imgJPEG = getColoredPointForMarkedCoordinate(imgJPEG, round(ptsValue.Position(2)), round(ptsValue.Position(1)), [255.0, 0.0, 255.0]);
            app.volumeJPEG(:,:,app.currentSlice3D,:) = imgJPEG(:,:,:);
            updateimage3D(app, img);
            updateimage3DJPEG(app,imgJPEG);
        end

        % Menu selected function: StartTrainingMenu
        function StartTrainingMenuSelected(app, event)

            % Get Data Ready:
            trainingDS = getData(app.trainDirectory);
            validationDS = getData(app.validationDirectory);

            % Training Option:
            trainingOption = app.selectedTrainingOption;

            app.trainedNetwork = getTraining(trainingDS, validationDS, trainingOption);
            networkName = sprintf('%s/%s', 'TrainedNetwork', datestr(now,'yyyymmddTHHMMSSFFF'));
            save(networkName, app.trainedNetwork);
        end

        % Menu selected function: CNNMenu
        function CNNMenuSelected(app, event)
            app.selectedTrainingOption = convertStringsToChars(trainingOptions(1));

            app.CNNMenu.Checked = true;
            app.UNETMenu.Checked = false;
        end

        % Menu selected function: UNETMenu
        function UNETMenuSelected(app, event)
            app.selectedTrainingOption = convertStringsToChars(trainingOptions(2));

            app.CNNMenu.Checked = false;
            app.UNETMenu.Checked = true;
        end

        % Menu selected function: TrainingDataMenu
        function TrainingDataMenuSelected(app, event)
            app.trainDirectory = uigetdir;
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);
            set(gcf, 'Pointer','arrow');
        end

        % Menu selected function: ValidationDataMenu
        function ValidationDataMenuSelected(app, event)
            app.validationDirectory = uigetdir;
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);
            set(gcf, 'Pointer','arrow');
        end

        % Menu selected function: ClassifyMenu
        function ClassifyMenuSelected(app, event)
            testingDS = getData(app.testDirectory, 0, 0, labelName);
            predictedData = classify(app.trainedNetwork, testingDS);
        end

        % Menu selected function: TestDataMenu
        function TestDataMenuSelected(app, event)
            app.testDirectory = uigetdir;
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);
            set(gcf, 'Pointer','arrow');
        end

        % Menu selected function: SavedNetworkMenu
        function SavedNetworkMenuSelected(app, event)
            [f, p] = uigetfile();
            app.savedNetWork = coder.loadDeepLearningNetwork(p);
            app.trainedNetwork = app.savedNetwork;
        end

        % Menu selected function: PreLesionCurveMenu
        function PreLesionCurveMenuSelected(app, event)
            filterspec = {'*.txt','Text Files';'*.xlsx','Excel Files'};
            [f, p] = uigetfile(filterspec);
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);
            set(gcf, 'Pointer','arrow');

            logDAI('Checking chosen file type:');
            [~, name, ext] = fileparts(f);

            if (strcmp(ext,'.xlsx'))
                logDAI('File type is excel, reading excel file.');
                fName = strcat(p, f);
                data = readtable(fName);
                time = data.TimePoints;
                roi = data.PreLesionCurve;
            end

            if (strcmp(ext,'.txt'))
                logDAI('File type is txt, reading txt file.');
                % Read text files:
                fileName = strcat(p,f);
                [time, roi] = readDataFile(fileName);
                if time(2) >= 500
                    time = time / 1000;
                end
            end


            % Make sure user didn't cancel uigetfile dialog
            if (ischar(p))
                logDAI('Plotting the curve');
                app.paCurveStressOnly = roi;
                app.timePointsStressOnly = time;
                app.paTimePointsStressOnly = app.timePointsStressOnly;
                app.paPlotAreaStressOnly.YLim = [app.yAxisLimitMin app.yAxisLimitMax];
                app.paPlotAreaStressOnly.YTick = getSliderTicks(app.yAxisLimitMin, app.yAxisLimitMax, app.maxYAxisInterval);
                app.paPlotAreaStressOnly.XLim = [1 max(time)];
                app.paPlotAreaStressOnly.XTick = [1:max(time)/10:max(time)];
                app.paPlotAreaStressOnly.XTick = cast(app.paPlotAreaStressOnly.XTick, 'int16');
                % plot(app.paPlotAreaStressOnly, app.plotXPreStressOnly, app.paCurveStressOnly, 'mo');
                drawPreLesionCurveStressOnly(app);
                app.preTextReadStressOnly = true;
                logDAI('Plotting the curve is successful');
            end

            if (app.preTextReadStressOnly == true && app.postTextReadStressOnly == true)
                prompt = {'Relative Height(cm):','Pre-Post Distance(cm):'};
                dlgtitle = 'Enter';
                dims = [1 35];
                definput = {'0','0'};
                answer = inputdlg(prompt,dlgtitle,dims,definput);
                app.hBTextStressOnly = str2double(answer{1});
                app.LTextStressOnly = str2double(answer{2});
                figure(app.UIFigure);
            end
        end

        % Menu selected function: PostLesionCurveMenu
        function PostLesionCurveMenuSelected(app, event)
            filterspec = {'*.txt','Text Files';'*.xlsx','Excel Files'};
            [f, p] = uigetfile(filterspec);
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);
            set(gcf, 'Pointer','arrow');

            logDAI('Checking chosen file type:');
            [~, name, ext] = fileparts(f);

            if (strcmp(ext,'.xlsx'))
                logDAI('File type is excel, reading excel file.');
                fName = strcat(p, f);
                data = readtable(fName);
                time = data.TimePoints;
                roi = data.PostLesionCurve;
            end

            if (strcmp(ext,'.txt'))
                logDAI('File type is txt, reading txt file.');
                % Read text files:
                fileName = strcat(p,f);
                [time, roi] = readDataFile(fileName);
                if time(2) >= 500
                    time = time / 1000;
                end
            end

            % Make sure user didn't cancel uigetfile dialog
            if (ischar(p))
                logDAI('Plotting the curve');
                app.pdCurveStressOnly = roi;
                app.timePointsStressOnly = time;
                app.pdTimePointsStressOnly = app.timePointsStressOnly;
                app.pdPlotAreaStressOnly.YLim = [app.yAxisLimitMin app.yAxisLimitMax];
                app.pdPlotAreaStressOnly.YTick = getSliderTicks(app.yAxisLimitMin, app.yAxisLimitMax, app.maxYAxisInterval);
                app.pdPlotAreaStressOnly.XLim = [1 max(time)];
                app.pdPlotAreaStressOnly.XTick = [1:max(time)/10:max(time)];
                app.pdPlotAreaStressOnly.XTick = cast(app.pdPlotAreaStressOnly.XTick, 'int16');
                % plot(app.pdPlotAreaStressOnly, app.plotXPostStressOnly, app.pdCurveStressOnly, 'mo');
                drawPostLesionCurveStressOnly(app);
                app.postTextReadStressOnly = true;
                logDAI('Plotting the curve is successful');
            end

            if (app.preTextReadStressOnly == true && app.postTextReadStressOnly == true)
                prompt = {'Relative Height(cm):','Pre-Post Distance(cm):'};
                dlgtitle = 'Enter';
                dims = [1 35];
                definput = {'0','0'};
                answer = inputdlg(prompt,dlgtitle,dims,definput);
                app.hBTextStressOnly = str2double(answer{1});
                app.LTextStressOnly = str2double(answer{2});
                figure(app.UIFigure);
            end
        end

        % Menu selected function: PostLesionCurveMenu_2
        function PostLesionCurveMenu_2Selected(app, event)
            filterspec = {'*.txt','Text Files';'*.xlsx','Excel Files'};
            [f, p] = uigetfile(filterspec);
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);
            set(gcf, 'Pointer','arrow');

            logDAI('Checking chosen file type:');
            [~, name, ext] = fileparts(f);

            if (strcmp(ext,'.xlsx'))
                logDAI('File type is excel, reading excel file.');
                fName = strcat(p, f);
                data = readtable(fName);
                time = data{1:end, 1};
                roi = data{1:end, 3};
            end

            if (strcmp(ext,'.txt'))
                logDAI('File type is txt, reading txt file.');
                % Read text files:
                fileName = strcat(p,f);
                [time, roi] = readDataFile(fileName);
                if time(2) >= 500
                    time = time / 1000;
                end
            end

            % Make sure user didn't cancel uigetfile dialog
            if (ischar(p))
                logDAI('Plotting the curve');
                app.pdCurve = roi;
                app.plotX = time;
                app.pdPlotArea.YLim = [app.yAxisLimitMin app.yAxisLimitMax];
                interval = getPlotInterval(app.yAxisLimitMin, app.yAxisLimitMax);
                app.pdPlotArea.YTick = [app.yAxisLimitMin:interval:app.yAxisLimitMax];
                app.pdPlotArea.XLim = [1 max(time)];
                app.pdPlotArea.XTick = [1:max(time)/10:max(time)];
                app.pdPlotArea.XTick = cast(app.pdPlotArea.XTick, 'int16');
                plot(app.pdPlotArea, app.plotX, app.pdCurve, 'mo');
                app.postTextRead = true;
                logDAI('Plotting the curve is successful');
            end

            if (app.preTextRead == true && app.postTextRead == true)
                prompt = {'Relative Height(cm):','Pre-Post Distance(cm):'};
                dlgtitle = 'Enter';
                dims = [1 35];
                definput = {'0','0'};
                answer = inputdlg(prompt,dlgtitle,dims,definput);
                app.hBText = str2double(answer{1});
                app.LText = str2double(answer{2});
                figure(app.UIFigure);
            end
        end

        % Menu selected function: TimesMenu
        function TimesMenuSelected(app, event)
            app.fontName = 'Times';

            changeFontsTo(app, app.fontName);

            app.TimesMenu.Checked = true;
            app.ArialMenu.Checked = false;
            app.PalatinoLinotypeMenu.Checked = false;
        end

        % Callback function
        function HelveticaMenuSelected(app, event)

        end

        % Menu selected function: ArialMenu
        function ArialMenuSelected(app, event)
            app.fontName = 'Arial';

            changeFontsTo(app, app.fontName);

            app.ArialMenu.Checked = true;
            app.TimesMenu.Checked = false;
            app.PalatinoLinotypeMenu.Checked = false;
        end

        % Callback function
        function GEMenuSelected(app, event)
            app.scannerTypeStressOnly = convertStringsToChars(app.scannerName(3));

            app.SiemensMenu.Checked = false;
            app.CanonMenu.Checked = false;
            app.GEMenu.Checked = true;
        end

        % Callback function
        function GEMenu_2Selected(app, event)
            app.scannerType = convertStringsToChars(app.scannerName(3));

            app.SiemensMenu_2.Checked = false;
            app.CanonMenu_2.Checked = false;
            app.GEMenu_2.Checked = true;
        end

        % Menu selected function: ExitMenu
        function ExitMenuSelected(app, event)
            close all force;
        end

        % Menu selected function: AutoMenu
        function AutoMenuSelected(app, event)
            logDAI('Auto Scaling for Pre Lesion Curve Selected');
            app.paPlotAreaStressOnly.YLim = [app.yAxisLimitMin app.yAxisLimitMax];
            app.paPlotAreaStressOnly.YTick = getSliderTicks(app.yAxisLimitMin, app.yAxisLimitMax);

            app.ManualMenu.Checked = false;
            app.AutoMenu.Checked = true;
            logDAI('Auto Scaling for Pre Lesion Curve Applied');
        end

        % Menu selected function: ManualMenu
        function ManualMenuSelected(app, event)
            logDAI('Manual Scaling for Pre Lesion Curve Selected');
            prompt = {'Min Limit (HU)','Max Limit (HU)','Interval (HU)'};
            dlgtitle = 'Enter';
            dims = [1 35];
            definput = {'-50','500','10'};
            answer = inputdlg(prompt,dlgtitle,dims,definput);
            localYAxisLimitMin = str2double(answer{1});
            localYAxisLimitMax = str2double(answer{2});
            fixedInterval = str2double(answer{3});

            app.paPlotAreaStressOnly.YLim = [localYAxisLimitMin localYAxisLimitMax];
            app.paPlotAreaStressOnly.YTick = getSliderTicks(localYAxisLimitMin, localYAxisLimitMax, fixedInterval);

            figure(app.UIFigure);

            app.AutoMenu.Checked = false;
            app.ManualMenu.Checked = true;
            logDAI('Manual Scaling for Pre Lesion Curve Applied');
        end

        % Menu selected function: AutoMenu_2
        function AutoMenu_2Selected(app, event)
            logDAI('Auto Scaling for Post Lesion Curve Selected');
            app.pdPlotAreaStressOnly.YLim = [app.yAxisLimitMin app.yAxisLimitMax];
            app.pdPlotAreaStressOnly.YTick = getSliderTicks(app.yAxisLimitMin, app.yAxisLimitMax);

            app.ManualMenu_2.Checked = false;
            app.AutoMenu_2.Checked = true;
            logDAI('Auto Scaling for Post Lesion Curve Applied');
        end

        % Menu selected function: ManualMenu_2
        function ManualMenu_2Selected(app, event)
            logDAI('Manual Scaling for Post Lesion Curve Selected');
            prompt = {'Min Limit (HU)','Max Limit (HU)','Interval (HU)'};
            dlgtitle = 'Enter';
            dims = [1 35];
            definput = {'-50','500','10'};
            answer = inputdlg(prompt,dlgtitle,dims,definput);
            localYAxisLimitMin = str2double(answer{1});
            localYAxisLimitMax = str2double(answer{2});
            fixedInterval = str2double(answer{3});

            app.pdPlotAreaStressOnly.YLim = [localYAxisLimitMin localYAxisLimitMax];
            app.pdPlotAreaStressOnly.YTick = getSliderTicks(localYAxisLimitMin, localYAxisLimitMax, fixedInterval);

            figure(app.UIFigure);

            app.AutoMenu_2.Checked = false;
            app.ManualMenu_2.Checked = true;
            logDAI('Manual Scaling for Post Lesion Curve Applied');
        end

        % Menu selected function: AutoMenu_3
        function AutoMenu_3Selected(app, event)
            logDAI('Auto Scaling for Post Lesion Curve Selected');
            app.paPlotArea.YLim = [app.yAxisLimitMin app.yAxisLimitMax];
            interval = getPlotInterval(app.yAxisLimitMin, app.yAxisLimitMax);
            app.paPlotArea.YTick = [app.yAxisLimitMin:interval:app.yAxisLimitMax];

            app.ManualMenu_3.Checked = false;
            app.AutoMenu_3.Checked = true;
            logDAI('Auto Scaling for Post Lesion Curve Applied');
        end

        % Menu selected function: ManualMenu_3
        function ManualMenu_3Selected(app, event)
            logDAI('Manual Scaling for Post Lesion Curve Selected');
            prompt = {'Min Limit:','Max Limit:'};
            dlgtitle = 'Enter';
            dims = [1 35];
            definput = {'-50','500'};
            answer = inputdlg(prompt,dlgtitle,dims,definput);
            localYAxisLimitMin = str2double(answer{1});
            localYAxisLimitMax = str2double(answer{2});

            app.paPlotArea.YLim = [localYAxisLimitMin localYAxisLimitMax];
            interval = getPlotInterval(localYAxisLimitMin, localYAxisLimitMax);
            app.paPlotArea.YTick = [localYAxisLimitMin:interval:localYAxisLimitMax];

            figure(app.UIFigure);

            app.AutoMenu_3.Checked = false;
            app.ManualMenu_3.Checked = true;
            logDAI('Manual Scaling for Post Lesion Curve Applied');
        end

        % Menu selected function: AutoMenu_4
        function AutoMenu_4Selected(app, event)
            logDAI('Auto Scaling for Post Lesion Curve Selected');
            app.pdPlotArea.YLim = [app.yAxisLimitMin app.yAxisLimitMax];
            interval = getPlotInterval(app.yAxisLimitMin, app.yAxisLimitMax);
            app.pdPlotArea.YTick = [app.yAxisLimitMin:interval:app.yAxisLimitMax];

            app.ManualMenu_4.Checked = false;
            app.AutoMenu_4.Checked = true;
            logDAI('Auto Scaling for Post Lesion Curve Applied');
        end

        % Menu selected function: ManualMenu_4
        function ManualMenu_4Selected(app, event)
            logDAI('Manual Scaling for Post Lesion Curve Selected');
            prompt = {'Min Limit:','Max Limit:'};
            dlgtitle = 'Enter';
            dims = [1 35];
            definput = {'-50','500'};
            answer = inputdlg(prompt,dlgtitle,dims,definput);
            localYAxisLimitMin = str2double(answer{1});
            localYAxisLimitMax = str2double(answer{2});

            app.pdPlotArea.YLim = [localYAxisLimitMin localYAxisLimitMax];
            interval = getPlotInterval(localYAxisLimitMin, localYAxisLimitMax);
            app.pdPlotArea.YTick = [localYAxisLimitMin:interval:localYAxisLimitMax];

            figure(app.UIFigure);

            app.AutoMenu_4.Checked = false;
            app.ManualMenu_4.Checked = true;
            logDAI('Manual Scaling for Post Lesion Curve Applied');
        end

        % Menu selected function: SiemensMenu_3
        function SiemensMenu_3Selected(app, event)
            app.scannerTypeStressOnly = convertStringsToChars(app.scannerName(1));

            app.SiemensMenu_3.Checked = true;
            app.CanonMenu_3.Checked = false;
            app.GEMenu_3.Checked = false;

            StressImagesMenuLoader(app);
        end

        % Menu selected function: CanonMenu_3
        function CanonMenu_3Selected(app, event)
            app.scannerTypeStressOnly = convertStringsToChars(app.scannerName(2));

            app.SiemensMenu_3.Checked = false;
            app.CanonMenu_3.Checked = true;
            app.GEMenu_3.Checked = false;

            options = {'Enhanced', 'Standard'};
            dlgPrompt = 'Select image format:';
            dlgTitle = 'Canon image format selection';
            [idx,~] = listdlg('ListString', options, 'PromptString', dlgPrompt, 'SelectionMode', 'single', 'ListSize',[310,40], 'Name', dlgTitle);

            % Check the selected index
            if ~isempty(idx)
                choice = options{idx};
            else
                % Default is enhanced
                choice = options{1};
            end

            StressImagesMenuLoader(app, choice);
        end

        % Menu selected function: GEMenu_3
        function GEMenu_3Selected(app, event)
            app.scannerTypeStressOnly = convertStringsToChars(app.scannerName(3));

            app.SiemensMenu_3.Checked = false;
            app.CanonMenu_3.Checked = false;
            app.GEMenu_3.Checked = true;

            StressImagesMenuLoader(app);
        end

        % Menu selected function: SiemensMenu_4
        function SiemensMenu_4Selected(app, event)
            app.scannerType = convertStringsToChars(app.scannerName(1));

            app.SiemensMenu_4.Checked = true;
            app.CanonMenu_4.Checked = false;
            app.GEMenu_4.Checked = false;

            StreesImageLoaderInStressRestTab(app);
        end

        % Menu selected function: CanonMenu_4
        function CanonMenu_4Selected(app, event)
            app.scannerType = convertStringsToChars(app.scannerName(2));

            app.SiemensMenu_4.Checked = false;
            app.CanonMenu_4.Checked = true;
            app.GEMenu_4.Checked = false;

            StreesImageLoaderInStressRestTab(app);
        end

        % Menu selected function: GEMenu_4
        function GEMenu_4Selected(app, event)
            app.scannerType = convertStringsToChars(app.scannerName(3));

            app.SiemensMenu_4.Checked = false;
            app.CanonMenu_4.Checked = false;
            app.GEMenu_4.Checked = true;

            StreesImageLoaderInStressRestTab(app);
        end

        % Menu selected function: SiemensMenu_5
        function SiemensMenu_5Selected(app, event)
            app.scannerTypeRest = convertStringsToChars(app.scannerName(1));

            app.SiemensMenu_5.Checked = true;
            app.CanonMenu_5.Checked = false;
            app.GEMenu_5.Checked = false;

            RestImageLoaderInStressRestTab(app);
        end

        % Menu selected function: CanonMenu_5
        function CanonMenu_5Selected(app, event)
            app.scannerTypeRest = convertStringsToChars(app.scannerName(2));

            app.SiemensMenu_5.Checked = false;
            app.CanonMenu_5.Checked = true;
            app.GEMenu_5.Checked = false;

            RestImageLoaderInStressRestTab(app);
        end

        % Menu selected function: GEMenu_5
        function GEMenu_5Selected(app, event)
            app.scannerTypeRest = convertStringsToChars(app.scannerName(3));

            app.SiemensMenu_5.Checked = false;
            app.CanonMenu_5.Checked = false;
            app.GEMenu_5.Checked = true;

            RestImageLoaderInStressRestTab(app);
        end

        % Menu selected function: PalatinoLinotypeMenu
        function PalatinoLinotypeMenuSelected(app, event)
            app.fontName = 'Palatino Linotype';

            changeFontsTo(app, app.fontName);

            app.PalatinoLinotypeMenu.Checked = true;
            app.ArialMenu.Checked = false;
            app.TimesMenu.Checked = false;
        end

        % Callback function: RemoveLastPointButton, 
        % RemoveLastPointMenu
        function RemoveLastPointMenuSelected(app, event)
            pointType = app.supervisedLearningLabeledPoints{end};
            switch pointType
                case 'apex'
                    imgJPEG(:,:,:) = app.volumeJPEG(:,:,app.ptsApex(end-3),:);
                    originalPixelValue = app.ptsApex(end);
                    imgJPEG = getColoredPointForMarkedCoordinate(imgJPEG, app.ptsApex(end-2), app.ptsApex(end-1), [originalPixelValue, originalPixelValue, originalPixelValue]);
                    %imgJPEG(app.ptsApex(end-2), app.ptsApex(end-1)) = originalPixelValue;
                    app.volumeJPEG(:,:,app.ptsApex(end-3),:) = imgJPEG(:,:,:);
                    updateimage3DJPEG(app,imgJPEG);
                    app.ptsApex(end-3:end) = [];
                case 'lcx'
                    imgJPEG(:,:,:) = app.volumeJPEG(:,:,app.ptsLCx(end-3),:);
                    originalPixelValue = app.ptsLCx(end);
                    imgJPEG = getColoredPointForMarkedCoordinate(imgJPEG, app.ptsLCx(end-2), app.ptsLCx(end-1), [originalPixelValue, originalPixelValue, originalPixelValue]);
                    %imgJPEG(app.ptsLCx(end-2), app.ptsLCx(end-1)) = originalPixelValue;
                    app.volumeJPEG(:,:,app.ptsLCx(end-3),:) = imgJPEG(:,:,:);
                    updateimage3DJPEG(app,imgJPEG);
                    app.ptsLCx(end-3:end) = [];
                case 'lad'
                    imgJPEG(:,:,:) = app.volumeJPEG(:,:,app.ptsLAD(end-3),:);
                    originalPixelValue = app.ptsLAD(end);
                    imgJPEG = getColoredPointForMarkedCoordinate(imgJPEG, app.ptsLAD(end-2), app.ptsLAD(end-1), [originalPixelValue, originalPixelValue, originalPixelValue]);
                    %imgJPEG(app.ptsLAD(end-2), app.ptsLAD(end-1)) = originalPixelValue;
                    app.volumeJPEG(:,:,app.ptsLAD(end-3),:) = imgJPEG(:,:,:);
                    updateimage3DJPEG(app,imgJPEG);
                    app.ptsLAD(end-3:end) = [];
                case 'rca'
                    imgJPEG(:,:,:) = app.volumeJPEG(:,:,app.ptsRCA(end-3),:);
                    originalPixelValue = app.ptsRCA(end);
                    imgJPEG = getColoredPointForMarkedCoordinate(imgJPEG, app.ptsRCA(end-2), app.ptsRCA(end-1), [originalPixelValue, originalPixelValue, originalPixelValue]);
                    %imgJPEG(app.ptsRCA(end-2), app.ptsRCA(end-1)) = originalPixelValue;
                    app.volumeJPEG(:,:,app.ptsRCA(end-3),:) = imgJPEG(:,:,:);
                    updateimage3DJPEG(app,imgJPEG);
                    app.ptsRCA(end-3:end) = [];
            end
            app.supervisedLearningLabeledPoints(end) = [];
        end

        % Button pushed function: FitCurvesButtonStressOnly_2
        function FitCurvesButtonStressOnly_2Pushed(app, event)
            choice = questdlg('Which curve to fit?', 'Curve Fitting', 'Post-lesion curve','Lesion exit curve','');
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);
            switch choice
                case 'Post-lesion curve'
                    if isrow(app.pdCurveStressOnly)
                        app.pdCurveStressOnly = app.pdCurveStressOnly';
                    end

                    if isnan(str2double(app.ManualBaselineInputStressOnly_2.Value))
                        manualBaselineValuePostLesion = 0;
                    else
                        manualBaselineValuePostLesion = str2double(app.ManualBaselineInputStressOnly_2.Value);
                    end
                    if isnan(str2double(app.ManualWashoutInputStressOnly_2.Value))
                        manualWashoutValuePostLesion = 0;
                    else
                        manualWashoutValuePostLesion = str2double(app.ManualWashoutInputStressOnly_2.Value);
                    end

                    try
                        [app.fittedCurvePdStressOnly, app.fittedTimePdStressOnly, app.pdCurveStressOnly, app.rmseBStressOnly, app.kBStressOnly, app.alphaBStressOnly, app.betaBStressOnly] = getFittedCurve(app.pdCurveStressOnly, app.plotXPostStressOnly, manualBaselineValuePostLesion, manualWashoutValuePostLesion);
                        app.aucBStressOnly = getAreaUnderCurve(app.fittedCurvePdStressOnly, app.fittedTimePdStressOnly);

                        drawPostLesionCurveStressOnly(app);

                        app.pdStressOnly = [app.roiObjectStressOnly.postRoiObject.curveData.z, app.roiObjectStressOnly.postRoiObject.curveData.t, app.roiObjectStressOnly.postRoiObject.curveData.x, app.roiObjectStressOnly.postRoiObject.curveData.y];
                        app.postRoiObjectStressOnly = getROI(app.dicomInfoStressOnly.PatientName.FamilyName, size(app.fourDImageSetStressOnly,2), size(app.fourDImageSetStressOnly,1), app.pdStressOnly(3), app.pdStressOnly(4), app.pdStressOnly(1), app.pdStressOnly(2), app.pdCurveStressOnly, app.pdTimePointsStressOnly, app.fittedCurvePdStressOnly, app.fittedTimePdStressOnly, app.sxPostStressOnly, app.syPostStressOnly, app.aucBStressOnly, app.allExtraPointsForDistanceInStressOnly, app.numberOfStenosis, 0, 0, 0, 0, 0);
                        app.roiObjectStressOnly.postRoiObject = app.postRoiObjectStressOnly;
                        saveRoiAsJson(app.roiObjectStressOnly);

                    catch ME
                        msg = strcat('Problem in Curve Fitting:', ME.message);
                        errordlg(msg);
                        pause(5);
                        set(gcf, 'Pointer','arrow');
                    end
                case 'Lesion exit curve'
                    if isrow(app.exitCurveStressOnly)
                        app.exitCurveStressOnly = app.exitCurveStressOnly';
                    end

                    if isnan(str2double(app.ManualBaselineInputStressOnly_2.Value))
                        manualBaselineValuePostLesion = 0;
                    else
                        manualBaselineValuePostLesion = str2double(app.ManualBaselineInputStressOnly_2.Value);
                    end
                    if isnan(str2double(app.ManualWashoutInputStressOnly_2.Value))
                        manualWashoutValuePostLesion = 0;
                    else
                        manualWashoutValuePostLesion = str2double(app.ManualWashoutInputStressOnly_2.Value);
                    end

                    try
                        [app.fittedCurveExitStressOnly, app.fittedTimeExitStressOnly, app.exitCurveStressOnly, app.rmseBStressOnly, app.kBStressOnly, app.alphaBStressOnly, app.betaBStressOnly] = getFittedCurve(app.exitCurveStressOnly, app.plotXExitStressOnly, manualBaselineValuePostLesion, manualWashoutValuePostLesion);
                        app.aucBExitStressOnly(app.currentStenosisID) = getAreaUnderCurve(app.fittedCurveExitStressOnly, app.fittedTimeExitStressOnly);
                        %                         if (isempty(app.ConversionFactorEditFieldStressOnly.Value) == false)
                        %                             app.aucBExitStressOnly(end) = app.aucBExitStressOnly(end) / str2double(app.ConversionFactorEditFieldStressOnly.Value);
                        %                         end

                        drawExitCurveStressOnly(app);

                        if (app.currentStenosisNumber == -1)
                            app.pExitStressOnly = [app.roiObjectStressOnly.exitRoiObject.curveData.z, app.roiObjectStressOnly.exitRoiObject.curveData.t, app.roiObjectStressOnly.exitRoiObject.curveData.x, app.roiObjectStressOnly.exitRoiObject.curveData.y];
                            app.exitRoiObjectStressOnly = getROI(app.dicomInfoStressOnly.PatientName.FamilyName, size(app.fourDImageSetStressOnly,2), size(app.fourDImageSetStressOnly,1), app.pExitStressOnly(3), app.pExitStressOnly(4), app.pExitStressOnly(1), app.pExitStressOnly(2), app.exitCurveStressOnly, app.exitTimePointStressOnly, app.fittedCurveExitStressOnly, app.fittedTimeExitStressOnly, app.exitSxStressOnly, app.exitSyStressOnly, app.aucBExitStressOnly(end), 0, app.numberOfStenosis, app.rs1(end), app.rs2(end), app.rs3(end), app.entryQ(end), app.exitQ(end));
                            app.roiObjectStressOnly.exitRoiObject = app.exitRoiObjectStressOnly;
                        else
                            app.pExitStressOnly = [app.roiObjectStressOnly.exitRoiObject(app.currentStenosisNumber).curveData.z, app.roiObjectStressOnly.exitRoiObject(app.currentStenosisNumber).curveData.t, app.roiObjectStressOnly.exitRoiObject(app.currentStenosisNumber).curveData.x, app.roiObjectStressOnly.exitRoiObject(app.currentStenosisNumber).curveData.y];
                            app.exitRoiObjectStressOnly = getROI(app.dicomInfoStressOnly.PatientName.FamilyName, size(app.fourDImageSetStressOnly,2), size(app.fourDImageSetStressOnly,1), app.pExitStressOnly(3), app.pExitStressOnly(4), app.pExitStressOnly(1), app.pExitStressOnly(2), app.exitCurveStressOnly, app.exitTimePointStressOnly, app.fittedCurveExitStressOnly, app.fittedTimeExitStressOnly, app.exitSxStressOnly, app.exitSyStressOnly, app.aucBExitStressOnly(end), 0, app.numberOfStenosis, app.rs1(end), app.rs2(end), app.rs3(end), app.entryQ(end), app.exitQ(end));
                            app.roiObjectStressOnly.exitRoiObject(app.currentStenosisNumber) = app.exitRoiObjectStressOnly;
                            app.currentStenosisNumber = -1;
                        end
                        saveRoiAsJson(app.roiObjectStressOnly);

                    catch ME
                        msg = strcat('Problem in Curve Fitting:', ME.message);
                        errordlg(msg);
                        pause(5);
                        set(gcf, 'Pointer','arrow');
                    end
            end
            set(gcf, 'Pointer','arrow');
        end

        % Button pushed function: FitStressCurveButton_2
        function FitStressCurveButton_2Pushed(app, event)
            % This function now handles only post-lesion cases:

            if isrow(app.paCurve)
                app.paCurve = app.paCurve';
            end
            app.manualBaselineValue = str2double(app.ManualBaselineInput_2.Value);
            app.manualWashoutValue = str2double(app.ManualWashoutInput_2.Value);
            if isnan(app.manualBaselineValue)
                app.manualBaselineValue = 0;
            else
                app.manualBaselineValue = str2double(app.ManualBaselineInput_2.Value);
            end
            if isnan(app.manualWashoutValue)
                app.manualWashoutValue = 0;
            else
                app.manualWashoutValue = str2double(app.ManualWashoutInput_2.Value);
            end
            manualBaselineValuePostLesion = app.manualBaselineValue;
            manualWashoutValuePostLesion = app.manualWashoutValue;

            if isrow(app.pdCurve)
                app.pdCurve = app.pdCurve';
            end

            try
                [app.fittedCurvePd, app.fittedTimePd, app.pdCurve, app.rmseB, app.kB, app.alphaB, app.betaB] = getFittedCurve(app.pdCurve, app.plotX, manualBaselineValuePostLesion, manualWashoutValuePostLesion);
                app.aucB = getAreaUnderCurve(app.fittedCurvePd, app.fittedTimePd);

                % Strees Pre and Strees Post
                if (strcmp(app.viewMode,'Dark'))
                    if (~all(app.fittedCurvePa) == 0)
                        plot(app.paPlotArea, app.plotX, app.paCurve, 'yo', app.fittedTimePa, app.fittedCurvePa, 'y-');
                        legend(app.paPlotArea,'Pre-Lesion Sampled','Pre-Lesion Fitted', 'TextColor','white');
                    end
                    plot(app.pdPlotArea, app.plotX, app.pdCurve, 'yo', app.fittedTimePd, app.fittedCurvePd, 'y-');
                    legend(app.pdPlotArea,'Post-Lesion Sampled','Post-Lesion Fitted', 'TextColor','white');

                    if(~isempty(app.paCurveRest))
                        if(~isempty(app.fittedCurvePaRest))
                            plot(app.paPlotArea, app.plotX, app.paCurve, 'yo', app.fittedTimePa, app.fittedCurvePa, 'y-', app.plotXRest, app.paCurveRest, 'ws', app.fittedTimePaRest, app.fittedCurvePaRest, 'w-');
                            legend(app.paPlotArea,'Pre-Lesion Sampled','Pre-Lesion Fitted','Pre-Rest','Pre-Rest-Fitted', 'TextColor','white');
                        else
                            plot(app.paPlotArea, app.plotX, app.paCurve, 'yo', app.fittedTimePa, app.fittedCurvePa, 'y-', app.plotXRest, app.paCurveRest, 'ws');
                            legend(app.paPlotArea,'Pre-Lesion Sampled','Pre-Lesion Fitted','Pre-Rest', 'TextColor','white');
                        end
                    end

                    if(~isempty(app.pdCurveRest))
                        if(~isempty(app.fittedCurvePdRest))
                            plot(app.pdPlotArea, app.plotX, app.pdCurve, 'yo', app.fittedTimePd, app.fittedCurvePd, 'y-', app.plotXRest, app.pdCurveRest, 'ws', app.fittedTimePdRest, app.fittedCurvePdRest, 'w-');
                            legend(app.pdPlotArea,'Post-Lesion Sampled','Post-Lesion Fitted','Post-Rest','Post-Rest-Fitted', 'TextColor','white');
                        else
                            plot(app.pdPlotArea, app.plotX, app.pdCurve, 'yo', app.fittedTimePd, app.fittedCurvePd, 'y-', app.plotXRest, app.pdCurveRest, 'ws');
                            legend(app.pdPlotArea,'Post-Lesion Sampled','Post-Lesion Fitted','Post-Rest', 'TextColor','white');
                        end
                    end
                else
                    if (~all(app.fittedCurvePa) == 0)
                        plot(app.paPlotArea, app.plotX, app.paCurve, 'mo', app.fittedTimePa, app.fittedCurvePa, 'm-');
                        legend(app.paPlotArea,'Pre-Lesion Sampled','Pre-Lesion Fitted', 'TextColor','black');
                    end
                    plot(app.pdPlotArea, app.plotX, app.pdCurve, 'mo', app.fittedTimePd, app.fittedCurvePd, 'm-');
                    legend(app.pdPlotArea,'Post-Lesion Sampled','Post-Lesion Fitted', 'TextColor','black');

                    if(~isempty(app.paCurveRest))
                        if(~isempty(app.fittedCurvePaRest))
                            plot(app.paPlotArea, app.plotX, app.paCurve, 'mo', app.fittedTimePa, app.fittedCurvePa, 'm-', app.plotXRest, app.paCurveRest, 'bs', app.fittedTimePaRest, app.fittedCurvePaRest, 'b-');
                            legend(app.paPlotArea,'Pre-Lesion Sampled','Pre-Lesion Fitted','Pre-Rest','Pre-Rest-Fitted', 'TextColor','black');
                        else
                            plot(app.paPlotArea, app.plotX, app.paCurve, 'mo', app.fittedTimePa, app.fittedCurvePa, 'm-', app.plotXRest, app.paCurveRest, 'bs');
                            legend(app.paPlotArea,'Pre-Lesion Sampled','Pre-Lesion Fitted','Pre-Rest', 'TextColor','black');
                        end
                    end

                    if(~isempty(app.pdCurveRest))
                        if(~isempty(app.fittedCurvePdRest))
                            plot(app.pdPlotArea, app.plotX, app.pdCurve, 'mo', app.fittedTimePd, app.fittedCurvePd, 'm-', app.plotXRest, app.pdCurveRest, 'bs', app.fittedTimePdRest, app.fittedCurvePdRest, 'b-');
                            legend(app.pdPlotArea,'Post-Lesion Sampled','Post-Lesion Fitted','Post-Rest','Post-Rest-Fitted', 'TextColor','black');
                        else
                            plot(app.pdPlotArea, app.plotX, app.pdCurve, 'mo', app.fittedTimePd, app.fittedCurvePd, 'm-', app.plotXRest, app.pdCurveRest, 'bs');
                            legend(app.pdPlotArea,'Post-Lesion Sampled','Post-Lesion Fitted','Post-Rest', 'TextColor','black');
                        end
                    end
                end
            catch ME
                msg = strcat('Problem in Curve Fitting:', ME.message);
                errordlg(msg);
            end
        end

        % Button pushed function: FitCurvesButtonRest_2
        function FitCurvesButtonRest_2Pushed(app, event)
            % This function now handles only post-lesion cases:

            if isrow(app.paCurveRest)
                app.paCurveRest = app.paCurveRest';
            end
            app.manualBaselineValueRest = str2double(app.ManualBaselineInputRest_2.Value);
            app.manualWashoutValueRest = str2double(app.ManualWashoutInputRest_2.Value);
            if isnan(app.manualBaselineValueRest)
                app.manualBaselineValueRest = 0;
            else
                app.manualBaselineValueRest = str2double(app.ManualBaselineInputRest_2.Value);
            end
            if isnan(app.manualWashoutValueRest)
                app.manualWashoutValueRest = 0;
            else
                app.manualWashoutValueRest = str2double(app.ManualWashoutInputRest_2.Value);
            end
            manualBaselineValuePostLesionRest = app.manualBaselineValueRest;
            manualWashoutValuePostLesionRest = app.manualBaselineValueRest;

            if isrow(app.pdCurveRest)
                app.pdCurveRest = app.pdCurveRest';
            end

            try
                [app.fittedCurvePdRest, app.fittedTimePdRest, app.pdCurveRest, app.rmseBRest, app.kBRest, app.alphaBRest, app.betaBRest] = getFittedCurve(app.pdCurveRest, app.plotXRest, manualBaselineValuePostLesionRest, manualWashoutValuePostLesionRest);
                app.aucBRest = getAreaUnderCurve(app.fittedCurvePdRest, app.fittedTimePdRest);

                % Rest Pre and Rest Post
                if (strcmp(app.viewMode,'Dark'))
                    if (~all(app.fittedCurvePaRest) == 0)
                        plot(app.paPlotArea, app.plotXRest, app.paCurveRest, 'ws', app.fittedTimePaRest, app.fittedCurvePaRest, 'w-');
                        legend(app.paPlotArea,'Pre-Rest','Pre-Rest-Fitted', 'TextColor','white');
                    end
                    plot(app.pdPlotArea, app.plotXRest, app.pdCurveRest, 'ws', app.fittedTimePdRest, app.fittedCurvePdRest, 'w-');
                    legend(app.pdPlotArea,'Post-Rest','Post-Rest-Fitted', 'TextColor','white');

                    if(~isempty(app.paCurve))
                        if(~isempty(app.fittedCurvePa))
                            plot(app.paPlotArea, app.plotX, app.paCurve, 'yo', app.fittedTimePa, app.fittedCurvePa, 'y-', app.plotXRest, app.paCurveRest, 'ws', app.fittedTimePaRest, app.fittedCurvePaRest, 'w-');
                            legend(app.paPlotArea,'Pre-Lesion Sampled', 'Pre-Lesion Fitted', 'Pre-Rest','Pre-Rest-Fitted', 'TextColor','white');
                        else
                            plot(app.paPlotArea, app.plotX, app.paCurve, 'yo', app.plotXRest, app.paCurveRest, 'ws', app.fittedTimePaRest, app.fittedCurvePaRest, 'w-');
                            legend(app.paPlotArea,'Pre-Lesion Sampled','Pre-Rest','Pre-Rest-Fitted', 'TextColor','white');
                        end
                    end

                    if(~isempty(app.pdCurve))
                        if(~isempty(app.fittedCurvePd))
                            plot(app.pdPlotArea, app.plotX, app.pdCurve, 'yo', app.fittedTimePd, app.fittedCurvePd, 'y-', app.plotXRest, app.pdCurveRest, 'ws', app.fittedTimePdRest, app.fittedCurvePdRest, 'w-');
                            legend(app.pdPlotArea,'Post-Lesion Sampled','Post-Lesion Fitted', 'Post-Rest', 'Post-Rest-Fitted', 'TextColor','white');
                        else
                            plot(app.pdPlotArea, app.plotX, app.pdCurve, 'yo', app.plotXRest, app.pdCurveRest, 'ws', app.fittedTimePdRest, app.fittedCurvePdRest, 'w-');
                            legend(app.pdPlotArea,'Post-Lesion Sampled','Post-Rest','Post-Rest-Fitted', 'TextColor','white');
                        end
                    end
                else
                    if (~all(app.fittedCurvePaRest) == 0)
                        plot(app.paPlotArea, app.plotXRest, app.paCurveRest, 'bs', app.fittedTimePaRest, app.fittedCurvePaRest, 'b-');
                        legend(app.paPlotArea,'Pre-Rest','Pre-Rest-Fitted', 'TextColor','black');
                    end
                    plot(app.pdPlotArea, app.plotXRest, app.pdCurveRest, 'bs', app.fittedTimePdRest, app.fittedCurvePdRest, 'b-');
                    legend(app.pdPlotArea,'Post-Rest','Post-Rest-Fitted', 'TextColor','black');

                    if(~isempty(app.paCurve))
                        if(~isempty(app.fittedCurvePa))
                            plot(app.paPlotArea, app.plotX, app.paCurve, 'mo', app.fittedTimePa, app.fittedCurvePa, 'm-', app.plotXRest, app.paCurveRest, 'bs', app.fittedTimePaRest, app.fittedCurvePaRest, 'b-');
                            legend(app.paPlotArea,'Pre-Lesion Sampled', 'Pre-Lesion Fitted', 'Pre-Rest','Pre-Rest-Fitted', 'TextColor','black');
                        else
                            plot(app.paPlotArea, app.plotX, app.paCurve, 'mo', app.plotXRest, app.paCurveRest, 'bs', app.fittedTimePaRest, app.fittedCurvePaRest, 'b-');
                            legend(app.paPlotArea,'Pre-Lesion Sampled','Pre-Rest','Pre-Rest-Fitted', 'TextColor','black');
                        end
                    end

                    if(~isempty(app.pdCurve))
                        if(~isempty(app.fittedCurvePd))
                            plot(app.pdPlotArea, app.plotX, app.pdCurve, 'mo', app.fittedTimePd, app.fittedCurvePd, 'm-', app.plotXRest, app.pdCurveRest, 'bs', app.fittedTimePdRest, app.fittedCurvePdRest, 'b-');
                            legend(app.pdPlotArea,'Post-Lesion Sampled','Post-Lesion Fitted', 'Post-Rest', 'Post-Rest-Fitted', 'TextColor','black');
                        else
                            plot(app.pdPlotArea, app.plotX, app.pdCurve, 'mo', app.plotXRest, app.pdCurveRest, 'bs', app.fittedTimePdRest, app.fittedCurvePdRest, 'b-');
                            legend(app.pdPlotArea,'Post-Lesion Sampled','Post-Rest','Post-Rest-Fitted', 'TextColor','black');
                        end
                    end
                end
            catch ME
                msg = strcat('Problem in Curve Fitting:', ME.message);
                errordlg(msg);
            end
        end

        % Value changed function: MarkStenosisCheckBox
        function MarkStenosisCheckBoxValueChanged(app, event)
            value = app.MarkStenosisCheckBox.Value;
            app.entryQ = [];
            app.exitQ = [];
            app.entrySliceLocations = [];
            app.exitSliceLocations = [];
            app.stenosisPercentage = [];
            app.aucAEntryStressOnly = [];
            app.aucBExitStressOnly = [];

            if (value == 1)
                app.stenosisGuiData = STENOSISGUI(app);
                app.stenosisGuiData.addlistener('AppClosedEvent', @app.onStenosisGuiClosed);
            else
                app.stenosisGuiData.delete();
                app.numberOfStenosis = 0;

                app.entryCurveStressOnly = [];
                app.fittedCurveEntryStressOnly = [];
                app.exitCurveStressOnly = [];
                app.fittedCurveExitStressOnly = [];
                plotIDsToRemove = find(app.checkedStenosis);
                for i = 1:max(size(plotIDsToRemove))
                    app.plotIDsToRemoveFromPlotArea(end+1) = plotIDsToRemove(i) * 2 + 1;
                    app.plotIDsToRemoveFromPlotArea(end+1) = plotIDsToRemove(i) * 2 + 2;
                end
                app.plotIDsToRemoveFromPlotArea = unique(app.plotIDsToRemoveFromPlotArea);
                showPlot(app);
            end
        end

        % Button pushed function: ClearButton
        function ClearButtonPushed(app, event)
            cla(app.FFRVsSliceLocation, 'reset');
            app.allFFRStressOnlySliceLocations = [];
            app.allFFRStressOnly = [];
            app.allFlowVelocitiesSliceLocationsStressOnly = [];
            app.allFlowVelocitiesStressOnly = [];
        end

        % Button pushed function: ClearButton_2
        function ClearButton_2Pushed(app, event)
            legend(app.paPlotAreaStressOnly, 'hide');
            cla(app.paPlotAreaStressOnly);

            app.plotXPreStressOnly = [];
            app.paCurveStressOnly = [];
            app.fittedTimePaStressOnly = [];
            app.fittedCurvePaStressOnly = [];
            app.entryCurveStressOnly = [];
            app.fittedTimeEntryStressOnly = [];
            app.fittedCurveEntryStressOnly = [];
            app.plotXEntryStressOnly = [];
            app.plotData.pre = [];
        end

        % Button pushed function: ClearButton_3
        function ClearButton_3Pushed(app, event)
            legend(app.pdPlotAreaStressOnly, 'hide');
            cla(app.pdPlotAreaStressOnly);

            app.plotXPostStressOnly = [];
            app.pdCurveStressOnly = [];
            app.fittedTimePdStressOnly = [];
            app.fittedCurvePdStressOnly = [];
            app.exitCurveStressOnly = [];
            app.fittedTimeExitStressOnly = [];
            app.fittedCurveExitStressOnly = [];
            app.plotXExitStressOnly = [];
            app.plotData.post = [];
        end

        % Menu selected function: SampleROIMenu
        function SampleROIMenuSelected(app, event)
            filterspec = {'*.json','JSON Files'};
            [f, p] = uigetfile(filterspec);
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);
            set(gcf, 'Pointer','arrow');
            [~, name, ext] = fileparts(f);
            app.roiObjectStressOnly = loadRoiFromJson(p, f);

            if (isfield(app.roiObjectStressOnly, 'preRoiObject'))
                % Update Slice Axis
                app.currentSliceStressOnly = app.roiObjectStressOnly.preRoiObject.curveData.z;
                app.paCurrentTimePointStressOnly = app.roiObjectStressOnly.preRoiObject.curveData.t;
                app.SlicesSliderStressOnly.Value = app.roiObjectStressOnly.preRoiObject.curveData.z;
                event = struct('Value', app.roiObjectStressOnly.preRoiObject.curveData.z, 'PreviousValue', 0);
                SlicesSliderStressOnlyValueChanging(app, event);
                app.SlicesSliderStressOnlyLabel.Text = sprintf('Slice %d/%d', app.roiObjectStressOnly.preRoiObject.curveData.z, size(app.fourDImageSetStressOnly, 1));

                % Update Image
                imageData(1:512, 1:512) = app.fourDImageSetStressOnly(app.roiObjectStressOnly.preRoiObject.curveData.z, app.roiObjectStressOnly.preRoiObject.curveData.t, 1:512, 1:512);
                imageWithContour = getROIOverlayed(imageData, app.roiObjectStressOnly.preRoiObject.curveData.roiPoints.x, app.roiObjectStressOnly.preRoiObject.curveData.roiPoints.y);
                updateimageStressOnly(app,imageWithContour);
            end

            % Get ROI and Draw Plot
            if (isfield(app.roiObjectStressOnly, 'preRoiObject'))
                app.plotXPreStressOnly = app.roiObjectStressOnly.preRoiObject.curveData.timePoints;
                app.paCurveStressOnly = app.roiObjectStressOnly.preRoiObject.curveData.curve;
                app.fittedCurvePaStressOnly = app.roiObjectStressOnly.preRoiObject.curveData.FittedCurve;
                app.fittedTimePaStressOnly = app.roiObjectStressOnly.preRoiObject.curveData.FittedTimePoints;
                app.aucAStressOnly = app.roiObjectStressOnly.preRoiObject.curveData.FittedCurveAUC;
                app.paStressOnly = [app.roiObjectStressOnly.preRoiObject.curveData.z, app.roiObjectStressOnly.preRoiObject.curveData.t, app.roiObjectStressOnly.preRoiObject.curveData.x, app.roiObjectStressOnly.preRoiObject.curveData.y];
                app.allExtraPointsForDistanceInStressOnly = app.roiObjectStressOnly.preRoiObject.ExtraPointsForDistanceBreaker;
                app.numberOfStenosis = app.roiObjectStressOnly.preRoiObject.NumberOfStenosis;
                drawEntryCurveStressOnly(app);
            end
            if (isfield(app.roiObjectStressOnly, 'postRoiObject'))
                app.plotXPostStressOnly = app.roiObjectStressOnly.postRoiObject.curveData.timePoints;
                app.pdCurveStressOnly = app.roiObjectStressOnly.postRoiObject.curveData.curve;
                app.fittedCurvePdStressOnly = app.roiObjectStressOnly.postRoiObject.curveData.FittedCurve;
                app.fittedTimePdStressOnly = app.roiObjectStressOnly.postRoiObject.curveData.FittedTimePoints;
                app.aucBStressOnly = app.roiObjectStressOnly.postRoiObject.curveData.FittedCurveAUC;
                app.pdStressOnly = [app.roiObjectStressOnly.postRoiObject.curveData.z, app.roiObjectStressOnly.postRoiObject.curveData.t, app.roiObjectStressOnly.postRoiObject.curveData.x, app.roiObjectStressOnly.postRoiObject.curveData.y];
                app.allExtraPointsForDistanceInStressOnly = app.roiObjectStressOnly.postRoiObject.ExtraPointsForDistanceBreaker;
                app.numberOfStenosis = app.roiObjectStressOnly.postRoiObject.NumberOfStenosis;
                drawExitCurveStressOnly(app);
            end
            if (isfield(app.roiObjectStressOnly, 'entryRoiObject'))

                totalElementsInEntryROIObject = max(size(app.roiObjectStressOnly.entryRoiObject));
                for i = 1:totalElementsInEntryROIObject
                    app.plotXEntryStressOnly = app.roiObjectStressOnly.entryRoiObject(i).curveData.timePoints;
                    app.entryCurveStressOnly = app.roiObjectStressOnly.entryRoiObject(i).curveData.curve;
                    app.fittedCurveEntryStressOnly = app.roiObjectStressOnly.entryRoiObject(i).curveData.FittedCurve;
                    app.fittedTimeEntryStressOnly = app.roiObjectStressOnly.entryRoiObject(i).curveData.FittedTimePoints;
                    app.numberOfStenosis = app.roiObjectStressOnly.entryRoiObject(i).NumberOfStenosis;
                    app.aucAEntryStressOnly(i) = app.roiObjectStressOnly.entryRoiObject(i).curveData.FittedCurveAUC;
                    app.rs1(i) = app.roiObjectStressOnly.entryRoiObject(i).Radii.rs1;
                    app.rs2(i) = app.roiObjectStressOnly.entryRoiObject(i).Radii.rs2;
                    app.rs3(i) = app.roiObjectStressOnly.entryRoiObject(i).Radii.rs3;
                    app.entryQ(i) = app.roiObjectStressOnly.entryRoiObject(i).Q.entryQ;
                end
                drawEntryCurveStressOnly(app);
            end
            if (isfield(app.roiObjectStressOnly, 'exitRoiObject'))

                totalElementsInExitROIObject = max(size(app.roiObjectStressOnly.exitRoiObject));
                for i = 1:totalElementsInExitROIObject
                    app.plotXExitStressOnly = app.roiObjectStressOnly.exitRoiObject(i).curveData.timePoints;
                    app.exitCurveStressOnly = app.roiObjectStressOnly.exitRoiObject(i).curveData.curve;
                    app.fittedCurveExitStressOnly = app.roiObjectStressOnly.exitRoiObject(i).curveData.FittedCurve;
                    app.fittedTimeExitStressOnly = app.roiObjectStressOnly.exitRoiObject(i).curveData.FittedTimePoints;
                    app.numberOfStenosis = app.roiObjectStressOnly.exitRoiObject(i).NumberOfStenosis;
                    app.aucBExitStressOnly(i) = app.roiObjectStressOnly.exitRoiObject(i).curveData.FittedCurveAUC;
                    app.exitQ(i) = app.roiObjectStressOnly.exitRoiObject(i).Q.exitQ;
                end
                drawExitCurveStressOnly(app);
            end
        end

        % Value changed function: EditPointCheckBox
        function EditPointCheckBoxValueChanged(app, event)
            value = app.EditPointCheckBox.Value;
            if(value == 1)
                if (isVectorEmptyOrZero(app.entryCurveStressOnly))
                    % If pre-sampled curve is drawn, then update point.
                    if (~isVectorEmptyOrZero(app.paCurveStressOnly))

                        if (app.paPlotAreaPointModifyCounter < 3)

                            app.HUTextArea.Visible = true;
                            set(app.UIFigure, 'WindowButtonMotionFcn', @(src, event) updateCoordinates(app, 'pre'));
                            roi = drawpoint(app.paPlotAreaStressOnly);
                            app.HUTextArea.Visible = false;

                            data = app.xDataPreStressOnly;
                            distance = round(data - roi.Position(1));
                            idx = find(distance == 0);

                            dataArray = app.paCurveStressOnly;
                            dataArray(idx) = roi.Position(2);
                            app.paCurveStressOnly = dataArray;

                            app.paPlotAreaPointModifyCounter = app.paPlotAreaPointModifyCounter + 1;

                            drawPreLesionCurveStressOnly(app);
                        else
                            warningMessage = sprintf('maximum number of HU Correction supported is %d.', app.maxHUCorrectionSupported);
                            waitfor(warndlg(warningMessage, 'HU Correction info'));
                        end
                    end
                else
                    prompt = {'Stenosis # (1-5):','Point #:','New HU Value:'};
                    dlgtitle = 'Edit Point';
                    dims = [1 35];
                    definput = {'1','1','50'};
                    answer = inputdlg(prompt,dlgtitle,dims,definput);
                    stenosisID = str2double(answer{1});
                    pointNumber = str2double(answer{2});
                    newHUValue = str2double(answer{3});
                    figure(app.UIFigure);

                    tempStenosisID = app.currentStenosisID;
                    tempStenosisNumber = app.currentStenosisNumber;
                    app.currentStenosisID = stenosisID;
                    app.currentStenosisNumber = stenosisID;
                    app.entryCurveStressOnly = app.roiObjectStressOnly.entryRoiObject(stenosisID).curveData.curve;
                    app.entryCurveStressOnly(pointNumber) = newHUValue;
                    drawEntryCurveStressOnly(app);
                    app.currentStenosisID = tempStenosisID;
                    app.currentStenosisNumber = tempStenosisNumber;
                end
                app.EditPointCheckBox.Value = 0;
            end

        end

        % Value changed function: EditPointCheckBox_2
        function EditPointCheckBox_2ValueChanged(app, event)
            value = app.EditPointCheckBox_2.Value;
            if(value == 1)
                if (isVectorEmptyOrZero(app.exitCurveStressOnly))
                    % If pre-sampled curve is drawn, then update point.
                    if (~isVectorEmptyOrZero(app.pdCurveStressOnly))

                        if (app.pdPlotAreaPointModifyCounter < 3)

                            app.HUTextArea_2.Visible = true;
                            set(app.UIFigure, 'WindowButtonMotionFcn', @(src, event) updateCoordinates(app, 'post'));
                            roi = drawpoint(app.pdPlotAreaStressOnly);
                            app.HUTextArea_2.Visible = false;

                            data = app.xDataPostStressOnly;
                            distance = round(data - roi.Position(1));
                            idx = find(distance == 0);

                            dataArray = app.pdCurveStressOnly;
                            dataArray(idx) = roi.Position(2);
                            app.pdCurveStressOnly = dataArray;

                            app.pdPlotAreaPointModifyCounter = app.pdPlotAreaPointModifyCounter + 1;

                            drawPostLesionCurveStressOnly(app);
                        else
                            warningMessage = sprintf('maximum number of HU Correction supported is %d.', app.maxHUCorrectionSupported);
                            waitfor(warndlg(warningMessage, 'HU Correction info'));
                        end
                    end
                else
                    prompt = {'Stenosis # (1-5):','Point #:','New HU Value:'};
                    dlgtitle = 'Edit Point';
                    dims = [1 35];
                    definput = {'1','1','50'};
                    answer = inputdlg(prompt,dlgtitle,dims,definput);
                    stenosisID = str2double(answer{1});
                    pointNumber = str2double(answer{2});
                    newHUValue = str2double(answer{3});
                    figure(app.UIFigure);

                    tempStenosisID = app.currentStenosisID;
                    tempStenosisNumber = app.currentStenosisNumber;
                    app.currentStenosisID = stenosisID;
                    app.currentStenosisNumber = stenosisID;
                    app.exitCurveStressOnly = app.roiObjectStressOnly.exitRoiObject(stenosisID).curveData.curve;
                    app.exitCurveStressOnly(pointNumber) = newHUValue;
                    drawExitCurveStressOnly(app);
                    app.currentStenosisID = tempStenosisID;
                    app.currentStenosisNumber = tempStenosisNumber;
                end
                app.EditPointCheckBox_2.Value = 0;
            end
        end

        % Menu selected function: CTAImagesMenu_2
        function CTAImagesMenu_2Selected(app, event)
            set(gcf, 'Pointer','watch');
            drawnow;
            figure(app.UIFigure);

            writeRegularDicomVolumeFromEnhancedCTA(app.ctaVolume, app.ctaInfo);

            set(gcf, 'Pointer','arrow');

        end

        % Menu selected function: CTPTimeInfoMenu
        function CTPTimeInfoMenuSelected(app, event)
            % Display uigetfile dialog
            p = uigetdir;
            if (p == 0)
                % Do Nothing
                figure(app.UIFigure);
            else
                set(gcf, 'Pointer','watch');
                drawnow;
                figure(app.UIFigure);
                try
                    [uniqueAcquisitionTime, uniqueContentTime] = readTimeInfoOnlyFromCTPImages(p);
                    saveTimeInfo(uniqueAcquisitionTime, uniqueContentTime);
                    set(gcf, 'Pointer','arrow');
                catch ME
                    set(gcf, 'Pointer','arrow');
                    msg = strcat('The DAI did not fail, there seems to be an issue with this dataset in particular: ', ME.message);
                    errordlg(msg);
                end
            end
        end

        % Menu selected function: ApplyCTPTimeInfoMenu
        function ApplyCTPTimeInfoMenuSelected(app, event)
            callCustomInputDialog();
        end

        % Value changed function: MarkBreakerCheckBox
        function MarkBreakerCheckBoxValueChanged(app, event)
            value = app.MarkBreakerCheckBox.Value;
            if (value == 1)
                app.breakerGuiData = BREAKERGUI(app);
                app.breakerGuiData.addlistener('AppClosedEvent', @app.onBreakerGuiClosed);
            else
                app.breakerGuiData.delete();
                app.MarkBreakerCheckBox.Value = false;
            end
        end

        % Menu selected function: SetYaxisMaxMenu
        function SetYaxisMaxMenuSelected(app, event)
            prompt = {'Max HU:'};
            dlgtitle = 'Set Y-axis Max';
            dims = [1 40];
            definput = {'0'};
            answer = inputdlg(prompt,dlgtitle,dims,definput);
            if (isempty(answer))
                figure(app.UIFigure);
            else
                answer = str2double(answer{1});
                localYAxisLimitMax = answer;
                app.paPlotAreaStressOnly.YLim = [app.yAxisLimitMin localYAxisLimitMax];
                app.paPlotAreaStressOnly.YTick = getSliderTicks(app.yAxisLimitMin, localYAxisLimitMax, app.maxYAxisInterval);
            end
        end

        % Menu selected function: SetYaxisMaxMenu_2
        function SetYaxisMaxMenu_2Selected(app, event)
            prompt = {'Max HU:'};
            dlgtitle = 'Set Y-axis Max';
            dims = [1 40];
            definput = {'0'};
            answer = inputdlg(prompt,dlgtitle,dims,definput);
            if (isempty(answer))
                figure(app.UIFigure);
            else
                answer = str2double(answer{1});
                localYAxisLimitMax = answer;
                app.pdPlotAreaStressOnly.YLim = [app.yAxisLimitMin localYAxisLimitMax];
                app.pdPlotAreaStressOnly.YTick = getSliderTicks(app.yAxisLimitMin, localYAxisLimitMax, app.maxYAxisInterval);
            end
        end

        % Callback function
        function StressTestMenuSelected(app, event)
            app.StressStudyLabelStressOnly.Text = app.StressTestMenu.Text;
            app.StressTestMenu.Checked = 'on';
            app.RestTestMenu.Checked = 'off';
        end

        % Callback function
        function RestTestMenuSelected(app, event)
            app.StressStudyLabelStressOnly.Text = app.RestTestMenu.Text;
            app.RestTestMenu.Checked = 'on';
            app.StressTestMenu.Checked = 'off';
        end

        % Button pushed function: MButton
        function MButtonPushed(app, event)
            if (app.movieStop == false)
                app.movieStop = true;
            else
                app.movieStop = false;
            end

            numberOfTimePoints = max(size(app.timePointsStressOnly));
            i = app.currentTimePointStressOnly;
            while(app.movieStop)
                currentImage(1:512,1:512) = app.fourDImageSetStressOnly(app.currentSliceStressOnly, i, 1:512,1:512);
                app.TimePointsSliderStressOnly.Value = i;
                if (~isempty(app.paStressOnly) && app.currentSliceStressOnly == app.paStressOnly(1))
                    currentImage = getROIOverlayed(currentImage, app.sxPreStressOnly, app.syPreStressOnly);
                elseif (~isempty(app.pdStressOnly) && app.currentSliceStressOnly == app.pdStressOnly(1))
                    currentImage = getROIOverlayed(currentImage, app.sxPostStressOnly, app.syPostStressOnly);
                end
                updateimageStressOnly(app, currentImage);
                pause(app.movieFrameDuration);
                i = i + 1;
                if (i == numberOfTimePoints)
                    i = 1;
                end
                app.currentTimePointStressOnly = i;
            end

        end

        % Value changed function: XrayTubeVoltagekVDropDown
        function XrayTubeVoltagekVDropDownValueChanged(app, event)
            app.xRayTubeVoltageIndex = find(strcmp(app.XrayTubeVoltagekVDropDown.Value, app.xRayTubeVoltages));
        end

        % Value changed function: RestorStressConditionDropDown
        function RestorStressConditionDropDownValueChanged(app, event)
            value = app.RestorStressConditionDropDown.Value;
            if (strcmp(value, 'Rest'))
                app.f = 1;
            elseif (strcmp(value, 'Stress'))
                app.f = 2.25;
            end
        end

        % Value changed function: CoronaryArteryDropDown
        function CoronaryArteryDropDownValueChanged(app, event)
            value = app.CoronaryArteryDropDown.Value;
            app.arterySelectedIndex = find(strcmp(value, app.arterySelections));
        end

        % Value changed function: MarkBranchCheckBox
        function MarkBranchCheckBoxValueChanged(app, event)
            value = app.MarkBranchCheckBox.Value;
            if (value == 1)
                app.branchGuiData = BRANCHGUI(app);
                app.branchGuiData.addlistener('AppClosedEvent', @app.onBranchGuiClosed);
            else
                app.branchGuiData.delete();
                app.MarkBranchCheckBox.Value = false;
            end
        end

        % Value changed function: CoronaryDominanceDropDown
        function CoronaryDominanceDropDownValueChanged(app, event)
            value = app.CoronaryDominanceDropDown.Value;
            index = find(strcmp(value, app.dominanceTypes));
            app.dominanceType = app.dominanceTypes(index);
        end
    end

    % Component initialization
    methods (Access = private)

        % Create UIFigure and components
        function createComponents(app)

            % Create UIFigure and hide until all components are created
            app.UIFigure = uifigure('Visible', 'off');
            app.UIFigure.AutoResizeChildren = 'off';
            app.UIFigure.Position = [100 50 1642 1028];
            app.UIFigure.Name = 'DAI - Vera';
            app.UIFigure.Resize = 'off';
            app.UIFigure.HandleVisibility = 'callback';

            % Create FileMenu
            app.FileMenu = uimenu(app.UIFigure);
            app.FileMenu.Text = 'File';

            % Create LoadMenu
            app.LoadMenu = uimenu(app.FileMenu);
            app.LoadMenu.Text = 'Load';

            % Create DCECTAnalysisMenu
            app.DCECTAnalysisMenu = uimenu(app.LoadMenu);
            app.DCECTAnalysisMenu.Text = 'DCE CT Analysis';

            % Create DCECTImagesMenu
            app.DCECTImagesMenu = uimenu(app.DCECTAnalysisMenu);
            app.DCECTImagesMenu.MenuSelectedFcn = createCallbackFcn(app, @DCECTImagesMenuSelected, true);
            app.DCECTImagesMenu.Text = 'DCE CT Images';

            % Create ScannerModelMenu
            app.ScannerModelMenu = uimenu(app.DCECTImagesMenu);
            app.ScannerModelMenu.Text = 'Scanner Model';

            % Create SiemensMenu_3
            app.SiemensMenu_3 = uimenu(app.ScannerModelMenu);
            app.SiemensMenu_3.MenuSelectedFcn = createCallbackFcn(app, @SiemensMenu_3Selected, true);
            app.SiemensMenu_3.Text = 'Siemens';

            % Create CanonMenu_3
            app.CanonMenu_3 = uimenu(app.ScannerModelMenu);
            app.CanonMenu_3.MenuSelectedFcn = createCallbackFcn(app, @CanonMenu_3Selected, true);
            app.CanonMenu_3.Text = 'Canon';

            % Create GEMenu_3
            app.GEMenu_3 = uimenu(app.ScannerModelMenu);
            app.GEMenu_3.MenuSelectedFcn = createCallbackFcn(app, @GEMenu_3Selected, true);
            app.GEMenu_3.Text = 'GE';

            % Create CTAImagesMenu
            app.CTAImagesMenu = uimenu(app.DCECTAnalysisMenu);
            app.CTAImagesMenu.MenuSelectedFcn = createCallbackFcn(app, @CTAImagesMenuSelected, true);
            app.CTAImagesMenu.Text = 'CTA Images';

            % Create PreLesionCurveMenu
            app.PreLesionCurveMenu = uimenu(app.DCECTAnalysisMenu);
            app.PreLesionCurveMenu.MenuSelectedFcn = createCallbackFcn(app, @PreLesionCurveMenuSelected, true);
            app.PreLesionCurveMenu.Visible = 'off';
            app.PreLesionCurveMenu.Text = 'Pre-Lesion Curve';

            % Create PostLesionCurveMenu
            app.PostLesionCurveMenu = uimenu(app.DCECTAnalysisMenu);
            app.PostLesionCurveMenu.MenuSelectedFcn = createCallbackFcn(app, @PostLesionCurveMenuSelected, true);
            app.PostLesionCurveMenu.Visible = 'off';
            app.PostLesionCurveMenu.Text = 'Post-Lesion Curve';

            % Create SampleROIMenu
            app.SampleROIMenu = uimenu(app.DCECTAnalysisMenu);
            app.SampleROIMenu.MenuSelectedFcn = createCallbackFcn(app, @SampleROIMenuSelected, true);
            app.SampleROIMenu.Text = 'Sample ROI';

            % Create CTPTimeInfoMenu
            app.CTPTimeInfoMenu = uimenu(app.DCECTAnalysisMenu);
            app.CTPTimeInfoMenu.MenuSelectedFcn = createCallbackFcn(app, @CTPTimeInfoMenuSelected, true);
            app.CTPTimeInfoMenu.Text = 'CTP Time Info';

            % Create ApplyCTPTimeInfoMenu
            app.ApplyCTPTimeInfoMenu = uimenu(app.DCECTAnalysisMenu);
            app.ApplyCTPTimeInfoMenu.MenuSelectedFcn = createCallbackFcn(app, @ApplyCTPTimeInfoMenuSelected, true);
            app.ApplyCTPTimeInfoMenu.Text = 'Apply CTP Time Info';

            % Create StressandRestAnalysisMenu
            app.StressandRestAnalysisMenu = uimenu(app.LoadMenu);
            app.StressandRestAnalysisMenu.Visible = 'off';
            app.StressandRestAnalysisMenu.Text = 'Stress and Rest Analysis';

            % Create StressImagesMenu_4
            app.StressImagesMenu_4 = uimenu(app.StressandRestAnalysisMenu);
            app.StressImagesMenu_4.MenuSelectedFcn = createCallbackFcn(app, @StressImagesMenu_4Selected, true);
            app.StressImagesMenu_4.Text = 'Stress Images';

            % Create ScannerModelMenu_2
            app.ScannerModelMenu_2 = uimenu(app.StressImagesMenu_4);
            app.ScannerModelMenu_2.Text = 'Scanner Model';

            % Create SiemensMenu_4
            app.SiemensMenu_4 = uimenu(app.ScannerModelMenu_2);
            app.SiemensMenu_4.MenuSelectedFcn = createCallbackFcn(app, @SiemensMenu_4Selected, true);
            app.SiemensMenu_4.Text = 'Siemens';

            % Create CanonMenu_4
            app.CanonMenu_4 = uimenu(app.ScannerModelMenu_2);
            app.CanonMenu_4.MenuSelectedFcn = createCallbackFcn(app, @CanonMenu_4Selected, true);
            app.CanonMenu_4.Text = 'Canon';

            % Create GEMenu_4
            app.GEMenu_4 = uimenu(app.ScannerModelMenu_2);
            app.GEMenu_4.MenuSelectedFcn = createCallbackFcn(app, @GEMenu_4Selected, true);
            app.GEMenu_4.Text = 'GE';

            % Create TimeInfoStudyStressMenu
            app.TimeInfoStudyStressMenu = uimenu(app.StressandRestAnalysisMenu);
            app.TimeInfoStudyStressMenu.MenuSelectedFcn = createCallbackFcn(app, @TimeInfoStudyStressMenuSelected, true);
            app.TimeInfoStudyStressMenu.Text = 'Time-Info Study (Stress)';

            % Create RestImagesMenu_2
            app.RestImagesMenu_2 = uimenu(app.StressandRestAnalysisMenu);
            app.RestImagesMenu_2.MenuSelectedFcn = createCallbackFcn(app, @RestImagesMenu_2Selected, true);
            app.RestImagesMenu_2.Text = 'Rest Images';

            % Create ScannerModelMenu_3
            app.ScannerModelMenu_3 = uimenu(app.RestImagesMenu_2);
            app.ScannerModelMenu_3.Text = 'Scanner Model';

            % Create SiemensMenu_5
            app.SiemensMenu_5 = uimenu(app.ScannerModelMenu_3);
            app.SiemensMenu_5.MenuSelectedFcn = createCallbackFcn(app, @SiemensMenu_5Selected, true);
            app.SiemensMenu_5.Text = 'Siemens';

            % Create CanonMenu_5
            app.CanonMenu_5 = uimenu(app.ScannerModelMenu_3);
            app.CanonMenu_5.MenuSelectedFcn = createCallbackFcn(app, @CanonMenu_5Selected, true);
            app.CanonMenu_5.Text = 'Canon';

            % Create GEMenu_5
            app.GEMenu_5 = uimenu(app.ScannerModelMenu_3);
            app.GEMenu_5.MenuSelectedFcn = createCallbackFcn(app, @GEMenu_5Selected, true);
            app.GEMenu_5.Text = 'GE';

            % Create TimeInfoStudyRestMenu
            app.TimeInfoStudyRestMenu = uimenu(app.StressandRestAnalysisMenu);
            app.TimeInfoStudyRestMenu.MenuSelectedFcn = createCallbackFcn(app, @TimeInfoStudyRestMenuSelected, true);
            app.TimeInfoStudyRestMenu.Text = 'Time-Info Study (Rest)';

            % Create PreLesionCurveMenu_2
            app.PreLesionCurveMenu_2 = uimenu(app.StressandRestAnalysisMenu);
            app.PreLesionCurveMenu_2.MenuSelectedFcn = createCallbackFcn(app, @PreLesionCurveMenu_2Selected, true);
            app.PreLesionCurveMenu_2.Text = 'Pre-Lesion Curve';

            % Create PostLesionCurveMenu_2
            app.PostLesionCurveMenu_2 = uimenu(app.StressandRestAnalysisMenu);
            app.PostLesionCurveMenu_2.MenuSelectedFcn = createCallbackFcn(app, @PostLesionCurveMenu_2Selected, true);
            app.PostLesionCurveMenu_2.Text = 'Post-Lesion Curve';

            % Create SupervisedLearningMenu_2
            app.SupervisedLearningMenu_2 = uimenu(app.LoadMenu);
            app.SupervisedLearningMenu_2.Visible = 'off';
            app.SupervisedLearningMenu_2.Text = 'Supervised Learning';

            % Create DCTAVolumeMenu
            app.DCTAVolumeMenu = uimenu(app.SupervisedLearningMenu_2);
            app.DCTAVolumeMenu.MenuSelectedFcn = createCallbackFcn(app, @DCTAVolumeMenuSelected, true);
            app.DCTAVolumeMenu.Text = '3D CTA Volume';

            % Create TrainingMenu_2
            app.TrainingMenu_2 = uimenu(app.SupervisedLearningMenu_2);
            app.TrainingMenu_2.Text = 'Training';

            % Create TrainingDataMenu
            app.TrainingDataMenu = uimenu(app.TrainingMenu_2);
            app.TrainingDataMenu.MenuSelectedFcn = createCallbackFcn(app, @TrainingDataMenuSelected, true);
            app.TrainingDataMenu.Text = 'Training Data';

            % Create ValidationDataMenu
            app.ValidationDataMenu = uimenu(app.TrainingMenu_2);
            app.ValidationDataMenu.MenuSelectedFcn = createCallbackFcn(app, @ValidationDataMenuSelected, true);
            app.ValidationDataMenu.Text = 'Validation Data';

            % Create TestingMenu_2
            app.TestingMenu_2 = uimenu(app.SupervisedLearningMenu_2);
            app.TestingMenu_2.Text = 'Testing';

            % Create TestDataMenu
            app.TestDataMenu = uimenu(app.TestingMenu_2);
            app.TestDataMenu.MenuSelectedFcn = createCallbackFcn(app, @TestDataMenuSelected, true);
            app.TestDataMenu.Text = 'Test Data';

            % Create SavedNetworkMenu
            app.SavedNetworkMenu = uimenu(app.TestingMenu_2);
            app.SavedNetworkMenu.MenuSelectedFcn = createCallbackFcn(app, @SavedNetworkMenuSelected, true);
            app.SavedNetworkMenu.Text = 'Saved Network';

            % Create SaveMenu
            app.SaveMenu = uimenu(app.FileMenu);
            app.SaveMenu.Text = 'Save';

            % Create DCECTAnalysisMenu_2
            app.DCECTAnalysisMenu_2 = uimenu(app.SaveMenu);
            app.DCECTAnalysisMenu_2.Text = 'DCE CT Analysis';

            % Create ResultsMenu
            app.ResultsMenu = uimenu(app.DCECTAnalysisMenu_2);
            app.ResultsMenu.MenuSelectedFcn = createCallbackFcn(app, @ResultsMenuSelected, true);
            app.ResultsMenu.Text = 'Results';

            % Create StressandRestAnalysisMenu_2
            app.StressandRestAnalysisMenu_2 = uimenu(app.SaveMenu);
            app.StressandRestAnalysisMenu_2.Visible = 'off';
            app.StressandRestAnalysisMenu_2.Text = 'Stress and Rest Analysis';

            % Create ResultsMenu_2
            app.ResultsMenu_2 = uimenu(app.StressandRestAnalysisMenu_2);
            app.ResultsMenu_2.MenuSelectedFcn = createCallbackFcn(app, @ResultsMenu_2Selected, true);
            app.ResultsMenu_2.Text = 'Results';

            % Create SupervisedLearningMenu
            app.SupervisedLearningMenu = uimenu(app.SaveMenu);
            app.SupervisedLearningMenu.Visible = 'off';
            app.SupervisedLearningMenu.Text = 'Supervised Learning';

            % Create LabelledDataMenu
            app.LabelledDataMenu = uimenu(app.SupervisedLearningMenu);
            app.LabelledDataMenu.MenuSelectedFcn = createCallbackFcn(app, @LabelledDataMenuSelected, true);
            app.LabelledDataMenu.Text = 'Labelled Data';

            % Create ExportMenu
            app.ExportMenu = uimenu(app.FileMenu);
            app.ExportMenu.Text = 'Export';

            % Create DCECTAnalysisMenu_3
            app.DCECTAnalysisMenu_3 = uimenu(app.ExportMenu);
            app.DCECTAnalysisMenu_3.Text = 'DCE CT Analysis';

            % Create DCECTImagesMenu_2
            app.DCECTImagesMenu_2 = uimenu(app.DCECTAnalysisMenu_3);
            app.DCECTImagesMenu_2.MenuSelectedFcn = createCallbackFcn(app, @DCECTImagesMenu_2Selected, true);
            app.DCECTImagesMenu_2.Text = 'DCE CT Images';

            % Create CTAImagesMenu_2
            app.CTAImagesMenu_2 = uimenu(app.DCECTAnalysisMenu_3);
            app.CTAImagesMenu_2.MenuSelectedFcn = createCallbackFcn(app, @CTAImagesMenu_2Selected, true);
            app.CTAImagesMenu_2.Text = 'CTA Images';

            % Create FittedCurvesMenu
            app.FittedCurvesMenu = uimenu(app.DCECTAnalysisMenu_3);
            app.FittedCurvesMenu.MenuSelectedFcn = createCallbackFcn(app, @FittedCurvesMenuSelected, true);
            app.FittedCurvesMenu.Text = 'Fitted Curves';

            % Create FFRValuesMenu
            app.FFRValuesMenu = uimenu(app.DCECTAnalysisMenu_3);
            app.FFRValuesMenu.MenuSelectedFcn = createCallbackFcn(app, @FFRValuesMenuSelected, true);
            app.FFRValuesMenu.Text = 'FFR Values';

            % Create StressandRestAnalysisMenu_3
            app.StressandRestAnalysisMenu_3 = uimenu(app.ExportMenu);
            app.StressandRestAnalysisMenu_3.Visible = 'off';
            app.StressandRestAnalysisMenu_3.Text = 'Stress and Rest Analysis';

            % Create StressImagesMenu_3
            app.StressImagesMenu_3 = uimenu(app.StressandRestAnalysisMenu_3);
            app.StressImagesMenu_3.MenuSelectedFcn = createCallbackFcn(app, @StressImagesMenu_3Selected, true);
            app.StressImagesMenu_3.Text = 'Stress Images';

            % Create RestImagesMenu
            app.RestImagesMenu = uimenu(app.StressandRestAnalysisMenu_3);
            app.RestImagesMenu.MenuSelectedFcn = createCallbackFcn(app, @RestImagesMenuSelected, true);
            app.RestImagesMenu.Text = 'Rest Images';

            % Create FittedCurveMenu_2
            app.FittedCurveMenu_2 = uimenu(app.StressandRestAnalysisMenu_3);
            app.FittedCurveMenu_2.MenuSelectedFcn = createCallbackFcn(app, @FittedCurveMenu_2Selected, true);
            app.FittedCurveMenu_2.Text = 'Fitted Curve';

            % Create WorkflowMenu
            app.WorkflowMenu = uimenu(app.FileMenu);
            app.WorkflowMenu.Visible = 'off';
            app.WorkflowMenu.Text = 'Workflow';

            % Create SupervisedLearningMenu_4
            app.SupervisedLearningMenu_4 = uimenu(app.WorkflowMenu);
            app.SupervisedLearningMenu_4.Text = 'Supervised Learning';

            % Create TrainingMenu
            app.TrainingMenu = uimenu(app.SupervisedLearningMenu_4);
            app.TrainingMenu.Text = 'Training';

            % Create NetworkOptionMenu
            app.NetworkOptionMenu = uimenu(app.TrainingMenu);
            app.NetworkOptionMenu.Text = 'Network Option';

            % Create CNNMenu
            app.CNNMenu = uimenu(app.NetworkOptionMenu);
            app.CNNMenu.MenuSelectedFcn = createCallbackFcn(app, @CNNMenuSelected, true);
            app.CNNMenu.Checked = 'on';
            app.CNNMenu.Text = 'CNN';

            % Create UNETMenu
            app.UNETMenu = uimenu(app.NetworkOptionMenu);
            app.UNETMenu.MenuSelectedFcn = createCallbackFcn(app, @UNETMenuSelected, true);
            app.UNETMenu.Text = 'UNET';

            % Create StartTrainingMenu
            app.StartTrainingMenu = uimenu(app.TrainingMenu);
            app.StartTrainingMenu.MenuSelectedFcn = createCallbackFcn(app, @StartTrainingMenuSelected, true);
            app.StartTrainingMenu.Text = 'Start Training';

            % Create TestingMenu
            app.TestingMenu = uimenu(app.SupervisedLearningMenu_4);
            app.TestingMenu.Text = 'Testing';

            % Create ClassifyMenu
            app.ClassifyMenu = uimenu(app.TestingMenu);
            app.ClassifyMenu.MenuSelectedFcn = createCallbackFcn(app, @ClassifyMenuSelected, true);
            app.ClassifyMenu.Text = 'Classify';

            % Create DataLabelingMenu
            app.DataLabelingMenu = uimenu(app.SupervisedLearningMenu_4);
            app.DataLabelingMenu.Text = 'Data Labeling';

            % Create SetApexPointMenu
            app.SetApexPointMenu = uimenu(app.DataLabelingMenu);
            app.SetApexPointMenu.MenuSelectedFcn = createCallbackFcn(app, @SetApexPointMenuSelected, true);
            app.SetApexPointMenu.Text = 'Set Apex Point';

            % Create SetLADPointMenu
            app.SetLADPointMenu = uimenu(app.DataLabelingMenu);
            app.SetLADPointMenu.MenuSelectedFcn = createCallbackFcn(app, @SetLADPointMenuSelected, true);
            app.SetLADPointMenu.Text = 'Set LAD Point';

            % Create SetLCxPointMenu
            app.SetLCxPointMenu = uimenu(app.DataLabelingMenu);
            app.SetLCxPointMenu.MenuSelectedFcn = createCallbackFcn(app, @SetLCxPointMenuSelected, true);
            app.SetLCxPointMenu.Text = 'Set LCx Point';

            % Create SetRCAPointMenu
            app.SetRCAPointMenu = uimenu(app.DataLabelingMenu);
            app.SetRCAPointMenu.MenuSelectedFcn = createCallbackFcn(app, @SetRCAPointMenuSelected, true);
            app.SetRCAPointMenu.Text = 'Set RCA Point';

            % Create RemoveLastPointMenu
            app.RemoveLastPointMenu = uimenu(app.DataLabelingMenu);
            app.RemoveLastPointMenu.MenuSelectedFcn = createCallbackFcn(app, @RemoveLastPointMenuSelected, true);
            app.RemoveLastPointMenu.Text = 'Remove Last Point';

            % Create ScreenCaptureMenu
            app.ScreenCaptureMenu = uimenu(app.FileMenu);
            app.ScreenCaptureMenu.MenuSelectedFcn = createCallbackFcn(app, @ScreenCaptureMenuSelected, true);
            app.ScreenCaptureMenu.Text = 'Screen Capture';

            % Create ExitMenu
            app.ExitMenu = uimenu(app.FileMenu);
            app.ExitMenu.MenuSelectedFcn = createCallbackFcn(app, @ExitMenuSelected, true);
            app.ExitMenu.Text = 'Exit';

            % Create Menu
            app.Menu = uimenu(app.UIFigure);
            app.Menu.Enable = 'off';

            % Create EditMenu
            app.EditMenu = uimenu(app.UIFigure);
            app.EditMenu.Text = 'Edit';

            % Create DCECTAnalysisMenu_4
            app.DCECTAnalysisMenu_4 = uimenu(app.EditMenu);
            app.DCECTAnalysisMenu_4.Text = 'DCE CT Analysis';

            % Create SetLevelWidthforStressTestMenu
            app.SetLevelWidthforStressTestMenu = uimenu(app.DCECTAnalysisMenu_4);
            app.SetLevelWidthforStressTestMenu.Visible = 'off';
            app.SetLevelWidthforStressTestMenu.Text = 'Set Level/Width for Stress Test';

            % Create SetLevelWidthforCTATestMenu
            app.SetLevelWidthforCTATestMenu = uimenu(app.DCECTAnalysisMenu_4);
            app.SetLevelWidthforCTATestMenu.Visible = 'off';
            app.SetLevelWidthforCTATestMenu.Text = 'Set Level/Width for CTA Test';

            % Create YaxisScalePreLesionMenu
            app.YaxisScalePreLesionMenu = uimenu(app.DCECTAnalysisMenu_4);
            app.YaxisScalePreLesionMenu.Text = 'Y-axis Scale (Pre Lesion)';

            % Create AutoMenu
            app.AutoMenu = uimenu(app.YaxisScalePreLesionMenu);
            app.AutoMenu.MenuSelectedFcn = createCallbackFcn(app, @AutoMenuSelected, true);
            app.AutoMenu.Checked = 'on';
            app.AutoMenu.Text = 'Auto';

            % Create ManualMenu
            app.ManualMenu = uimenu(app.YaxisScalePreLesionMenu);
            app.ManualMenu.MenuSelectedFcn = createCallbackFcn(app, @ManualMenuSelected, true);
            app.ManualMenu.Text = 'Manual';

            % Create YaxisScalePostLesionMenu
            app.YaxisScalePostLesionMenu = uimenu(app.DCECTAnalysisMenu_4);
            app.YaxisScalePostLesionMenu.Text = 'Y-axis Scale (Post Lesion)';

            % Create AutoMenu_2
            app.AutoMenu_2 = uimenu(app.YaxisScalePostLesionMenu);
            app.AutoMenu_2.MenuSelectedFcn = createCallbackFcn(app, @AutoMenu_2Selected, true);
            app.AutoMenu_2.Checked = 'on';
            app.AutoMenu_2.Text = 'Auto';

            % Create ManualMenu_2
            app.ManualMenu_2 = uimenu(app.YaxisScalePostLesionMenu);
            app.ManualMenu_2.MenuSelectedFcn = createCallbackFcn(app, @ManualMenu_2Selected, true);
            app.ManualMenu_2.Text = 'Manual';

            % Create StressandRestAnalysisMenu_4
            app.StressandRestAnalysisMenu_4 = uimenu(app.EditMenu);
            app.StressandRestAnalysisMenu_4.Visible = 'off';
            app.StressandRestAnalysisMenu_4.Text = 'Stress and Rest Analysis';

            % Create SetLevelWidthforStressTestMenu_2
            app.SetLevelWidthforStressTestMenu_2 = uimenu(app.StressandRestAnalysisMenu_4);
            app.SetLevelWidthforStressTestMenu_2.Text = 'Set Level/Width for Stress Test';

            % Create SetLevelWidthforRestTestMenu
            app.SetLevelWidthforRestTestMenu = uimenu(app.StressandRestAnalysisMenu_4);
            app.SetLevelWidthforRestTestMenu.Text = 'Set Level/Width for Rest Test';

            % Create YaxisScalePreLesionMenu_2
            app.YaxisScalePreLesionMenu_2 = uimenu(app.StressandRestAnalysisMenu_4);
            app.YaxisScalePreLesionMenu_2.Text = 'Y-axis Scale (Pre Lesion)';

            % Create AutoMenu_3
            app.AutoMenu_3 = uimenu(app.YaxisScalePreLesionMenu_2);
            app.AutoMenu_3.MenuSelectedFcn = createCallbackFcn(app, @AutoMenu_3Selected, true);
            app.AutoMenu_3.Checked = 'on';
            app.AutoMenu_3.Text = 'Auto';

            % Create ManualMenu_3
            app.ManualMenu_3 = uimenu(app.YaxisScalePreLesionMenu_2);
            app.ManualMenu_3.MenuSelectedFcn = createCallbackFcn(app, @ManualMenu_3Selected, true);
            app.ManualMenu_3.Text = 'Manual';

            % Create YaxisScalePostLesionMenu_2
            app.YaxisScalePostLesionMenu_2 = uimenu(app.StressandRestAnalysisMenu_4);
            app.YaxisScalePostLesionMenu_2.Text = 'Y-axis Scale (Post Lesion)';

            % Create AutoMenu_4
            app.AutoMenu_4 = uimenu(app.YaxisScalePostLesionMenu_2);
            app.AutoMenu_4.MenuSelectedFcn = createCallbackFcn(app, @AutoMenu_4Selected, true);
            app.AutoMenu_4.Checked = 'on';
            app.AutoMenu_4.Text = 'Auto';

            % Create ManualMenu_4
            app.ManualMenu_4 = uimenu(app.YaxisScalePostLesionMenu_2);
            app.ManualMenu_4.MenuSelectedFcn = createCallbackFcn(app, @ManualMenu_4Selected, true);
            app.ManualMenu_4.Text = 'Manual';

            % Create SupervisedLearningMenu_3
            app.SupervisedLearningMenu_3 = uimenu(app.EditMenu);
            app.SupervisedLearningMenu_3.Visible = 'off';
            app.SupervisedLearningMenu_3.Text = 'Supervised Learning';

            % Create SetWindowLevelMenu
            app.SetWindowLevelMenu = uimenu(app.SupervisedLearningMenu_3);
            app.SetWindowLevelMenu.Text = 'Set Window/Level';

            % Create Menu_2
            app.Menu_2 = uimenu(app.UIFigure);
            app.Menu_2.Enable = 'off';

            % Create ViewMenu
            app.ViewMenu = uimenu(app.UIFigure);
            app.ViewMenu.Text = 'View';

            % Create OptionMenu
            app.OptionMenu = uimenu(app.ViewMenu);
            app.OptionMenu.Text = 'Option';

            % Create BasicMenu
            app.BasicMenu = uimenu(app.OptionMenu);
            app.BasicMenu.MenuSelectedFcn = createCallbackFcn(app, @BasicMenuSelected, true);
            app.BasicMenu.Text = 'Basic';

            % Create FullMenu
            app.FullMenu = uimenu(app.OptionMenu);
            app.FullMenu.MenuSelectedFcn = createCallbackFcn(app, @FullMenuSelected, true);
            app.FullMenu.Checked = 'on';
            app.FullMenu.Text = 'Full';

            % Create BackgroundMenu
            app.BackgroundMenu = uimenu(app.ViewMenu);
            app.BackgroundMenu.Text = 'Background';

            % Create BrightMenu
            app.BrightMenu = uimenu(app.BackgroundMenu);
            app.BrightMenu.MenuSelectedFcn = createCallbackFcn(app, @BrightMenuSelected, true);
            app.BrightMenu.Checked = 'on';
            app.BrightMenu.Text = 'Bright';

            % Create DarkMenu
            app.DarkMenu = uimenu(app.BackgroundMenu);
            app.DarkMenu.MenuSelectedFcn = createCallbackFcn(app, @DarkMenuSelected, true);
            app.DarkMenu.Text = 'Dark';

            % Create FontMenu
            app.FontMenu = uimenu(app.ViewMenu);
            app.FontMenu.Text = 'Font';

            % Create ArialMenu
            app.ArialMenu = uimenu(app.FontMenu);
            app.ArialMenu.MenuSelectedFcn = createCallbackFcn(app, @ArialMenuSelected, true);
            app.ArialMenu.Checked = 'on';
            app.ArialMenu.Text = 'Arial';

            % Create PalatinoLinotypeMenu
            app.PalatinoLinotypeMenu = uimenu(app.FontMenu);
            app.PalatinoLinotypeMenu.MenuSelectedFcn = createCallbackFcn(app, @PalatinoLinotypeMenuSelected, true);
            app.PalatinoLinotypeMenu.Text = 'Palatino Linotype';

            % Create TimesMenu
            app.TimesMenu = uimenu(app.FontMenu);
            app.TimesMenu.MenuSelectedFcn = createCallbackFcn(app, @TimesMenuSelected, true);
            app.TimesMenu.Text = 'Times';

            % Create Menu_3
            app.Menu_3 = uimenu(app.UIFigure);
            app.Menu_3.Enable = 'off';

            % Create HelpMenu
            app.HelpMenu = uimenu(app.UIFigure);
            app.HelpMenu.Text = 'Help';

            % Create AboutDAIVeraMenu
            app.AboutDAIVeraMenu = uimenu(app.HelpMenu);
            app.AboutDAIVeraMenu.MenuSelectedFcn = createCallbackFcn(app, @AboutDAIVeraMenuSelected, true);
            app.AboutDAIVeraMenu.Text = 'About DAI Vera';

            % Create UserGuideMenu
            app.UserGuideMenu = uimenu(app.HelpMenu);
            app.UserGuideMenu.MenuSelectedFcn = createCallbackFcn(app, @UserGuideMenuSelected, true);
            app.UserGuideMenu.Text = 'User Guide';

            % Create TabGroup
            app.TabGroup = uitabgroup(app.UIFigure);
            app.TabGroup.AutoResizeChildren = 'off';
            app.TabGroup.Position = [1 1 1642 1028];

            % Create StressOnly
            app.StressOnly = uitab(app.TabGroup);
            app.StressOnly.AutoResizeChildren = 'off';
            app.StressOnly.Title = 'DCE CT Analysis';

            % Create ImageAxesStressOnly
            app.ImageAxesStressOnly = uiaxes(app.StressOnly);
            app.ImageAxesStressOnly.XTick = [];
            app.ImageAxesStressOnly.XTickLabel = {'[ ]'};
            app.ImageAxesStressOnly.YTick = [];
            app.ImageAxesStressOnly.Position = [18 482 463 424];

            % Create pdPlotAreaStressOnly
            app.pdPlotAreaStressOnly = uiaxes(app.StressOnly);
            title(app.pdPlotAreaStressOnly, 'Post-lesion Curve')
            xlabel(app.pdPlotAreaStressOnly, 'Time (s)')
            ylabel(app.pdPlotAreaStressOnly, 'Enhancement (HU)')
            app.pdPlotAreaStressOnly.XLim = [1 10];
            app.pdPlotAreaStressOnly.YLim = [-50 500];
            app.pdPlotAreaStressOnly.XTick = [1 2 3 4 5 6 7 8 9 10];
            app.pdPlotAreaStressOnly.YTick = [-50 50 150 250 350 450];
            app.pdPlotAreaStressOnly.Position = [1159 237 459 309];

            % Create paPlotAreaStressOnly
            app.paPlotAreaStressOnly = uiaxes(app.StressOnly);
            title(app.paPlotAreaStressOnly, 'Pre-lesion Curve')
            xlabel(app.paPlotAreaStressOnly, 'Time (s)')
            ylabel(app.paPlotAreaStressOnly, 'Enhancement (HU)')
            app.paPlotAreaStressOnly.XLim = [1 10];
            app.paPlotAreaStressOnly.YLim = [-50 500];
            app.paPlotAreaStressOnly.XTick = [1 2 3 4 5 6 7 8 9 10];
            app.paPlotAreaStressOnly.YTick = [-50 50 150 250 350 450];
            app.paPlotAreaStressOnly.Position = [1159 628 459 309];

            % Create FFRVsSliceLocation
            app.FFRVsSliceLocation = uiaxes(app.StressOnly);
            title(app.FFRVsSliceLocation, 'FFR / Flow Velocity Graph')
            xlabel(app.FFRVsSliceLocation, 'Slice Number')
            ylabel(app.FFRVsSliceLocation, 'FFR')
            zlabel(app.FFRVsSliceLocation, 'Z')
            app.FFRVsSliceLocation.XLim = [1 52];
            app.FFRVsSliceLocation.TickDir = 'in';
            app.FFRVsSliceLocation.Position = [616 38 458 339];

            % Create ImageAxesCTAStressOnly
            app.ImageAxesCTAStressOnly = uiaxes(app.StressOnly);
            zlabel(app.ImageAxesCTAStressOnly, 'Z')
            app.ImageAxesCTAStressOnly.PlotBoxAspectRatio = [1.09420289855072 1 1];
            app.ImageAxesCTAStressOnly.GridLineStyle = 'none';
            app.ImageAxesCTAStressOnly.XTick = [];
            app.ImageAxesCTAStressOnly.YTick = [];
            app.ImageAxesCTAStressOnly.Position = [615 484 441 421];

            % Create InputParametersforStressStudyPanelStressOnly
            app.InputParametersforStressStudyPanelStressOnly = uipanel(app.StressOnly);
            app.InputParametersforStressStudyPanelStressOnly.AutoResizeChildren = 'off';
            app.InputParametersforStressStudyPanelStressOnly.ForegroundColor = [0 0.451 0.7412];
            app.InputParametersforStressStudyPanelStressOnly.Title = 'Input Parameters';
            app.InputParametersforStressStudyPanelStressOnly.FontWeight = 'bold';
            app.InputParametersforStressStudyPanelStressOnly.Position = [22 29 510 306];

            % Create ArteryTypeButtonGroupStressOnly
            app.ArteryTypeButtonGroupStressOnly = uibuttongroup(app.InputParametersforStressStudyPanelStressOnly);
            app.ArteryTypeButtonGroupStressOnly.AutoResizeChildren = 'off';
            app.ArteryTypeButtonGroupStressOnly.SelectionChangedFcn = createCallbackFcn(app, @ArteryTypeButtonGroupStressOnlySelectionChanged, true);
            app.ArteryTypeButtonGroupStressOnly.Title = 'Artery Type';
            app.ArteryTypeButtonGroupStressOnly.Position = [399 78 100 69];

            % Create CoronaryButtonStressOnly
            app.CoronaryButtonStressOnly = uiradiobutton(app.ArteryTypeButtonGroupStressOnly);
            app.CoronaryButtonStressOnly.Text = 'Coronary';
            app.CoronaryButtonStressOnly.Position = [11 23 71 22];
            app.CoronaryButtonStressOnly.Value = true;

            % Create AortaButtonStressOnly
            app.AortaButtonStressOnly = uiradiobutton(app.ArteryTypeButtonGroupStressOnly);
            app.AortaButtonStressOnly.Text = 'Aorta';
            app.AortaButtonStressOnly.Position = [11 1 51 22];

            % Create ContrastVolumemLEditField_2Label
            app.ContrastVolumemLEditField_2Label = uilabel(app.InputParametersforStressStudyPanelStressOnly);
            app.ContrastVolumemLEditField_2Label.Position = [4 106 122 22];
            app.ContrastVolumemLEditField_2Label.Text = 'Contrast Volume (mL)';

            % Create ContrastVolumemLEditFieldStressOnly
            app.ContrastVolumemLEditFieldStressOnly = uieditfield(app.InputParametersforStressStudyPanelStressOnly, 'text');
            app.ContrastVolumemLEditFieldStressOnly.Position = [231 106 143 22];

            % Create PostlesionLumenRadiuscmEditField_2Label
            app.PostlesionLumenRadiuscmEditField_2Label = uilabel(app.InputParametersforStressStudyPanelStressOnly);
            app.PostlesionLumenRadiuscmEditField_2Label.Position = [4 19 173 22];
            app.PostlesionLumenRadiuscmEditField_2Label.Text = 'Post-lesion Lumen Radius (cm)';

            % Create PostlesionLumenRadiuscmEditFieldStressOnly
            app.PostlesionLumenRadiuscmEditFieldStressOnly = uieditfield(app.InputParametersforStressStudyPanelStressOnly, 'text');
            app.PostlesionLumenRadiuscmEditFieldStressOnly.Position = [231 19 143 22];

            % Create PrelesionLumenRadiuscmLabel_2
            app.PrelesionLumenRadiuscmLabel_2 = uilabel(app.InputParametersforStressStudyPanelStressOnly);
            app.PrelesionLumenRadiuscmLabel_2.Position = [4 48 168 22];
            app.PrelesionLumenRadiuscmLabel_2.Text = 'Pre-lesion Lumen Radius (cm)';

            % Create PrelesionLumenRadiuscmEditFieldStressOnly
            app.PrelesionLumenRadiuscmEditFieldStressOnly = uieditfield(app.InputParametersforStressStudyPanelStressOnly, 'text');
            app.PrelesionLumenRadiuscmEditFieldStressOnly.Position = [231 48 143 22];

            % Create AorticBloodPressuremmHgLabel
            app.AorticBloodPressuremmHgLabel = uilabel(app.InputParametersforStressStudyPanelStressOnly);
            app.AorticBloodPressuremmHgLabel.Position = [4 135 168 22];
            app.AorticBloodPressuremmHgLabel.Text = 'Aortic Blood Pressure (mmHg)';

            % Create SystolicBloodPressuremmHgEditFieldStressOnly
            app.SystolicBloodPressuremmHgEditFieldStressOnly = uieditfield(app.InputParametersforStressStudyPanelStressOnly, 'text');
            app.SystolicBloodPressuremmHgEditFieldStressOnly.Position = [231 135 143 22];

            % Create ContrastConcentrationmgmLLabel
            app.ContrastConcentrationmgmLLabel = uilabel(app.InputParametersforStressStudyPanelStressOnly);
            app.ContrastConcentrationmgmLLabel.Position = [3 77 177 22];
            app.ContrastConcentrationmgmLLabel.Text = 'Contrast Concentration (mg/mL)';

            % Create FrictionFactorButtonGroupStressOnly
            app.FrictionFactorButtonGroupStressOnly = uibuttongroup(app.InputParametersforStressStudyPanelStressOnly);
            app.FrictionFactorButtonGroupStressOnly.AutoResizeChildren = 'off';
            app.FrictionFactorButtonGroupStressOnly.SelectionChangedFcn = createCallbackFcn(app, @FrictionFactorButtonGroupStressOnlySelectionChanged, true);
            app.FrictionFactorButtonGroupStressOnly.Title = 'Friction Factor';
            app.FrictionFactorButtonGroupStressOnly.Position = [399 152 100 69];

            % Create ChurchillButtonStressOnly
            app.ChurchillButtonStressOnly = uiradiobutton(app.FrictionFactorButtonGroupStressOnly);
            app.ChurchillButtonStressOnly.Text = 'Churchill';
            app.ChurchillButtonStressOnly.Position = [11 23 69 22];

            % Create ColebrookButtonStressOnly
            app.ColebrookButtonStressOnly = uiradiobutton(app.FrictionFactorButtonGroupStressOnly);
            app.ColebrookButtonStressOnly.Text = 'Colebrook';
            app.ColebrookButtonStressOnly.Position = [11 1 77 22];
            app.ColebrookButtonStressOnly.Value = true;

            % Create ContrastConcentrationmglmLEditFieldStressOnly
            app.ContrastConcentrationmglmLEditFieldStressOnly = uieditfield(app.InputParametersforStressStudyPanelStressOnly, 'text');
            app.ContrastConcentrationmglmLEditFieldStressOnly.Position = [231 77 143 22];

            % Create ClearInputsButtonStressOnly
            app.ClearInputsButtonStressOnly = uibutton(app.InputParametersforStressStudyPanelStressOnly, 'push');
            app.ClearInputsButtonStressOnly.ButtonPushedFcn = createCallbackFcn(app, @ClearInputsButtonStressOnlyPushed, true);
            app.ClearInputsButtonStressOnly.Position = [399 227 100 22];
            app.ClearInputsButtonStressOnly.Text = 'Clear Inputs';

            % Create OutputButtonStressOnly
            app.OutputButtonStressOnly = uibutton(app.InputParametersforStressStudyPanelStressOnly, 'push');
            app.OutputButtonStressOnly.ButtonPushedFcn = createCallbackFcn(app, @OutputButtonStressOnlyPushed, true);
            app.OutputButtonStressOnly.Position = [400 256 99 22];
            app.OutputButtonStressOnly.Text = 'Compute';

            % Create MarkStenosisCheckBox
            app.MarkStenosisCheckBox = uicheckbox(app.InputParametersforStressStudyPanelStressOnly);
            app.MarkStenosisCheckBox.ValueChangedFcn = createCallbackFcn(app, @MarkStenosisCheckBoxValueChanged, true);
            app.MarkStenosisCheckBox.Text = 'Mark Stenosis';
            app.MarkStenosisCheckBox.Position = [400 28 98 22];

            % Create MarkBreakerCheckBox
            app.MarkBreakerCheckBox = uicheckbox(app.InputParametersforStressStudyPanelStressOnly);
            app.MarkBreakerCheckBox.ValueChangedFcn = createCallbackFcn(app, @MarkBreakerCheckBoxValueChanged, true);
            app.MarkBreakerCheckBox.Text = 'Mark Breaker';
            app.MarkBreakerCheckBox.Position = [400 3 98 22];

            % Create XrayTubeVoltagekVDropDownLabel
            app.XrayTubeVoltagekVDropDownLabel = uilabel(app.InputParametersforStressStudyPanelStressOnly);
            app.XrayTubeVoltagekVDropDownLabel.Position = [5 164 133 22];
            app.XrayTubeVoltagekVDropDownLabel.Text = 'X-ray Tube Voltage (kV)';

            % Create XrayTubeVoltagekVDropDown
            app.XrayTubeVoltagekVDropDown = uidropdown(app.InputParametersforStressStudyPanelStressOnly);
            app.XrayTubeVoltagekVDropDown.Items = {'80', '100', '120'};
            app.XrayTubeVoltagekVDropDown.ValueChangedFcn = createCallbackFcn(app, @XrayTubeVoltagekVDropDownValueChanged, true);
            app.XrayTubeVoltagekVDropDown.Position = [232 164 142 22];
            app.XrayTubeVoltagekVDropDown.Value = '80';

            % Create RestorStressConditionDropDownLabel
            app.RestorStressConditionDropDownLabel = uilabel(app.InputParametersforStressStudyPanelStressOnly);
            app.RestorStressConditionDropDownLabel.Position = [5 193 136 22];
            app.RestorStressConditionDropDownLabel.Text = 'Rest or Stress Condition';

            % Create RestorStressConditionDropDown
            app.RestorStressConditionDropDown = uidropdown(app.InputParametersforStressStudyPanelStressOnly);
            app.RestorStressConditionDropDown.Items = {'Rest', 'Stress'};
            app.RestorStressConditionDropDown.ValueChangedFcn = createCallbackFcn(app, @RestorStressConditionDropDownValueChanged, true);
            app.RestorStressConditionDropDown.Position = [231 193 143 22];
            app.RestorStressConditionDropDown.Value = 'Rest';

            % Create CoronaryArteryDropDownLabel
            app.CoronaryArteryDropDownLabel = uilabel(app.InputParametersforStressStudyPanelStressOnly);
            app.CoronaryArteryDropDownLabel.Position = [5 253 90 22];
            app.CoronaryArteryDropDownLabel.Text = 'Coronary Artery';

            % Create CoronaryArteryDropDown
            app.CoronaryArteryDropDown = uidropdown(app.InputParametersforStressStudyPanelStressOnly);
            app.CoronaryArteryDropDown.Items = {'RCA', 'LM', 'LAD', 'LCX'};
            app.CoronaryArteryDropDown.ValueChangedFcn = createCallbackFcn(app, @CoronaryArteryDropDownValueChanged, true);
            app.CoronaryArteryDropDown.Position = [231 253 143 22];
            app.CoronaryArteryDropDown.Value = 'RCA';

            % Create MarkBranchCheckBox
            app.MarkBranchCheckBox = uicheckbox(app.InputParametersforStressStudyPanelStressOnly);
            app.MarkBranchCheckBox.ValueChangedFcn = createCallbackFcn(app, @MarkBranchCheckBoxValueChanged, true);
            app.MarkBranchCheckBox.Text = 'Mark Branch';
            app.MarkBranchCheckBox.Position = [400 53 90 22];

            % Create CoronaryDominanceDropDownLabel
            app.CoronaryDominanceDropDownLabel = uilabel(app.InputParametersforStressStudyPanelStressOnly);
            app.CoronaryDominanceDropDownLabel.Position = [3 222 119 22];
            app.CoronaryDominanceDropDownLabel.Text = 'Coronary Dominance';

            % Create CoronaryDominanceDropDown
            app.CoronaryDominanceDropDown = uidropdown(app.InputParametersforStressStudyPanelStressOnly);
            app.CoronaryDominanceDropDown.Items = {'Right', 'Left', 'Co'};
            app.CoronaryDominanceDropDown.ValueChangedFcn = createCallbackFcn(app, @CoronaryDominanceDropDownValueChanged, true);
            app.CoronaryDominanceDropDown.Position = [231 224 143 22];
            app.CoronaryDominanceDropDown.Value = 'Right';

            % Create OutputParametersPanelStressOnly
            app.OutputParametersPanelStressOnly = uipanel(app.StressOnly);
            app.OutputParametersPanelStressOnly.AutoResizeChildren = 'off';
            app.OutputParametersPanelStressOnly.ForegroundColor = [0 0.4471 0.7412];
            app.OutputParametersPanelStressOnly.Title = 'Output Parameters                                  ';
            app.OutputParametersPanelStressOnly.FontWeight = 'bold';
            app.OutputParametersPanelStressOnly.Position = [1183 10 435 210];

            % Create FFREditField_2Label
            app.FFREditField_2Label = uilabel(app.OutputParametersPanelStressOnly);
            app.FFREditField_2Label.Position = [4 155 29 22];
            app.FFREditField_2Label.Text = 'FFR';

            % Create FFREditFieldStressOnly
            app.FFREditFieldStressOnly = uieditfield(app.OutputParametersPanelStressOnly, 'text');
            app.FFREditFieldStressOnly.Position = [282 155 143 22];

            % Create PrelesionFlowVelocitycmsEditField_2Label
            app.PrelesionFlowVelocitycmsEditField_2Label = uilabel(app.OutputParametersPanelStressOnly);
            app.PrelesionFlowVelocitycmsEditField_2Label.Position = [4 125 170 22];
            app.PrelesionFlowVelocitycmsEditField_2Label.Text = 'Pre-lesion Flow Velocity (cm/s)';

            % Create PrelesionFlowVelocitycmsEditFieldStressOnly
            app.PrelesionFlowVelocitycmsEditFieldStressOnly = uieditfield(app.OutputParametersPanelStressOnly, 'text');
            app.PrelesionFlowVelocitycmsEditFieldStressOnly.Position = [282 125 143 22];

            % Create PostlesionFlowVelocitycmsEditField_2Label
            app.PostlesionFlowVelocitycmsEditField_2Label = uilabel(app.OutputParametersPanelStressOnly);
            app.PostlesionFlowVelocitycmsEditField_2Label.Position = [3 95 175 22];
            app.PostlesionFlowVelocitycmsEditField_2Label.Text = 'Post-lesion Flow Velocity (cm/s)';

            % Create PostlesionFlowVelocitycmsEditFieldStressOnly
            app.PostlesionFlowVelocitycmsEditFieldStressOnly = uieditfield(app.OutputParametersPanelStressOnly, 'text');
            app.PostlesionFlowVelocitycmsEditFieldStressOnly.Position = [282 95 143 22];

            % Create PrelesionShearStressPaEditField_2Label
            app.PrelesionShearStressPaEditField_2Label = uilabel(app.OutputParametersPanelStressOnly);
            app.PrelesionShearStressPaEditField_2Label.Position = [4 65 158 22];
            app.PrelesionShearStressPaEditField_2Label.Text = 'Pre-lesion Shear Stress (Pa)';

            % Create PrelesionShearStressPaEditFieldStressOnly
            app.PrelesionShearStressPaEditFieldStressOnly = uieditfield(app.OutputParametersPanelStressOnly, 'text');
            app.PrelesionShearStressPaEditFieldStressOnly.Position = [282 65 143 22];

            % Create PostlesionShearStressPaEditField_2Label
            app.PostlesionShearStressPaEditField_2Label = uilabel(app.OutputParametersPanelStressOnly);
            app.PostlesionShearStressPaEditField_2Label.Position = [5 37 164 22];
            app.PostlesionShearStressPaEditField_2Label.Text = 'Post-lesion Shear Stress (Pa)';

            % Create PostlesionShearStressPaEditFieldStressOnly
            app.PostlesionShearStressPaEditFieldStressOnly = uieditfield(app.OutputParametersPanelStressOnly, 'text');
            app.PostlesionShearStressPaEditFieldStressOnly.Position = [282 34 143 22];

            % Create ClearOutputsButtonStressOnly
            app.ClearOutputsButtonStressOnly = uibutton(app.OutputParametersPanelStressOnly, 'push');
            app.ClearOutputsButtonStressOnly.ButtonPushedFcn = createCallbackFcn(app, @ClearOutputsButtonStressOnlyPushed, true);
            app.ClearOutputsButtonStressOnly.Position = [184 4 100 22];
            app.ClearOutputsButtonStressOnly.Text = 'Clear Outputs';

            % Create StressLabelStressOnly
            app.StressLabelStressOnly = uilabel(app.OutputParametersPanelStressOnly);
            app.StressLabelStressOnly.FontColor = [0 0.4471 0.7412];
            app.StressLabelStressOnly.Visible = 'off';
            app.StressLabelStressOnly.Position = [276 189 40 22];
            app.StressLabelStressOnly.Text = 'Stress';

            % Create DynamicAngiographicImagingDAIVeraPanel_2
            app.DynamicAngiographicImagingDAIVeraPanel_2 = uipanel(app.StressOnly);
            app.DynamicAngiographicImagingDAIVeraPanel_2.AutoResizeChildren = 'off';
            app.DynamicAngiographicImagingDAIVeraPanel_2.ForegroundColor = [0 0.4471 0.7412];
            app.DynamicAngiographicImagingDAIVeraPanel_2.BorderType = 'none';
            app.DynamicAngiographicImagingDAIVeraPanel_2.Title = 'Dynamic Angiographic Imaging (DAI) - Vera ';
            app.DynamicAngiographicImagingDAIVeraPanel_2.FontWeight = 'bold';
            app.DynamicAngiographicImagingDAIVeraPanel_2.FontSize = 16;
            app.DynamicAngiographicImagingDAIVeraPanel_2.Position = [18 946 1047 30];

            % Create TimePointsSliderStressOnly
            app.TimePointsSliderStressOnly = uislider(app.StressOnly);
            app.TimePointsSliderStressOnly.Limits = [1 10];
            app.TimePointsSliderStressOnly.MajorTicks = [1 2 3 4 5 6 7 8 9 10];
            app.TimePointsSliderStressOnly.MajorTickLabels = {'1', '2', '3', '4', '5', '6', '7', '8', '9', '10'};
            app.TimePointsSliderStressOnly.ValueChangingFcn = createCallbackFcn(app, @TimePointsSliderStressOnlyValueChanging, true);
            app.TimePointsSliderStressOnly.MinorTicks = [];
            app.TimePointsSliderStressOnly.Position = [105 469 367 3];
            app.TimePointsSliderStressOnly.Value = 1;

            % Create SlicesSliderStressOnly
            app.SlicesSliderStressOnly = uislider(app.StressOnly);
            app.SlicesSliderStressOnly.Limits = [1 52];
            app.SlicesSliderStressOnly.Orientation = 'vertical';
            app.SlicesSliderStressOnly.ValueChangingFcn = createCallbackFcn(app, @SlicesSliderStressOnlyValueChanging, true);
            app.SlicesSliderStressOnly.MinorTicks = [1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52];
            app.SlicesSliderStressOnly.Position = [489 490 3 401];
            app.SlicesSliderStressOnly.Value = 1;

            % Create TimePointsSliderStressOnlyLabel
            app.TimePointsSliderStressOnlyLabel = uilabel(app.StressOnly);
            app.TimePointsSliderStressOnlyLabel.HorizontalAlignment = 'right';
            app.TimePointsSliderStressOnlyLabel.Position = [26 450 68 22];
            app.TimePointsSliderStressOnlyLabel.Text = 'Time Points';

            % Create SlicesSliderStressOnlyLabel
            app.SlicesSliderStressOnlyLabel = uilabel(app.StressOnly);
            app.SlicesSliderStressOnlyLabel.Position = [488 459 94 22];
            app.SlicesSliderStressOnlyLabel.Text = 'Slices';

            % Create SetPreLesionButtonStressOnly
            app.SetPreLesionButtonStressOnly = uibutton(app.StressOnly, 'push');
            app.SetPreLesionButtonStressOnly.ButtonPushedFcn = createCallbackFcn(app, @SetPreLesionButtonStressOnlyPushed, true);
            app.SetPreLesionButtonStressOnly.Position = [216 402 94 22];
            app.SetPreLesionButtonStressOnly.Text = 'Set Pre Lesion';

            % Create SetPostLesionStressOnly
            app.SetPostLesionStressOnly = uibutton(app.StressOnly, 'push');
            app.SetPostLesionStressOnly.ButtonPushedFcn = createCallbackFcn(app, @SetPostLesionStressOnlyButtonPushed, true);
            app.SetPostLesionStressOnly.Position = [315 402 100 22];
            app.SetPostLesionStressOnly.Text = 'Set Post Lesion';

            % Create SetWindowLevelStressOnly
            app.SetWindowLevelStressOnly = uitextarea(app.StressOnly);
            app.SetWindowLevelStressOnly.Placeholder = 'Level';
            app.SetWindowLevelStressOnly.Position = [29 401 48 24];

            % Create SetWindowButtonStressOnly
            app.SetWindowButtonStressOnly = uibutton(app.StressOnly, 'push');
            app.SetWindowButtonStressOnly.ButtonPushedFcn = createCallbackFcn(app, @SetWindowButtonStressOnlyPushed, true);
            app.SetWindowButtonStressOnly.Position = [137 402 74 22];
            app.SetWindowButtonStressOnly.Text = 'Set Window';

            % Create SetWindowWidthStressOnly
            app.SetWindowWidthStressOnly = uitextarea(app.StressOnly);
            app.SetWindowWidthStressOnly.Placeholder = 'Width';
            app.SetWindowWidthStressOnly.Position = [83 401 48 24];

            % Create FitCurvesButtonStressOnly
            app.FitCurvesButtonStressOnly = uibutton(app.StressOnly, 'push');
            app.FitCurvesButtonStressOnly.ButtonPushedFcn = createCallbackFcn(app, @FitCurvesButtonStressOnlyPushed, true);
            app.FitCurvesButtonStressOnly.Position = [1268 949 66 22];
            app.FitCurvesButtonStressOnly.Text = 'Fit Curves';

            % Create ManualBaselineInputStressOnly
            app.ManualBaselineInputStressOnly = uitextarea(app.StressOnly);
            app.ManualBaselineInputStressOnly.Position = [1381 950 35 23];

            % Create SosLabPropertyLabelStressOnly
            app.SosLabPropertyLabelStressOnly = uilabel(app.StressOnly);
            app.SosLabPropertyLabelStressOnly.HorizontalAlignment = 'right';
            app.SosLabPropertyLabelStressOnly.FontSize = 10;
            app.SosLabPropertyLabelStressOnly.Position = [978 967 82 22];
            app.SosLabPropertyLabelStressOnly.Text = 'So''s Lab Property';

            % Create UnauthorizedUseisProhibitedLabelStressOnly
            app.UnauthorizedUseisProhibitedLabelStressOnly = uilabel(app.StressOnly);
            app.UnauthorizedUseisProhibitedLabelStressOnly.HorizontalAlignment = 'right';
            app.UnauthorizedUseisProhibitedLabelStressOnly.WordWrap = 'on';
            app.UnauthorizedUseisProhibitedLabelStressOnly.FontSize = 10;
            app.UnauthorizedUseisProhibitedLabelStressOnly.FontColor = [1 0 0];
            app.UnauthorizedUseisProhibitedLabelStressOnly.Position = [875 958 186 14];
            app.UnauthorizedUseisProhibitedLabelStressOnly.Text = 'Unauthorized Use is Prohibited';

            % Create StressStudyLabelStressOnly
            app.StressStudyLabelStressOnly = uilabel(app.StressOnly);
            app.StressStudyLabelStressOnly.HorizontalAlignment = 'center';
            app.StressStudyLabelStressOnly.FontSize = 13.2;
            app.StressStudyLabelStressOnly.FontWeight = 'bold';
            app.StressStudyLabelStressOnly.FontColor = [0 0.451 0.7412];
            app.StressStudyLabelStressOnly.Position = [23 912 450 22];
            app.StressStudyLabelStressOnly.Text = 'DCE CT Images';

            % Create ManualZoomingCheckBoxStressOnly
            app.ManualZoomingCheckBoxStressOnly = uicheckbox(app.StressOnly);
            app.ManualZoomingCheckBoxStressOnly.Visible = 'off';
            app.ManualZoomingCheckBoxStressOnly.Text = 'Manual Zooming';
            app.ManualZoomingCheckBoxStressOnly.Position = [23 905 111 22];

            % Create veHeightCheckBoxStressOnly
            app.veHeightCheckBoxStressOnly = uicheckbox(app.StressOnly);
            app.veHeightCheckBoxStressOnly.ValueChangedFcn = createCallbackFcn(app, @veHeightCheckBoxStressOnlyValueChanged, true);
            app.veHeightCheckBoxStressOnly.Text = 'Height (+ve)';
            app.veHeightCheckBoxStressOnly.Position = [422 402 88 22];

            % Create ManualWashoutInputStressOnly
            app.ManualWashoutInputStressOnly = uitextarea(app.StressOnly);
            app.ManualWashoutInputStressOnly.Position = [1432 950 35 23];

            % Create SamplingROIDropDownStressOnly
            app.SamplingROIDropDownStressOnly = uidropdown(app.StressOnly);
            app.SamplingROIDropDownStressOnly.Items = {'1x1', '2x2', '3x3', '1x2', '2x1', '20x20', '30x30', '40x40', 'Freehand'};
            app.SamplingROIDropDownStressOnly.ValueChangedFcn = createCallbackFcn(app, @SamplingROIDropDownStressOnlyValueChanged, true);
            app.SamplingROIDropDownStressOnly.Position = [98 364 60 22];
            app.SamplingROIDropDownStressOnly.Value = '2x2';

            % Create SampleROILabel
            app.SampleROILabel = uilabel(app.StressOnly);
            app.SampleROILabel.Position = [27 364 71 22];
            app.SampleROILabel.Text = 'Sample ROI';

            % Create SearchROIDropDownStressOnly
            app.SearchROIDropDownStressOnly = uidropdown(app.StressOnly);
            app.SearchROIDropDownStressOnly.Items = {'6x6', '8x8', '10x10', '12x12', '16x16', '20x20', '30x30', '40x40'};
            app.SearchROIDropDownStressOnly.ValueChangedFcn = createCallbackFcn(app, @SearchROIDropDownStressOnlyValueChanged, true);
            app.SearchROIDropDownStressOnly.Position = [235 364 60 22];
            app.SearchROIDropDownStressOnly.Value = '6x6';

            % Create SearchROIDropDown_2Label_2
            app.SearchROIDropDown_2Label_2 = uilabel(app.StressOnly);
            app.SearchROIDropDown_2Label_2.Position = [165 364 68 22];
            app.SearchROIDropDown_2Label_2.Text = 'Search ROI';

            % Create InterpolateCurrentSliceWithDropDownStressOnly
            app.InterpolateCurrentSliceWithDropDownStressOnly = uidropdown(app.StressOnly);
            app.InterpolateCurrentSliceWithDropDownStressOnly.Items = {'None', 'Previous Slice', 'Next Slice'};
            app.InterpolateCurrentSliceWithDropDownStressOnly.ValueChangedFcn = createCallbackFcn(app, @InterpolateCurrentSliceWithDropDownStressOnlyValueChanged, true);
            app.InterpolateCurrentSliceWithDropDownStressOnly.Position = [469 364 63 22];
            app.InterpolateCurrentSliceWithDropDownStressOnly.Value = 'None';

            % Create InterpolateCurrentSliceWithDropDown_2Label_2
            app.InterpolateCurrentSliceWithDropDown_2Label_2 = uilabel(app.StressOnly);
            app.InterpolateCurrentSliceWithDropDown_2Label_2.Position = [304 364 162 22];
            app.InterpolateCurrentSliceWithDropDown_2Label_2.Text = 'Interpolate Current Slice With';

            % Create RemovePointPreCheckBoxStressOnly
            app.RemovePointPreCheckBoxStressOnly = uicheckbox(app.StressOnly);
            app.RemovePointPreCheckBoxStressOnly.ValueChangedFcn = createCallbackFcn(app, @RemovePointPreCheckBoxStressOnlyValueChanged, true);
            app.RemovePointPreCheckBoxStressOnly.Text = 'Remove Point';
            app.RemovePointPreCheckBoxStressOnly.Position = [1483 946 97 22];

            % Create RemovePointPostCheckBoxStressOnly
            app.RemovePointPostCheckBoxStressOnly = uicheckbox(app.StressOnly);
            app.RemovePointPostCheckBoxStressOnly.ValueChangedFcn = createCallbackFcn(app, @RemovePointPostCheckBoxStressOnlyValueChanged, true);
            app.RemovePointPostCheckBoxStressOnly.Text = 'Remove Point';
            app.RemovePointPostCheckBoxStressOnly.Position = [1486 555 97 22];

            % Create GraphAppearanceDropDownLabel
            app.GraphAppearanceDropDownLabel = uilabel(app.StressOnly);
            app.GraphAppearanceDropDownLabel.Position = [635 8 106 22];
            app.GraphAppearanceDropDownLabel.Text = 'Graph Appearance';

            % Create GraphAppearanceDropDown
            app.GraphAppearanceDropDown = uidropdown(app.StressOnly);
            app.GraphAppearanceDropDown.Items = {'Straight Line', 'Smooth Line', 'Add Marker', 'Remove Marker'};
            app.GraphAppearanceDropDown.ValueChangedFcn = createCallbackFcn(app, @GraphAppearanceDropDownValueChanged, true);
            app.GraphAppearanceDropDown.Position = [746 8 120 22];
            app.GraphAppearanceDropDown.Value = 'Straight Line';

            % Create FlipSliceNumbersCheckBox
            app.FlipSliceNumbersCheckBox = uicheckbox(app.StressOnly);
            app.FlipSliceNumbersCheckBox.ValueChangedFcn = createCallbackFcn(app, @FlipSliceNumbersCheckBoxValueChanged, true);
            app.FlipSliceNumbersCheckBox.Text = 'Flip Slice Numbers';
            app.FlipSliceNumbersCheckBox.Position = [935 8 123 22];

            % Create SlicesSliderCTAStressOnlyLabel
            app.SlicesSliderCTAStressOnlyLabel = uilabel(app.StressOnly);
            app.SlicesSliderCTAStressOnlyLabel.Position = [1063 463 75 22];
            app.SlicesSliderCTAStressOnlyLabel.Text = 'Slices';

            % Create SlicesSliderCTAStressOnly
            app.SlicesSliderCTAStressOnly = uislider(app.StressOnly);
            app.SlicesSliderCTAStressOnly.Limits = [1 100];
            app.SlicesSliderCTAStressOnly.MajorTicks = [1 11 21 31 41 51 61 71 81 91 100];
            app.SlicesSliderCTAStressOnly.Orientation = 'vertical';
            app.SlicesSliderCTAStressOnly.ValueChangingFcn = createCallbackFcn(app, @SlicesSliderCTAStressOnlyValueChanging, true);
            app.SlicesSliderCTAStressOnly.Position = [1062 499 3 401];
            app.SlicesSliderCTAStressOnly.Value = 1;

            % Create SetWindowLevelCTAStressOnly
            app.SetWindowLevelCTAStressOnly = uitextarea(app.StressOnly);
            app.SetWindowLevelCTAStressOnly.Placeholder = 'Level';
            app.SetWindowLevelCTAStressOnly.Position = [755 410 48 24];

            % Create SetWindowButtonCTAStressOnly
            app.SetWindowButtonCTAStressOnly = uibutton(app.StressOnly, 'push');
            app.SetWindowButtonCTAStressOnly.ButtonPushedFcn = createCallbackFcn(app, @SetWindowButtonCTAStressOnlyPushed, true);
            app.SetWindowButtonCTAStressOnly.Position = [863 411 74 22];
            app.SetWindowButtonCTAStressOnly.Text = 'Set Window';

            % Create SetWindowWidthCTAStressOnly
            app.SetWindowWidthCTAStressOnly = uitextarea(app.StressOnly);
            app.SetWindowWidthCTAStressOnly.Placeholder = 'Width';
            app.SetWindowWidthCTAStressOnly.Position = [809 410 48 24];

            % Create CTAStudyLabelStressOnly
            app.CTAStudyLabelStressOnly = uilabel(app.StressOnly);
            app.CTAStudyLabelStressOnly.HorizontalAlignment = 'center';
            app.CTAStudyLabelStressOnly.FontSize = 13.2;
            app.CTAStudyLabelStressOnly.FontWeight = 'bold';
            app.CTAStudyLabelStressOnly.FontColor = [0 0.451 0.7412];
            app.CTAStudyLabelStressOnly.Position = [633 911 419 22];
            app.CTAStudyLabelStressOnly.Text = 'CTA Images';

            % Create SetLabel
            app.SetLabel = uilabel(app.StressOnly);
            app.SetLabel.Position = [1354 949 28 22];
            app.SetLabel.Text = 'Set';

            % Create BaselineLabel
            app.BaselineLabel = uilabel(app.StressOnly);
            app.BaselineLabel.HorizontalAlignment = 'center';
            app.BaselineLabel.Position = [1373 973 52 22];
            app.BaselineLabel.Text = 'Baseline';

            % Create WashoutLabel
            app.WashoutLabel = uilabel(app.StressOnly);
            app.WashoutLabel.HorizontalAlignment = 'center';
            app.WashoutLabel.Position = [1424 973 52 22];
            app.WashoutLabel.Text = 'Washout';

            % Create BaselineLabel_2
            app.BaselineLabel_2 = uilabel(app.StressOnly);
            app.BaselineLabel_2.HorizontalAlignment = 'center';
            app.BaselineLabel_2.Position = [1373 582 52 22];
            app.BaselineLabel_2.Text = 'Baseline';

            % Create ManualBaselineInputStressOnly_2
            app.ManualBaselineInputStressOnly_2 = uitextarea(app.StressOnly);
            app.ManualBaselineInputStressOnly_2.Position = [1381 559 35 23];

            % Create ManualWashoutInputStressOnly_2
            app.ManualWashoutInputStressOnly_2 = uitextarea(app.StressOnly);
            app.ManualWashoutInputStressOnly_2.Position = [1432 559 35 23];

            % Create FitCurvesButtonStressOnly_2
            app.FitCurvesButtonStressOnly_2 = uibutton(app.StressOnly, 'push');
            app.FitCurvesButtonStressOnly_2.ButtonPushedFcn = createCallbackFcn(app, @FitCurvesButtonStressOnly_2Pushed, true);
            app.FitCurvesButtonStressOnly_2.Position = [1268 558 66 22];
            app.FitCurvesButtonStressOnly_2.Text = 'Fit Curves';

            % Create SetLabel_2
            app.SetLabel_2 = uilabel(app.StressOnly);
            app.SetLabel_2.Position = [1354 558 25 22];
            app.SetLabel_2.Text = 'Set';

            % Create WashoutLabel_2
            app.WashoutLabel_2 = uilabel(app.StressOnly);
            app.WashoutLabel_2.Position = [1428 582 52 22];
            app.WashoutLabel_2.Text = 'Washout';

            % Create ClearButton
            app.ClearButton = uibutton(app.StressOnly, 'push');
            app.ClearButton.ButtonPushedFcn = createCallbackFcn(app, @ClearButtonPushed, true);
            app.ClearButton.Position = [874 8 47 22];
            app.ClearButton.Text = 'Clear';

            % Create ClearButton_2
            app.ClearButton_2 = uibutton(app.StressOnly, 'push');
            app.ClearButton_2.ButtonPushedFcn = createCallbackFcn(app, @ClearButton_2Pushed, true);
            app.ClearButton_2.Position = [1213 948 48 23];
            app.ClearButton_2.Text = 'Clear';

            % Create ClearButton_3
            app.ClearButton_3 = uibutton(app.StressOnly, 'push');
            app.ClearButton_3.ButtonPushedFcn = createCallbackFcn(app, @ClearButton_3Pushed, true);
            app.ClearButton_3.Position = [1213 558 48 23];
            app.ClearButton_3.Text = 'Clear';

            % Create EditPointCheckBox
            app.EditPointCheckBox = uicheckbox(app.StressOnly);
            app.EditPointCheckBox.ValueChangedFcn = createCallbackFcn(app, @EditPointCheckBoxValueChanged, true);
            app.EditPointCheckBox.Text = 'Edit Point';
            app.EditPointCheckBox.Position = [1483 967 73 22];

            % Create EditPointCheckBox_2
            app.EditPointCheckBox_2 = uicheckbox(app.StressOnly);
            app.EditPointCheckBox_2.ValueChangedFcn = createCallbackFcn(app, @EditPointCheckBox_2ValueChanged, true);
            app.EditPointCheckBox_2.Text = 'Edit Point';
            app.EditPointCheckBox_2.Position = [1486 574 73 22];

            % Create HUTextArea
            app.HUTextArea = uitextarea(app.StressOnly);
            app.HUTextArea.Visible = 'off';
            app.HUTextArea.Position = [1231 893 85 28];

            % Create HUTextArea_2
            app.HUTextArea_2 = uitextarea(app.StressOnly);
            app.HUTextArea_2.Visible = 'off';
            app.HUTextArea_2.Position = [1237 499 85 28];

            % Create EditField
            app.EditField = uieditfield(app.StressOnly, 'text');
            app.EditField.Editable = 'off';
            app.EditField.HorizontalAlignment = 'center';
            app.EditField.BackgroundColor = [0.502 0.502 0.502];
            app.EditField.Position = [635 470 413 3];

            % Create MButton
            app.MButton = uibutton(app.StressOnly, 'push');
            app.MButton.ButtonPushedFcn = createCallbackFcn(app, @MButtonPushed, true);
            app.MButton.Position = [510 402 21 22];
            app.MButton.Text = 'M';

            % Create StressRestAnalysisTab
            app.StressRestAnalysisTab = uitab(app.TabGroup);
            app.StressRestAnalysisTab.AutoResizeChildren = 'off';
            app.StressRestAnalysisTab.Title = 'Stress-Rest Analysis';
            app.StressRestAnalysisTab.ForegroundColor = 'none';

            % Create ImageAxesRest
            app.ImageAxesRest = uiaxes(app.StressRestAnalysisTab);
            app.ImageAxesRest.XTick = [];
            app.ImageAxesRest.XTickLabel = {'[ ]'};
            app.ImageAxesRest.YTick = [];
            app.ImageAxesRest.Visible = 'off';
            app.ImageAxesRest.Position = [606 475 474 428];

            % Create paPlotArea
            app.paPlotArea = uiaxes(app.StressRestAnalysisTab);
            title(app.paPlotArea, 'Pre Lesion Curve')
            xlabel(app.paPlotArea, 'Time (s)')
            ylabel(app.paPlotArea, 'Enhancement(HU)')
            app.paPlotArea.XLim = [1 10];
            app.paPlotArea.YLim = [-50 500];
            app.paPlotArea.XTick = [1 2 3 4 5 6 7 8 9 10];
            app.paPlotArea.YTick = [-50 50 150 250 350 450];
            app.paPlotArea.Visible = 'off';
            app.paPlotArea.ButtonDownFcn = createCallbackFcn(app, @paPlotAreaButtonDown, true);
            app.paPlotArea.Position = [1204 638 417 307];

            % Create pdPlotArea
            app.pdPlotArea = uiaxes(app.StressRestAnalysisTab);
            title(app.pdPlotArea, 'Post Lesion Curve')
            xlabel(app.pdPlotArea, 'Time(s)')
            ylabel(app.pdPlotArea, 'Enhancement(HU)')
            app.pdPlotArea.XLim = [1 10];
            app.pdPlotArea.YLim = [-50 500];
            app.pdPlotArea.XTick = [1 2 3 4 5 6 7 8 9 10];
            app.pdPlotArea.YTick = [-50 50 150 250 350 450];
            app.pdPlotArea.Visible = 'off';
            app.pdPlotArea.ButtonDownFcn = createCallbackFcn(app, @pdPlotAreaButtonDown, true);
            app.pdPlotArea.Position = [1204 267 415 296];

            % Create ImageAxes
            app.ImageAxes = uiaxes(app.StressRestAnalysisTab);
            app.ImageAxes.XTick = [];
            app.ImageAxes.XTickLabel = {'[ ]'};
            app.ImageAxes.YTick = [];
            app.ImageAxes.Visible = 'off';
            app.ImageAxes.Position = [18 479 463 424];

            % Create OutputParametersPanel
            app.OutputParametersPanel = uipanel(app.StressRestAnalysisTab);
            app.OutputParametersPanel.AutoResizeChildren = 'off';
            app.OutputParametersPanel.ForegroundColor = [0 0.4471 0.7412];
            app.OutputParametersPanel.Title = 'Output Parameters                                  ';
            app.OutputParametersPanel.Visible = 'off';
            app.OutputParametersPanel.Position = [1204 10 414 237];

            % Create StressLabel
            app.StressLabel = uilabel(app.OutputParametersPanel);
            app.StressLabel.HorizontalAlignment = 'center';
            app.StressLabel.FontColor = [0 0.4471 0.7412];
            app.StressLabel.Visible = 'off';
            app.StressLabel.Position = [194 200 100 20];
            app.StressLabel.Text = 'Stress';

            % Create FFREditFieldLabel
            app.FFREditFieldLabel = uilabel(app.OutputParametersPanel);
            app.FFREditFieldLabel.Position = [5 182 29 22];
            app.FFREditFieldLabel.Text = 'FFR';

            % Create FFREditField
            app.FFREditField = uieditfield(app.OutputParametersPanel, 'text');
            app.FFREditField.Position = [193 182 102 22];

            % Create PrelesionFlowVelocitycmsEditFieldLabel
            app.PrelesionFlowVelocitycmsEditFieldLabel = uilabel(app.OutputParametersPanel);
            app.PrelesionFlowVelocitycmsEditFieldLabel.Position = [5 152 170 22];
            app.PrelesionFlowVelocitycmsEditFieldLabel.Text = 'Pre-lesion Flow Velocity (cm/s)';

            % Create PrelesionFlowVelocitycmsEditField
            app.PrelesionFlowVelocitycmsEditField = uieditfield(app.OutputParametersPanel, 'text');
            app.PrelesionFlowVelocitycmsEditField.Position = [193 152 102 22];

            % Create PostlesionFlowVelocitycmsEditFieldLabel
            app.PostlesionFlowVelocitycmsEditFieldLabel = uilabel(app.OutputParametersPanel);
            app.PostlesionFlowVelocitycmsEditFieldLabel.Position = [5 122 175 22];
            app.PostlesionFlowVelocitycmsEditFieldLabel.Text = 'Post-lesion Flow Velocity (cm/s)';

            % Create PostlesionFlowVelocitycmsEditField
            app.PostlesionFlowVelocitycmsEditField = uieditfield(app.OutputParametersPanel, 'text');
            app.PostlesionFlowVelocitycmsEditField.Position = [193 122 102 22];

            % Create PrelesionShearStressPaEditFieldLabel
            app.PrelesionShearStressPaEditFieldLabel = uilabel(app.OutputParametersPanel);
            app.PrelesionShearStressPaEditFieldLabel.Position = [6 92 158 22];
            app.PrelesionShearStressPaEditFieldLabel.Text = 'Pre-lesion Shear Stress (Pa)';

            % Create PrelesionShearStressPaEditField
            app.PrelesionShearStressPaEditField = uieditfield(app.OutputParametersPanel, 'text');
            app.PrelesionShearStressPaEditField.Position = [193 92 102 22];

            % Create PostlesionShearStressPaEditFieldLabel
            app.PostlesionShearStressPaEditFieldLabel = uilabel(app.OutputParametersPanel);
            app.PostlesionShearStressPaEditFieldLabel.Position = [6 64 164 22];
            app.PostlesionShearStressPaEditFieldLabel.Text = 'Post-lesion Shear Stress (Pa)';

            % Create PostlesionShearStressPaEditField
            app.PostlesionShearStressPaEditField = uieditfield(app.OutputParametersPanel, 'text');
            app.PostlesionShearStressPaEditField.Position = [193 63 102 22];

            % Create FFREditFieldRest
            app.FFREditFieldRest = uieditfield(app.OutputParametersPanel, 'text');
            app.FFREditFieldRest.Position = [303 182 102 22];

            % Create PreLesionVelocitycmsEditFieldRest
            app.PreLesionVelocitycmsEditFieldRest = uieditfield(app.OutputParametersPanel, 'text');
            app.PreLesionVelocitycmsEditFieldRest.Position = [303 152 102 22];

            % Create PostLesionVelocitycmsEditFieldRest
            app.PostLesionVelocitycmsEditFieldRest = uieditfield(app.OutputParametersPanel, 'text');
            app.PostLesionVelocitycmsEditFieldRest.Position = [303 122 102 22];

            % Create PreShearStressPaEditFieldRest
            app.PreShearStressPaEditFieldRest = uieditfield(app.OutputParametersPanel, 'text');
            app.PreShearStressPaEditFieldRest.Position = [303 92 102 22];

            % Create PostShearStressPaEditFieldRest
            app.PostShearStressPaEditFieldRest = uieditfield(app.OutputParametersPanel, 'text');
            app.PostShearStressPaEditFieldRest.Position = [304 62 101 22];

            % Create ClearOutputsButton
            app.ClearOutputsButton = uibutton(app.OutputParametersPanel, 'push');
            app.ClearOutputsButton.ButtonPushedFcn = createCallbackFcn(app, @ClearOutputsButtonPushed, true);
            app.ClearOutputsButton.Position = [304 33 100 22];
            app.ClearOutputsButton.Text = 'Clear Outputs';

            % Create PrelesionCFREditFieldLabel
            app.PrelesionCFREditFieldLabel = uilabel(app.OutputParametersPanel);
            app.PrelesionCFREditFieldLabel.Position = [5 34 88 22];
            app.PrelesionCFREditFieldLabel.Text = 'Pre-lesion CFR';

            % Create PrelesionCFREditField
            app.PrelesionCFREditField = uieditfield(app.OutputParametersPanel, 'text');
            app.PrelesionCFREditField.Position = [193 33 102 22];

            % Create PostlesionCFREditFieldLabel
            app.PostlesionCFREditFieldLabel = uilabel(app.OutputParametersPanel);
            app.PostlesionCFREditFieldLabel.Position = [5 5 93 22];
            app.PostlesionCFREditFieldLabel.Text = 'Post-lesion CFR';

            % Create PostlesionCFREditField
            app.PostlesionCFREditField = uieditfield(app.OutputParametersPanel, 'text');
            app.PostlesionCFREditField.Position = [193 4 102 22];

            % Create RestLabel
            app.RestLabel = uilabel(app.OutputParametersPanel);
            app.RestLabel.HorizontalAlignment = 'center';
            app.RestLabel.FontColor = [0 0.4471 0.7412];
            app.RestLabel.Visible = 'off';
            app.RestLabel.Position = [303 200 100 20];
            app.RestLabel.Text = 'Rest';

            % Create ManualWashoutInputRest
            app.ManualWashoutInputRest = uitextarea(app.StressRestAnalysisTab);
            app.ManualWashoutInputRest.FontColor = [0.8 0.8 0.8];
            app.ManualWashoutInputRest.Visible = 'off';
            app.ManualWashoutInputRest.Placeholder = 'Washout';
            app.ManualWashoutInputRest.Position = [1488 952 78 20];

            % Create ManualWashoutInput
            app.ManualWashoutInput = uitextarea(app.StressRestAnalysisTab);
            app.ManualWashoutInput.FontColor = [0.8 0.8 0.8];
            app.ManualWashoutInput.Visible = 'off';
            app.ManualWashoutInput.Placeholder = 'Washout';
            app.ManualWashoutInput.Position = [1488 980 78 20];

            % Create veHeightRestCheckBox
            app.veHeightRestCheckBox = uicheckbox(app.StressRestAnalysisTab);
            app.veHeightRestCheckBox.ValueChangedFcn = createCallbackFcn(app, @veHeightRestCheckBoxValueChanged, true);
            app.veHeightRestCheckBox.Visible = 'off';
            app.veHeightRestCheckBox.Text = '(+ve) Height';
            app.veHeightRestCheckBox.Position = [1013 403 88 22];

            % Create veHeightCheckBox
            app.veHeightCheckBox = uicheckbox(app.StressRestAnalysisTab);
            app.veHeightCheckBox.ValueChangedFcn = createCallbackFcn(app, @veHeightCheckBoxValueChanged, true);
            app.veHeightCheckBox.Visible = 'off';
            app.veHeightCheckBox.Text = '(+ve) Height';
            app.veHeightCheckBox.Position = [423 408 88 22];

            % Create ManualZoomingRestCheckBox
            app.ManualZoomingRestCheckBox = uicheckbox(app.StressRestAnalysisTab);
            app.ManualZoomingRestCheckBox.ValueChangedFcn = createCallbackFcn(app, @ManualZoomingRestCheckBoxValueChanged, true);
            app.ManualZoomingRestCheckBox.Visible = 'off';
            app.ManualZoomingRestCheckBox.Text = 'Manual Zooming';
            app.ManualZoomingRestCheckBox.Position = [612 902 111 22];

            % Create ManualZoomingCheckBox
            app.ManualZoomingCheckBox = uicheckbox(app.StressRestAnalysisTab);
            app.ManualZoomingCheckBox.ValueChangedFcn = createCallbackFcn(app, @ManualZoomingCheckBoxValueChanged, true);
            app.ManualZoomingCheckBox.Visible = 'off';
            app.ManualZoomingCheckBox.Text = 'Manual Zooming';
            app.ManualZoomingCheckBox.Position = [23 903 111 22];

            % Create ManualBaselineInputRest
            app.ManualBaselineInputRest = uitextarea(app.StressRestAnalysisTab);
            app.ManualBaselineInputRest.FontColor = [0.8 0.8 0.8];
            app.ManualBaselineInputRest.Visible = 'off';
            app.ManualBaselineInputRest.Placeholder = 'Baseline';
            app.ManualBaselineInputRest.Position = [1386 952 84 20];

            % Create FitCurvesButtonRest
            app.FitCurvesButtonRest = uibutton(app.StressRestAnalysisTab, 'push');
            app.FitCurvesButtonRest.ButtonPushedFcn = createCallbackFcn(app, @FitCurvesButtonRestPushed, true);
            app.FitCurvesButtonRest.Visible = 'off';
            app.FitCurvesButtonRest.Position = [1253 951 102 22];
            app.FitCurvesButtonRest.Text = 'Fit Rest Curve';

            % Create StressTestLabel
            app.StressTestLabel = uilabel(app.StressRestAnalysisTab);
            app.StressTestLabel.HorizontalAlignment = 'center';
            app.StressTestLabel.FontWeight = 'bold';
            app.StressTestLabel.FontColor = [0 0.451 0.7412];
            app.StressTestLabel.Visible = 'off';
            app.StressTestLabel.Position = [23 934 450 22];
            app.StressTestLabel.Text = 'Stress Test';

            % Create InputParametersforRestTestPanel
            app.InputParametersforRestTestPanel = uipanel(app.StressRestAnalysisTab);
            app.InputParametersforRestTestPanel.AutoResizeChildren = 'off';
            app.InputParametersforRestTestPanel.ForegroundColor = [0 0.451 0.7412];
            app.InputParametersforRestTestPanel.Title = 'Input Parameters for Rest Test';
            app.InputParametersforRestTestPanel.Visible = 'off';
            app.InputParametersforRestTestPanel.Position = [612 43 476 276];

            % Create ContrastVolumemLLabel
            app.ContrastVolumemLLabel = uilabel(app.InputParametersforRestTestPanel);
            app.ContrastVolumemLLabel.Position = [4 224 122 22];
            app.ContrastVolumemLLabel.Text = 'Contrast Volume (mL)';

            % Create ContrastVolumemLEditFieldRest
            app.ContrastVolumemLEditFieldRest = uieditfield(app.InputParametersforRestTestPanel, 'text');
            app.ContrastVolumemLEditFieldRest.Position = [231 224 122 22];

            % Create PostlesionLumenRadiuscmLabel
            app.PostlesionLumenRadiuscmLabel = uilabel(app.InputParametersforRestTestPanel);
            app.PostlesionLumenRadiuscmLabel.Position = [5 68 173 22];
            app.PostlesionLumenRadiuscmLabel.Text = 'Post-lesion Lumen Radius (cm)';

            % Create RadiusPostLesioncmEditFieldRest
            app.RadiusPostLesioncmEditFieldRest = uieditfield(app.InputParametersforRestTestPanel, 'text');
            app.RadiusPostLesioncmEditFieldRest.Position = [231 68 122 22];

            % Create PrelesionLumenRadiuscmLabel
            app.PrelesionLumenRadiuscmLabel = uilabel(app.InputParametersforRestTestPanel);
            app.PrelesionLumenRadiuscmLabel.Position = [5 94 171 22];
            app.PrelesionLumenRadiuscmLabel.Text = 'Pre-lesion Lumen Radius  (cm)';

            % Create RadiusPreLesioncmEditFieldRest
            app.RadiusPreLesioncmEditFieldRest = uieditfield(app.InputParametersforRestTestPanel, 'text');
            app.RadiusPreLesioncmEditFieldRest.Position = [231 94 122 22];

            % Create AorticBloodPressuremmHgLabel_2
            app.AorticBloodPressuremmHgLabel_2 = uilabel(app.InputParametersforRestTestPanel);
            app.AorticBloodPressuremmHgLabel_2.Position = [5 42 168 22];
            app.AorticBloodPressuremmHgLabel_2.Text = 'Aortic Blood Pressure (mmHg)';

            % Create SystolicBloodPressuremmHgEditFieldRest
            app.SystolicBloodPressuremmHgEditFieldRest = uieditfield(app.InputParametersforRestTestPanel, 'text');
            app.SystolicBloodPressuremmHgEditFieldRest.Position = [231 42 122 22];

            % Create ContrastConcentrationmglmLLabel
            app.ContrastConcentrationmglmLLabel = uilabel(app.InputParametersforRestTestPanel);
            app.ContrastConcentrationmglmLLabel.Position = [4 198 186 22];
            app.ContrastConcentrationmglmLLabel.Text = 'Contrast Concentration (mg l /mL)';

            % Create ConcentrationofContrastmglmLEditFieldRest
            app.ConcentrationofContrastmglmLEditFieldRest = uieditfield(app.InputParametersforRestTestPanel, 'text');
            app.ConcentrationofContrastmglmLEditFieldRest.Position = [231 198 122 22];

            % Create FrictionFactorButtonGroupRest
            app.FrictionFactorButtonGroupRest = uibuttongroup(app.InputParametersforRestTestPanel);
            app.FrictionFactorButtonGroupRest.AutoResizeChildren = 'off';
            app.FrictionFactorButtonGroupRest.SelectionChangedFcn = createCallbackFcn(app, @FrictionFactorButtonGroupRestSelectionChanged, true);
            app.FrictionFactorButtonGroupRest.Title = 'Friction Factor';
            app.FrictionFactorButtonGroupRest.Position = [360 96 109 69];

            % Create ChurchillButtonRest
            app.ChurchillButtonRest = uiradiobutton(app.FrictionFactorButtonGroupRest);
            app.ChurchillButtonRest.Text = 'Churchill';
            app.ChurchillButtonRest.Position = [11 23 69 22];

            % Create ColebrookButtonRest
            app.ColebrookButtonRest = uiradiobutton(app.FrictionFactorButtonGroupRest);
            app.ColebrookButtonRest.Text = 'Colebrook';
            app.ColebrookButtonRest.Position = [11 1 77 22];
            app.ColebrookButtonRest.Value = true;

            % Create ArteryTypeButtonGroupRest
            app.ArteryTypeButtonGroupRest = uibuttongroup(app.InputParametersforRestTestPanel);
            app.ArteryTypeButtonGroupRest.AutoResizeChildren = 'off';
            app.ArteryTypeButtonGroupRest.SelectionChangedFcn = createCallbackFcn(app, @ArteryTypeButtonGroupRestSelectionChanged, true);
            app.ArteryTypeButtonGroupRest.Title = 'Artery Type';
            app.ArteryTypeButtonGroupRest.Position = [360 18 109 69];

            % Create CoronaryButtonRest
            app.CoronaryButtonRest = uiradiobutton(app.ArteryTypeButtonGroupRest);
            app.CoronaryButtonRest.Text = 'Coronary';
            app.CoronaryButtonRest.Position = [11 23 71 22];
            app.CoronaryButtonRest.Value = true;

            % Create AortaButtonRest
            app.AortaButtonRest = uiradiobutton(app.ArteryTypeButtonGroupRest);
            app.AortaButtonRest.Text = 'Aorta';
            app.AortaButtonRest.Position = [11 1 51 22];

            % Create PrelesionTracerPercentageLabel
            app.PrelesionTracerPercentageLabel = uilabel(app.InputParametersforRestTestPanel);
            app.PrelesionTracerPercentageLabel.Position = [5 146 184 22];
            app.PrelesionTracerPercentageLabel.Text = 'Pre-lesion Tracer Percentage (%)';

            % Create PreTracerPercentageEditFieldRest
            app.PreTracerPercentageEditFieldRest = uieditfield(app.InputParametersforRestTestPanel, 'text');
            app.PreTracerPercentageEditFieldRest.Position = [231 146 122 22];

            % Create PostlesionTracerPercentageLabel
            app.PostlesionTracerPercentageLabel = uilabel(app.InputParametersforRestTestPanel);
            app.PostlesionTracerPercentageLabel.Position = [5 120 190 22];
            app.PostlesionTracerPercentageLabel.Text = 'Post-lesion Tracer Percentage (%)';

            % Create PostTracerPercentageEditFieldRest
            app.PostTracerPercentageEditFieldRest = uieditfield(app.InputParametersforRestTestPanel, 'text');
            app.PostTracerPercentageEditFieldRest.Position = [231 120 122 22];

            % Create ConversionFactorHUpermgImLLabel_2
            app.ConversionFactorHUpermgImLLabel_2 = uilabel(app.InputParametersforRestTestPanel);
            app.ConversionFactorHUpermgImLLabel_2.Position = [5 172 204 22];
            app.ConversionFactorHUpermgImLLabel_2.Text = 'Conversion Factor (HU per mg I /mL)';

            % Create ConversionFactorEditFieldRest
            app.ConversionFactorEditFieldRest = uieditfield(app.InputParametersforRestTestPanel, 'text');
            app.ConversionFactorEditFieldRest.Position = [231 172 122 22];

            % Create SystolicBloodPressuremmHgEditField_2Label_3
            app.SystolicBloodPressuremmHgEditField_2Label_3 = uilabel(app.InputParametersforRestTestPanel);
            app.SystolicBloodPressuremmHgEditField_2Label_3.Position = [5 16 135 22];
            app.SystolicBloodPressuremmHgEditField_2Label_3.Text = 'Arterial Roughness (cm)';

            % Create ArterialRoughnessRest
            app.ArterialRoughnessRest = uieditfield(app.InputParametersforRestTestPanel, 'text');
            app.ArterialRoughnessRest.Position = [231 16 122 22];

            % Create OutputButtonRest
            app.OutputButtonRest = uibutton(app.InputParametersforRestTestPanel, 'push');
            app.OutputButtonRest.ButtonPushedFcn = createCallbackFcn(app, @OutputButtonRestPushed, true);
            app.OutputButtonRest.Position = [360 224 109 22];
            app.OutputButtonRest.Text = 'Compute';

            % Create ClearInputsButtonRest
            app.ClearInputsButtonRest = uibutton(app.InputParametersforRestTestPanel, 'push');
            app.ClearInputsButtonRest.ButtonPushedFcn = createCallbackFcn(app, @ClearInputsButtonRestPushed, true);
            app.ClearInputsButtonRest.Position = [360 197 109 22];
            app.ClearInputsButtonRest.Text = 'Clear Inputs';

            % Create CopyStressInputsButton
            app.CopyStressInputsButton = uibutton(app.InputParametersforRestTestPanel, 'push');
            app.CopyStressInputsButton.ButtonPushedFcn = createCallbackFcn(app, @CopyStressInputsButtonPushed, true);
            app.CopyStressInputsButton.Position = [360 170 109 22];
            app.CopyStressInputsButton.Text = 'Copy Stress Inputs';

            % Create RestTestLabel
            app.RestTestLabel = uilabel(app.StressRestAnalysisTab);
            app.RestTestLabel.HorizontalAlignment = 'center';
            app.RestTestLabel.FontWeight = 'bold';
            app.RestTestLabel.FontColor = [0 0.451 0.7412];
            app.RestTestLabel.Visible = 'off';
            app.RestTestLabel.Position = [611 934 469 22];
            app.RestTestLabel.Text = 'Rest Test';

            % Create SetWindowWidthRest
            app.SetWindowWidthRest = uitextarea(app.StressRestAnalysisTab);
            app.SetWindowWidthRest.Visible = 'off';
            app.SetWindowWidthRest.Placeholder = 'Width';
            app.SetWindowWidthRest.Position = [666 402 48 24];

            % Create SetWindowButtonRest
            app.SetWindowButtonRest = uibutton(app.StressRestAnalysisTab, 'push');
            app.SetWindowButtonRest.ButtonPushedFcn = createCallbackFcn(app, @SetWindowButtonRestPushed, true);
            app.SetWindowButtonRest.Visible = 'off';
            app.SetWindowButtonRest.Position = [720 403 74 22];
            app.SetWindowButtonRest.Text = 'Set Window';

            % Create SetWindowLevelRest
            app.SetWindowLevelRest = uitextarea(app.StressRestAnalysisTab);
            app.SetWindowLevelRest.Visible = 'off';
            app.SetWindowLevelRest.Placeholder = 'Level';
            app.SetWindowLevelRest.Position = [612 402 48 24];

            % Create SetPostLesionButtonRest
            app.SetPostLesionButtonRest = uibutton(app.StressRestAnalysisTab, 'push');
            app.SetPostLesionButtonRest.ButtonPushedFcn = createCallbackFcn(app, @SetPostLesionButtonRestPushed, true);
            app.SetPostLesionButtonRest.Visible = 'off';
            app.SetPostLesionButtonRest.Position = [904 403 100 22];
            app.SetPostLesionButtonRest.Text = 'Set Post Lesion';

            % Create SetPreLesionButtonRest
            app.SetPreLesionButtonRest = uibutton(app.StressRestAnalysisTab, 'push');
            app.SetPreLesionButtonRest.ButtonPushedFcn = createCallbackFcn(app, @SetPreLesionButtonRestPushed, true);
            app.SetPreLesionButtonRest.Visible = 'off';
            app.SetPreLesionButtonRest.Position = [802 403 94 22];
            app.SetPreLesionButtonRest.Text = 'Set Pre Lesion';

            % Create SlicesSliderLabelRest
            app.SlicesSliderLabelRest = uilabel(app.StressRestAnalysisTab);
            app.SlicesSliderLabelRest.Visible = 'off';
            app.SlicesSliderLabelRest.Position = [1086 454 66 22];
            app.SlicesSliderLabelRest.Text = 'Slices';

            % Create TimePointsSliderLabelRest
            app.TimePointsSliderLabelRest = uilabel(app.StressRestAnalysisTab);
            app.TimePointsSliderLabelRest.HorizontalAlignment = 'right';
            app.TimePointsSliderLabelRest.Visible = 'off';
            app.TimePointsSliderLabelRest.Position = [606 445 68 22];
            app.TimePointsSliderLabelRest.Text = 'Time Points';

            % Create SlicesSliderRest
            app.SlicesSliderRest = uislider(app.StressRestAnalysisTab);
            app.SlicesSliderRest.Limits = [1 52];
            app.SlicesSliderRest.Orientation = 'vertical';
            app.SlicesSliderRest.ValueChangingFcn = createCallbackFcn(app, @SlicesSliderRestValueChanging, true);
            app.SlicesSliderRest.MinorTicks = [1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52];
            app.SlicesSliderRest.Visible = 'off';
            app.SlicesSliderRest.Position = [1087 485 3 409];
            app.SlicesSliderRest.Value = 1;

            % Create TimePointsSliderRest
            app.TimePointsSliderRest = uislider(app.StressRestAnalysisTab);
            app.TimePointsSliderRest.Limits = [1 10];
            app.TimePointsSliderRest.MajorTicks = [1 2 3 4 5 6 7 8 9 10];
            app.TimePointsSliderRest.MajorTickLabels = {'1', '2', '3', '4', '5', '6', '7', '8', '9', '10'};
            app.TimePointsSliderRest.ValueChangingFcn = createCallbackFcn(app, @TimePointsSliderRestValueChanging, true);
            app.TimePointsSliderRest.MinorTicks = [];
            app.TimePointsSliderRest.Visible = 'off';
            app.TimePointsSliderRest.Position = [685 464 373 3];
            app.TimePointsSliderRest.Value = 1;

            % Create ManualBaselineInput
            app.ManualBaselineInput = uitextarea(app.StressRestAnalysisTab);
            app.ManualBaselineInput.ValueChangedFcn = createCallbackFcn(app, @ManualBaselineInputValueChanged, true);
            app.ManualBaselineInput.FontColor = [0.8 0.8 0.8];
            app.ManualBaselineInput.Visible = 'off';
            app.ManualBaselineInput.Placeholder = 'Baseline';
            app.ManualBaselineInput.Position = [1386 980 84 20];

            % Create FitStressCurveButton
            app.FitStressCurveButton = uibutton(app.StressRestAnalysisTab, 'push');
            app.FitStressCurveButton.ButtonPushedFcn = createCallbackFcn(app, @FitStressCurveButtonPushed, true);
            app.FitStressCurveButton.Visible = 'off';
            app.FitStressCurveButton.Position = [1253 979 102 22];
            app.FitStressCurveButton.Text = 'Fit Stress Curve';

            % Create SetWindowWidth
            app.SetWindowWidth = uitextarea(app.StressRestAnalysisTab);
            app.SetWindowWidth.Visible = 'off';
            app.SetWindowWidth.Placeholder = 'Width';
            app.SetWindowWidth.Position = [83 407 48 24];

            % Create SetWindowButton
            app.SetWindowButton = uibutton(app.StressRestAnalysisTab, 'push');
            app.SetWindowButton.ButtonPushedFcn = createCallbackFcn(app, @SetWindowButtonPushed, true);
            app.SetWindowButton.Visible = 'off';
            app.SetWindowButton.Position = [137 408 74 22];
            app.SetWindowButton.Text = 'Set Window';

            % Create SetWindowLevel
            app.SetWindowLevel = uitextarea(app.StressRestAnalysisTab);
            app.SetWindowLevel.ValueChangedFcn = createCallbackFcn(app, @SetWindowLevelValueChanged, true);
            app.SetWindowLevel.Visible = 'off';
            app.SetWindowLevel.Placeholder = 'Level';
            app.SetWindowLevel.Position = [29 407 48 24];

            % Create SetPostLesionButton
            app.SetPostLesionButton = uibutton(app.StressRestAnalysisTab, 'push');
            app.SetPostLesionButton.ButtonPushedFcn = createCallbackFcn(app, @SetPostLesionButtonPushed, true);
            app.SetPostLesionButton.Visible = 'off';
            app.SetPostLesionButton.Position = [315 408 100 22];
            app.SetPostLesionButton.Text = 'Set Post Lesion';

            % Create SetPreLesionButton
            app.SetPreLesionButton = uibutton(app.StressRestAnalysisTab, 'push');
            app.SetPreLesionButton.ButtonPushedFcn = createCallbackFcn(app, @SetPreLesionButtonPushed, true);
            app.SetPreLesionButton.Visible = 'off';
            app.SetPreLesionButton.Position = [216 408 94 22];
            app.SetPreLesionButton.Text = 'Set Pre Lesion';

            % Create SlicesSlider_2Label
            app.SlicesSlider_2Label = uilabel(app.StressRestAnalysisTab);
            app.SlicesSlider_2Label.Visible = 'off';
            app.SlicesSlider_2Label.Position = [488 456 66 22];
            app.SlicesSlider_2Label.Text = 'Slices';

            % Create TimePointsSlider_2Label
            app.TimePointsSlider_2Label = uilabel(app.StressRestAnalysisTab);
            app.TimePointsSlider_2Label.HorizontalAlignment = 'right';
            app.TimePointsSlider_2Label.Visible = 'off';
            app.TimePointsSlider_2Label.Position = [26 447 68 22];
            app.TimePointsSlider_2Label.Text = 'Time Points';

            % Create SlicesSlider
            app.SlicesSlider = uislider(app.StressRestAnalysisTab);
            app.SlicesSlider.Limits = [1 52];
            app.SlicesSlider.Orientation = 'vertical';
            app.SlicesSlider.ValueChangedFcn = createCallbackFcn(app, @SlicesSliderValueChanged, true);
            app.SlicesSlider.ValueChangingFcn = createCallbackFcn(app, @SlicesSliderValueChanging, true);
            app.SlicesSlider.MinorTicks = [1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52];
            app.SlicesSlider.Visible = 'off';
            app.SlicesSlider.Position = [489 487 3 401];
            app.SlicesSlider.Value = 1;

            % Create TimePointsSlider
            app.TimePointsSlider = uislider(app.StressRestAnalysisTab);
            app.TimePointsSlider.Limits = [1 10];
            app.TimePointsSlider.MajorTicks = [1 2 3 4 5 6 7 8 9 10];
            app.TimePointsSlider.MajorTickLabels = {'1', '2', '3', '4', '5', '6', '7', '8', '9', '10'};
            app.TimePointsSlider.ValueChangedFcn = createCallbackFcn(app, @TimePointsSliderValueChanged, true);
            app.TimePointsSlider.ValueChangingFcn = createCallbackFcn(app, @TimePointsSliderValueChanging, true);
            app.TimePointsSlider.MinorTicks = [];
            app.TimePointsSlider.Visible = 'off';
            app.TimePointsSlider.Position = [105 466 367 3];
            app.TimePointsSlider.Value = 1;

            % Create DynamicAngiographicImagingDAIVeraPanel
            app.DynamicAngiographicImagingDAIVeraPanel = uipanel(app.StressRestAnalysisTab);
            app.DynamicAngiographicImagingDAIVeraPanel.AutoResizeChildren = 'off';
            app.DynamicAngiographicImagingDAIVeraPanel.ForegroundColor = [0 0.4471 0.7412];
            app.DynamicAngiographicImagingDAIVeraPanel.BorderType = 'none';
            app.DynamicAngiographicImagingDAIVeraPanel.Title = 'Dynamic Angiographic Imaging (DAI) - Vera';
            app.DynamicAngiographicImagingDAIVeraPanel.Visible = 'off';
            app.DynamicAngiographicImagingDAIVeraPanel.FontWeight = 'bold';
            app.DynamicAngiographicImagingDAIVeraPanel.FontSize = 16;
            app.DynamicAngiographicImagingDAIVeraPanel.Position = [18 960 1030 30];

            % Create InputParametersforStressTestPanel
            app.InputParametersforStressTestPanel = uipanel(app.StressRestAnalysisTab);
            app.InputParametersforStressTestPanel.AutoResizeChildren = 'off';
            app.InputParametersforStressTestPanel.ForegroundColor = [0 0.451 0.7412];
            app.InputParametersforStressTestPanel.Title = 'Input Parameters for Stress Test';
            app.InputParametersforStressTestPanel.Visible = 'off';
            app.InputParametersforStressTestPanel.Position = [23 43 460 276];

            % Create ContrastVolumemLEditFieldLabel
            app.ContrastVolumemLEditFieldLabel = uilabel(app.InputParametersforStressTestPanel);
            app.ContrastVolumemLEditFieldLabel.Position = [5 225 122 22];
            app.ContrastVolumemLEditFieldLabel.Text = 'Contrast Volume (mL)';

            % Create ContrastVolumemLEditField
            app.ContrastVolumemLEditField = uieditfield(app.InputParametersforStressTestPanel, 'text');
            app.ContrastVolumemLEditField.ValueChangedFcn = createCallbackFcn(app, @ContrastVolumemLEditFieldValueChanged, true);
            app.ContrastVolumemLEditField.Position = [231 225 112 22];

            % Create PostlesionLumenRadiuscmEditFieldLabel
            app.PostlesionLumenRadiuscmEditFieldLabel = uilabel(app.InputParametersforStressTestPanel);
            app.PostlesionLumenRadiuscmEditFieldLabel.Position = [5 69 173 22];
            app.PostlesionLumenRadiuscmEditFieldLabel.Text = 'Post-lesion Lumen Radius (cm)';

            % Create PostlesionLumenRadiuscmEditField
            app.PostlesionLumenRadiuscmEditField = uieditfield(app.InputParametersforStressTestPanel, 'text');
            app.PostlesionLumenRadiuscmEditField.Position = [231 69 112 22];

            % Create PrelesionLumenRadiuscmEditFieldLabel
            app.PrelesionLumenRadiuscmEditFieldLabel = uilabel(app.InputParametersforStressTestPanel);
            app.PrelesionLumenRadiuscmEditFieldLabel.Position = [5 95 171 22];
            app.PrelesionLumenRadiuscmEditFieldLabel.Text = 'Pre-lesion Lumen Radius  (cm)';

            % Create PrelesionLumenRadiuscmEditField
            app.PrelesionLumenRadiuscmEditField = uieditfield(app.InputParametersforStressTestPanel, 'text');
            app.PrelesionLumenRadiuscmEditField.ValueChangedFcn = createCallbackFcn(app, @PrelesionLumenRadiuscmEditFieldValueChanged, true);
            app.PrelesionLumenRadiuscmEditField.Position = [231 95 112 22];

            % Create AorticBloodPressuremmHgEditFieldLabel
            app.AorticBloodPressuremmHgEditFieldLabel = uilabel(app.InputParametersforStressTestPanel);
            app.AorticBloodPressuremmHgEditFieldLabel.Position = [5 43 168 22];
            app.AorticBloodPressuremmHgEditFieldLabel.Text = 'Aortic Blood Pressure (mmHg)';

            % Create AorticBloodPressuremmHgEditField
            app.AorticBloodPressuremmHgEditField = uieditfield(app.InputParametersforStressTestPanel, 'text');
            app.AorticBloodPressuremmHgEditField.Position = [231 43 112 22];

            % Create ContrastConcentrationmglmLEditFieldLabel
            app.ContrastConcentrationmglmLEditFieldLabel = uilabel(app.InputParametersforStressTestPanel);
            app.ContrastConcentrationmglmLEditFieldLabel.Position = [5 199 186 22];
            app.ContrastConcentrationmglmLEditFieldLabel.Text = 'Contrast Concentration (mg l /mL)';

            % Create ContrastConcentrationmglmLEditField
            app.ContrastConcentrationmglmLEditField = uieditfield(app.InputParametersforStressTestPanel, 'text');
            app.ContrastConcentrationmglmLEditField.ValueChangedFcn = createCallbackFcn(app, @ContrastConcentrationmglmLEditFieldValueChanged, true);
            app.ContrastConcentrationmglmLEditField.Position = [231 199 112 22];

            % Create FrictionFactorButtonGroup
            app.FrictionFactorButtonGroup = uibuttongroup(app.InputParametersforStressTestPanel);
            app.FrictionFactorButtonGroup.AutoResizeChildren = 'off';
            app.FrictionFactorButtonGroup.SelectionChangedFcn = createCallbackFcn(app, @FrictionFactorButtonGroupSelectionChanged, true);
            app.FrictionFactorButtonGroup.Title = 'Friction Factor';
            app.FrictionFactorButtonGroup.Position = [346 97 108 69];

            % Create ChurchillButton
            app.ChurchillButton = uiradiobutton(app.FrictionFactorButtonGroup);
            app.ChurchillButton.Text = 'Churchill';
            app.ChurchillButton.Position = [11 23 69 22];

            % Create ColebrookButton
            app.ColebrookButton = uiradiobutton(app.FrictionFactorButtonGroup);
            app.ColebrookButton.Text = 'Colebrook';
            app.ColebrookButton.Position = [11 1 77 22];
            app.ColebrookButton.Value = true;

            % Create ArteryTypeButtonGroup
            app.ArteryTypeButtonGroup = uibuttongroup(app.InputParametersforStressTestPanel);
            app.ArteryTypeButtonGroup.AutoResizeChildren = 'off';
            app.ArteryTypeButtonGroup.SelectionChangedFcn = createCallbackFcn(app, @ArteryTypeButtonGroupSelectionChanged, true);
            app.ArteryTypeButtonGroup.Title = 'Artery Type';
            app.ArteryTypeButtonGroup.Position = [346 19 108 69];

            % Create CoronaryButton
            app.CoronaryButton = uiradiobutton(app.ArteryTypeButtonGroup);
            app.CoronaryButton.Text = 'Coronary';
            app.CoronaryButton.Position = [11 23 71 22];
            app.CoronaryButton.Value = true;

            % Create AortaButton
            app.AortaButton = uiradiobutton(app.ArteryTypeButtonGroup);
            app.AortaButton.Text = 'Aorta';
            app.AortaButton.Position = [11 1 51 22];

            % Create PrelesionTracerPercentageEditFieldLabel
            app.PrelesionTracerPercentageEditFieldLabel = uilabel(app.InputParametersforStressTestPanel);
            app.PrelesionTracerPercentageEditFieldLabel.Position = [5 147 184 22];
            app.PrelesionTracerPercentageEditFieldLabel.Text = 'Pre-lesion Tracer Percentage (%)';

            % Create PrelesionTracerPercentageEditField
            app.PrelesionTracerPercentageEditField = uieditfield(app.InputParametersforStressTestPanel, 'text');
            app.PrelesionTracerPercentageEditField.Position = [231 147 112 22];

            % Create PostlesionTracerPercentageEditFieldLabel
            app.PostlesionTracerPercentageEditFieldLabel = uilabel(app.InputParametersforStressTestPanel);
            app.PostlesionTracerPercentageEditFieldLabel.Position = [5 121 190 22];
            app.PostlesionTracerPercentageEditFieldLabel.Text = 'Post-lesion Tracer Percentage (%)';

            % Create PostlesionTracerPercentageEditField
            app.PostlesionTracerPercentageEditField = uieditfield(app.InputParametersforStressTestPanel, 'text');
            app.PostlesionTracerPercentageEditField.Position = [231 121 112 22];

            % Create ConversionFactorHUpermgImLLabel
            app.ConversionFactorHUpermgImLLabel = uilabel(app.InputParametersforStressTestPanel);
            app.ConversionFactorHUpermgImLLabel.Position = [5 173 204 22];
            app.ConversionFactorHUpermgImLLabel.Text = 'Conversion Factor (HU per mg I /mL)';

            % Create ConversionFactorEditField
            app.ConversionFactorEditField = uieditfield(app.InputParametersforStressTestPanel, 'text');
            app.ConversionFactorEditField.Position = [231 173 112 22];

            % Create SystolicBloodPressuremmHgEditField_2Label_2
            app.SystolicBloodPressuremmHgEditField_2Label_2 = uilabel(app.InputParametersforStressTestPanel);
            app.SystolicBloodPressuremmHgEditField_2Label_2.Position = [5 17 135 22];
            app.SystolicBloodPressuremmHgEditField_2Label_2.Text = 'Arterial Roughness (cm)';

            % Create ArterialRoughness
            app.ArterialRoughness = uieditfield(app.InputParametersforStressTestPanel, 'text');
            app.ArterialRoughness.Position = [231 17 112 22];

            % Create ComputeButton
            app.ComputeButton = uibutton(app.InputParametersforStressTestPanel, 'push');
            app.ComputeButton.ButtonPushedFcn = createCallbackFcn(app, @ComputeButtonPushed, true);
            app.ComputeButton.Position = [346 225 108 22];
            app.ComputeButton.Text = 'Compute';

            % Create ClearInputsButton
            app.ClearInputsButton = uibutton(app.InputParametersforStressTestPanel, 'push');
            app.ClearInputsButton.ButtonPushedFcn = createCallbackFcn(app, @ClearInputsButtonPushed, true);
            app.ClearInputsButton.Position = [346 198 108 22];
            app.ClearInputsButton.Text = 'Clear Inputs';

            % Create CopyRestInputsButton
            app.CopyRestInputsButton = uibutton(app.InputParametersforStressTestPanel, 'push');
            app.CopyRestInputsButton.ButtonPushedFcn = createCallbackFcn(app, @CopyRestInputsButtonPushed, true);
            app.CopyRestInputsButton.Position = [346 172 108 22];
            app.CopyRestInputsButton.Text = 'Copy Rest Inputs';

            % Create SamplingROIDropDownLabel
            app.SamplingROIDropDownLabel = uilabel(app.StressRestAnalysisTab);
            app.SamplingROIDropDownLabel.Visible = 'off';
            app.SamplingROIDropDownLabel.Position = [29 370 80 22];
            app.SamplingROIDropDownLabel.Text = 'Sampling ROI';

            % Create SamplingROIDropDown
            app.SamplingROIDropDown = uidropdown(app.StressRestAnalysisTab);
            app.SamplingROIDropDown.Items = {'2x2', '3x3', '2x1', '1x2', '1x1'};
            app.SamplingROIDropDown.ValueChangedFcn = createCallbackFcn(app, @SamplingROIDropDownValueChanged, true);
            app.SamplingROIDropDown.Visible = 'off';
            app.SamplingROIDropDown.Position = [110 370 60 22];
            app.SamplingROIDropDown.Value = '2x2';

            % Create SamplingROILabel
            app.SamplingROILabel = uilabel(app.StressRestAnalysisTab);
            app.SamplingROILabel.Visible = 'off';
            app.SamplingROILabel.Position = [611 370 80 22];
            app.SamplingROILabel.Text = 'Sampling ROI';

            % Create ROIDropDownRest
            app.ROIDropDownRest = uidropdown(app.StressRestAnalysisTab);
            app.ROIDropDownRest.Items = {'2x2', '3x3', '2x1', '1x2', '1x1'};
            app.ROIDropDownRest.ValueChangedFcn = createCallbackFcn(app, @ROIDropDownRestValueChanged, true);
            app.ROIDropDownRest.Visible = 'off';
            app.ROIDropDownRest.Position = [693 370 60 22];
            app.ROIDropDownRest.Value = '2x2';

            % Create SearchROIDropDownLabel
            app.SearchROIDropDownLabel = uilabel(app.StressRestAnalysisTab);
            app.SearchROIDropDownLabel.Visible = 'off';
            app.SearchROIDropDownLabel.Position = [173 370 68 22];
            app.SearchROIDropDownLabel.Text = 'Search ROI';

            % Create SearchROIDropDown
            app.SearchROIDropDown = uidropdown(app.StressRestAnalysisTab);
            app.SearchROIDropDown.Items = {'6x6', '8x8', '10x10', '12x12', '16x16', '20x20'};
            app.SearchROIDropDown.ValueChangedFcn = createCallbackFcn(app, @SearchROIDropDownValueChanged, true);
            app.SearchROIDropDown.Visible = 'off';
            app.SearchROIDropDown.Position = [244 370 60 22];
            app.SearchROIDropDown.Value = '6x6';

            % Create SearchROIDropDown_2Label
            app.SearchROIDropDown_2Label = uilabel(app.StressRestAnalysisTab);
            app.SearchROIDropDown_2Label.Visible = 'off';
            app.SearchROIDropDown_2Label.Position = [757 370 68 22];
            app.SearchROIDropDown_2Label.Text = 'Search ROI';

            % Create RestSearchROIDropDown
            app.RestSearchROIDropDown = uidropdown(app.StressRestAnalysisTab);
            app.RestSearchROIDropDown.Items = {'6x6', '8x8', '10x10', '12x12', ''};
            app.RestSearchROIDropDown.ValueChangedFcn = createCallbackFcn(app, @RestSearchROIDropDownValueChanged, true);
            app.RestSearchROIDropDown.Visible = 'off';
            app.RestSearchROIDropDown.Position = [828 370 60 22];
            app.RestSearchROIDropDown.Value = '6x6';

            % Create InterpolateCurrentSliceWithDropDownLabel
            app.InterpolateCurrentSliceWithDropDownLabel = uilabel(app.StressRestAnalysisTab);
            app.InterpolateCurrentSliceWithDropDownLabel.Visible = 'off';
            app.InterpolateCurrentSliceWithDropDownLabel.Position = [308 370 162 22];
            app.InterpolateCurrentSliceWithDropDownLabel.Text = 'Interpolate Current Slice With';

            % Create InterpolateCurrentSliceWithDropDown
            app.InterpolateCurrentSliceWithDropDown = uidropdown(app.StressRestAnalysisTab);
            app.InterpolateCurrentSliceWithDropDown.Items = {'None', 'Previous Slice', 'Next Slice'};
            app.InterpolateCurrentSliceWithDropDown.ValueChangedFcn = createCallbackFcn(app, @InterpolateCurrentSliceWithDropDownValueChanged, true);
            app.InterpolateCurrentSliceWithDropDown.Visible = 'off';
            app.InterpolateCurrentSliceWithDropDown.Position = [472 370 60 22];
            app.InterpolateCurrentSliceWithDropDown.Value = 'None';

            % Create InterpolateCurrentSliceWithDropDown_2Label
            app.InterpolateCurrentSliceWithDropDown_2Label = uilabel(app.StressRestAnalysisTab);
            app.InterpolateCurrentSliceWithDropDown_2Label.Visible = 'off';
            app.InterpolateCurrentSliceWithDropDown_2Label.Position = [891 370 162 22];
            app.InterpolateCurrentSliceWithDropDown_2Label.Text = 'Interpolate Current Slice With';

            % Create InterpolateCurrentSliceWithDropDownRest
            app.InterpolateCurrentSliceWithDropDownRest = uidropdown(app.StressRestAnalysisTab);
            app.InterpolateCurrentSliceWithDropDownRest.Items = {'None', 'Previous Slice', 'Next Slice'};
            app.InterpolateCurrentSliceWithDropDownRest.ValueChangedFcn = createCallbackFcn(app, @InterpolateCurrentSliceWithDropDownRestValueChanged, true);
            app.InterpolateCurrentSliceWithDropDownRest.Visible = 'off';
            app.InterpolateCurrentSliceWithDropDownRest.Position = [1057 370 60 22];
            app.InterpolateCurrentSliceWithDropDownRest.Value = 'None';

            % Create SosLabPropertyLabel
            app.SosLabPropertyLabel = uilabel(app.StressRestAnalysisTab);
            app.SosLabPropertyLabel.HorizontalAlignment = 'right';
            app.SosLabPropertyLabel.FontSize = 10;
            app.SosLabPropertyLabel.Visible = 'off';
            app.SosLabPropertyLabel.Position = [966 983 82 15];
            app.SosLabPropertyLabel.Text = 'So''s Lab Property';

            % Create UnauthorizedUseisProhibitedLabel
            app.UnauthorizedUseisProhibitedLabel = uilabel(app.StressRestAnalysisTab);
            app.UnauthorizedUseisProhibitedLabel.HorizontalAlignment = 'right';
            app.UnauthorizedUseisProhibitedLabel.WordWrap = 'on';
            app.UnauthorizedUseisProhibitedLabel.FontSize = 10;
            app.UnauthorizedUseisProhibitedLabel.FontColor = [1 0 0];
            app.UnauthorizedUseisProhibitedLabel.Visible = 'off';
            app.UnauthorizedUseisProhibitedLabel.Position = [864 971 184 14];
            app.UnauthorizedUseisProhibitedLabel.Text = 'Unauthorized Use is Prohibited';

            % Create ManualWashoutInputRest_2
            app.ManualWashoutInputRest_2 = uitextarea(app.StressRestAnalysisTab);
            app.ManualWashoutInputRest_2.FontColor = [0.8 0.8 0.8];
            app.ManualWashoutInputRest_2.Visible = 'off';
            app.ManualWashoutInputRest_2.Placeholder = 'Washout';
            app.ManualWashoutInputRest_2.Position = [1496 570 78 20];

            % Create ManualWashoutInput_2
            app.ManualWashoutInput_2 = uitextarea(app.StressRestAnalysisTab);
            app.ManualWashoutInput_2.FontColor = [0.8 0.8 0.8];
            app.ManualWashoutInput_2.Visible = 'off';
            app.ManualWashoutInput_2.Placeholder = 'Washout';
            app.ManualWashoutInput_2.Position = [1496 599 78 20];

            % Create ManualBaselineInputRest_2
            app.ManualBaselineInputRest_2 = uitextarea(app.StressRestAnalysisTab);
            app.ManualBaselineInputRest_2.FontColor = [0.8 0.8 0.8];
            app.ManualBaselineInputRest_2.Visible = 'off';
            app.ManualBaselineInputRest_2.Placeholder = 'Baseline';
            app.ManualBaselineInputRest_2.Position = [1394 571 84 20];

            % Create FitCurvesButtonRest_2
            app.FitCurvesButtonRest_2 = uibutton(app.StressRestAnalysisTab, 'push');
            app.FitCurvesButtonRest_2.ButtonPushedFcn = createCallbackFcn(app, @FitCurvesButtonRest_2Pushed, true);
            app.FitCurvesButtonRest_2.Visible = 'off';
            app.FitCurvesButtonRest_2.Position = [1261 570 102 22];
            app.FitCurvesButtonRest_2.Text = 'Fit Rest Curve';

            % Create ManualBaselineInput_2
            app.ManualBaselineInput_2 = uitextarea(app.StressRestAnalysisTab);
            app.ManualBaselineInput_2.FontColor = [0.8 0.8 0.8];
            app.ManualBaselineInput_2.Visible = 'off';
            app.ManualBaselineInput_2.Placeholder = 'Baseline';
            app.ManualBaselineInput_2.Position = [1394 599 84 20];

            % Create FitStressCurveButton_2
            app.FitStressCurveButton_2 = uibutton(app.StressRestAnalysisTab, 'push');
            app.FitStressCurveButton_2.ButtonPushedFcn = createCallbackFcn(app, @FitStressCurveButton_2Pushed, true);
            app.FitStressCurveButton_2.Visible = 'off';
            app.FitStressCurveButton_2.Position = [1261 598 102 22];
            app.FitStressCurveButton_2.Text = 'Fit Stress Curve';

            % Create ThreeDVisualizationTab
            app.ThreeDVisualizationTab = uitab(app.TabGroup);
            app.ThreeDVisualizationTab.AutoResizeChildren = 'off';
            app.ThreeDVisualizationTab.Title = 'Supervised Learning';
            app.ThreeDVisualizationTab.ForegroundColor = 'none';

            % Create ImageAxes3D
            app.ImageAxes3D = uiaxes(app.ThreeDVisualizationTab);
            title(app.ImageAxes3D, 'DICOM Volume')
            zlabel(app.ImageAxes3D, 'Z')
            app.ImageAxes3D.PlotBoxAspectRatio = [1.09420289855072 1 1];
            app.ImageAxes3D.GridLineStyle = 'none';
            app.ImageAxes3D.XTick = [];
            app.ImageAxes3D.YTick = [];
            app.ImageAxes3D.Visible = 'off';
            app.ImageAxes3D.ButtonDownFcn = createCallbackFcn(app, @ImageAxes3DButtonDown, true);
            app.ImageAxes3D.Position = [22 460 441 421];

            % Create ImageAxes3DJPEG
            app.ImageAxes3DJPEG = uiaxes(app.ThreeDVisualizationTab);
            title(app.ImageAxes3DJPEG, 'JPEG Volume')
            zlabel(app.ImageAxes3DJPEG, 'Z')
            app.ImageAxes3DJPEG.PlotBoxAspectRatio = [1.09420289855072 1 1];
            app.ImageAxes3DJPEG.GridLineStyle = 'none';
            app.ImageAxes3DJPEG.XTick = [];
            app.ImageAxes3DJPEG.YTick = [];
            app.ImageAxes3DJPEG.Visible = 'off';
            app.ImageAxes3DJPEG.Position = [522 461 441 421];

            % Create SlicesSlider3DLabel
            app.SlicesSlider3DLabel = uilabel(app.ThreeDVisualizationTab);
            app.SlicesSlider3DLabel.Visible = 'off';
            app.SlicesSlider3DLabel.Position = [462 439 92 22];
            app.SlicesSlider3DLabel.Text = 'Slices';

            % Create SlicesSlider3D
            app.SlicesSlider3D = uislider(app.ThreeDVisualizationTab);
            app.SlicesSlider3D.Limits = [1 100];
            app.SlicesSlider3D.Orientation = 'vertical';
            app.SlicesSlider3D.ValueChangingFcn = createCallbackFcn(app, @SlicesSlider3DValueChanging, true);
            app.SlicesSlider3D.Visible = 'off';
            app.SlicesSlider3D.Position = [469 475 3 401];
            app.SlicesSlider3D.Value = 1;

            % Create DynamicAngiographicImagingDAIVeraPanel_3
            app.DynamicAngiographicImagingDAIVeraPanel_3 = uipanel(app.ThreeDVisualizationTab);
            app.DynamicAngiographicImagingDAIVeraPanel_3.AutoResizeChildren = 'off';
            app.DynamicAngiographicImagingDAIVeraPanel_3.ForegroundColor = [0 0.4471 0.7412];
            app.DynamicAngiographicImagingDAIVeraPanel_3.BorderType = 'none';
            app.DynamicAngiographicImagingDAIVeraPanel_3.Title = 'Dynamic Angiographic Imaging (DAI) - Vera';
            app.DynamicAngiographicImagingDAIVeraPanel_3.Visible = 'off';
            app.DynamicAngiographicImagingDAIVeraPanel_3.FontWeight = 'bold';
            app.DynamicAngiographicImagingDAIVeraPanel_3.FontSize = 16;
            app.DynamicAngiographicImagingDAIVeraPanel_3.Position = [23 960 949 30];

            % Create SetWindowLevelSupervised
            app.SetWindowLevelSupervised = uitextarea(app.ThreeDVisualizationTab);
            app.SetWindowLevelSupervised.Visible = 'off';
            app.SetWindowLevelSupervised.Placeholder = 'Level';
            app.SetWindowLevelSupervised.Position = [90 433 48 24];

            % Create SetWindowButtonSupervised
            app.SetWindowButtonSupervised = uibutton(app.ThreeDVisualizationTab, 'push');
            app.SetWindowButtonSupervised.ButtonPushedFcn = createCallbackFcn(app, @SetWindowButtonSupervisedPushed, true);
            app.SetWindowButtonSupervised.Visible = 'off';
            app.SetWindowButtonSupervised.Position = [198 434 74 22];
            app.SetWindowButtonSupervised.Text = 'Set Window';

            % Create SetWindowWidthSupervised
            app.SetWindowWidthSupervised = uitextarea(app.ThreeDVisualizationTab);
            app.SetWindowWidthSupervised.Visible = 'off';
            app.SetWindowWidthSupervised.Placeholder = 'Width';
            app.SetWindowWidthSupervised.Position = [144 433 48 24];

            % Create SetRCAPointButton
            app.SetRCAPointButton = uibutton(app.ThreeDVisualizationTab, 'push');
            app.SetRCAPointButton.ButtonPushedFcn = createCallbackFcn(app, @SetRCAPointButtonPushed, true);
            app.SetRCAPointButton.Visible = 'off';
            app.SetRCAPointButton.Position = [68 893 88 22];
            app.SetRCAPointButton.Text = 'Set RCA Point';

            % Create SetApexPointButton
            app.SetApexPointButton = uibutton(app.ThreeDVisualizationTab, 'push');
            app.SetApexPointButton.ButtonPushedFcn = createCallbackFcn(app, @SetApexPointButtonPushed, true);
            app.SetApexPointButton.Visible = 'off';
            app.SetApexPointButton.Position = [160 893 90 22];
            app.SetApexPointButton.Text = 'Set Apex Point';

            % Create SetLADPointButton
            app.SetLADPointButton = uibutton(app.ThreeDVisualizationTab, 'push');
            app.SetLADPointButton.ButtonPushedFcn = createCallbackFcn(app, @SetLADPointButtonPushed, true);
            app.SetLADPointButton.Visible = 'off';
            app.SetLADPointButton.Position = [255 893 85 22];
            app.SetLADPointButton.Text = 'Set LAD Point';

            % Create SetLCxPointButton
            app.SetLCxPointButton = uibutton(app.ThreeDVisualizationTab, 'push');
            app.SetLCxPointButton.ButtonPushedFcn = createCallbackFcn(app, @SetLCxPointButtonPushed, true);
            app.SetLCxPointButton.Visible = 'off';
            app.SetLCxPointButton.Position = [344 893 84 22];
            app.SetLCxPointButton.Text = 'Set LCx Point';

            % Create RemoveLastPointButton
            app.RemoveLastPointButton = uibutton(app.ThreeDVisualizationTab, 'push');
            app.RemoveLastPointButton.ButtonPushedFcn = createCallbackFcn(app, @RemoveLastPointMenuSelected, true);
            app.RemoveLastPointButton.Visible = 'off';
            app.RemoveLastPointButton.Position = [279 434 117 23];
            app.RemoveLastPointButton.Text = 'Remove Last Point';

            % Create ContextMenu
            app.ContextMenu = uicontextmenu(app.UIFigure);

            % Create SetYaxisMaxMenu
            app.SetYaxisMaxMenu = uimenu(app.ContextMenu);
            app.SetYaxisMaxMenu.MenuSelectedFcn = createCallbackFcn(app, @SetYaxisMaxMenuSelected, true);
            app.SetYaxisMaxMenu.Text = 'Set Y-axis Max';
            
            % Assign app.ContextMenu
            app.paPlotAreaStressOnly.ContextMenu = app.ContextMenu;

            % Create ContextMenu2
            app.ContextMenu2 = uicontextmenu(app.UIFigure);

            % Create SetYaxisMaxMenu_2
            app.SetYaxisMaxMenu_2 = uimenu(app.ContextMenu2);
            app.SetYaxisMaxMenu_2.MenuSelectedFcn = createCallbackFcn(app, @SetYaxisMaxMenu_2Selected, true);
            app.SetYaxisMaxMenu_2.Text = 'Set Y-axis Max';
            
            % Assign app.ContextMenu2
            app.pdPlotAreaStressOnly.ContextMenu = app.ContextMenu2;

            % Show the figure after all components are created
            app.UIFigure.Visible = 'on';
        end
    end

    % App creation and deletion
    methods (Access = public)

        % Construct app
        function app = DCTFFRGUI

            % Create UIFigure and components
            createComponents(app)

            % Register the app with App Designer
            registerApp(app, app.UIFigure)

            % Execute the startup function
            runStartupFcn(app, @startupFcn)

            if nargout == 0
                clear app
            end
        end

        % Code that executes before app deletion
        function delete(app)

            % Delete UIFigure when app is deleted
            delete(app.UIFigure)
        end
    end
end